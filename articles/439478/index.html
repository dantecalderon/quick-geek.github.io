<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Entertaining C #. Five examples for a coffee break</title>
  <meta name="description" content="Having written more than one article about Veeam Academy , we decided to open up a bit of internal cuisine and offer you a few examples in C # that we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Entertaining C #. Five examples for a coffee break</h1><div class="post__text post__text-html js-mediator-article">  Having written more than one article about <a href="https://academy.veeam.ru/%3Futm_source%3Dhabrahabr.ru%26utm_medium%3Dreferral%26utm_campaign%3Dacademy_habr">Veeam Academy</a> , we decided to open up a bit of internal cuisine and offer you a few examples in C # that we parse with our students.  When compiling them, we made a start from the fact that our audience is novice developers, but it may also be interesting for experienced programmers to look under the cat.  Our goal is to show how deep the rabbit hole is, while at the same time explaining the features of the internal structure of C #. <br><br>  On the other hand, we will welcome comments from experienced colleagues who either point out the shortcomings in our examples, or can share their own.  Like questions like to use in interviews, so surely we all have something to tell. <br><br>  We hope that our selection will be useful for you, help you refresh your knowledge or just smile. <br><br><img src="https://habrastorage.org/webt/wm/5l/4q/wm5l4qgp5-jl50kt_2oswu4tyu8.jpeg" alt="image"><br><a name="habracut"></a><br><h4>  Example 1 </h4><br>  Structures in C #.  They often have questions even for experienced developers, which is what so many different online tests like to use. <br><br>  Our first example is an example of attentiveness and knowledge of what the block is using.  And also quite a topic for communication during the interview. <br><br>  Consider the code: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> SDummy : IDisposable { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _dispose; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _dispose = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _dispose; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SDummy(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (d) { Console.WriteLine(d.GetDispose()); } Console.WriteLine(d.GetDispose()); } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">What will the Main method bring to the console?</b> <div class="spoiler_text">  Note that SDummy is a structure that implements the IDisposable interface, so that variables of type SDummy can be used in a using block. <br><br>  According <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/statements">to the C # language specification, the</a> statement for meaningful types is expanded during compilation into a try-finally block: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Console.WriteLine(d.GetDispose()); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { ((IDisposable)d).Dispose(); }</code> </pre><br>  So, in our code, the GetDispose () method is called inside the using block, which returns a _dispose boolean field whose value for the object d has not been set anywhere (it is specified only in the Dispose () method that has not yet been called) and therefore returns default equal to False.  What's next? <br><br>  And then the most interesting. <br>  Execute string in finally block <br><pre> <code class="cs hljs"> ((IDisposable)d).Dispose();</code> </pre><br>  in the usual case leads to boxing.  It is easy to see, for example, <a href="https://sharplab.io/">here</a> (at the top right in the Results, first select C # and then IL): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4p/b5/ix/4pb5ixpt4bwwwgrgiqeopcstdsg.jpeg" alt="image" width="80%"></div><br>  In this case, the Dispose method is already called for another object, and not at all for the object d. <br>  Run our program and see that the program really displays ‚ÄúFalse False‚Äù on the console.  But is everything so simple?  :) <br><br>  In fact, no packing is happening.  What, according to Eric Lippert, is done for the sake of optimization (see <a href="https://stackoverflow.com/a/1330724">here</a> and <a href="https://stackoverflow.com/a/2413844">here</a> ). <br>  But, if there is no packaging (which in itself may seem surprising), why on the screen ‚ÄúFalse False‚Äù, and not ‚ÄúFalse True‚Äù, because Dispose should now be applied to the same object?!? <br><br>  And that's not the same thing! <br>  Let's look at what our <a href="https://sharplab.io/">C # compiler</a> deploys to our program: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> SDummy : IDisposable { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _dispose; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _dispose = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _dispose; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { SDummy sDummy = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(SDummy); SDummy sDummy2 = sDummy; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Console.WriteLine(sDummy.GetDispose()); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { ((IDisposable)sDummy2).Dispose(); } Console.WriteLine(sDummy.GetDispose()); } }</code> </pre><br><br>  A new sDummy2 variable has appeared, to which the Dispose () method is applied! <br>  Where did this hidden variable come from? <br>  Again we turn to the <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/statements">speculation</a> : <br><blockquote>  A using the statement of the form of using the expression has the same three possible expansions.  In this case, the compile-time type of the expression is ... <br></blockquote><br>  So  The sDummy variable is invisible and inaccessible for the embedded statement of the using block, and all operations inside this expression are performed with another sDummy2 variable. <br><br>  As a result, the Main method displays ‚ÄúFalse False‚Äù rather than ‚ÄúFalse True‚Äù on the console, as many of those who have encountered this example for the first time consider.  In this case, be sure to keep in mind that packaging does not occur here, but an additional hidden variable is created. <br><br>  The general conclusion is this: mutable value types are evil that should be avoided. <br><br>  A similar example is considered <a href="https://ericlippert.com/2011/03/14/to-box-or-not-to-box">here</a> .  If the topic is interesting, we highly recommend to take a look. <br><br>  I would like to say a special thanks to <a href="https://habr.com/ru/users/sergeyt/" class="user_link">SergeyT</a> for valuable comments on this example. <br><br></div></div><br><br><h4>  Example 2 </h4><br>  Constructors and the sequence of their calls is one of the main themes of any object-oriented programming language.  Sometimes such a sequence of calls can surprise and, much worse, even ‚Äúfill up‚Äù the program at the most unexpected moment. <br><br>  So, consider the MyLogger class: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyLogger</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MyLogger innerInstance = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyLogger(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Static Logger Constructor"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Instance Logger Constructor"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MyLogger Instance { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> innerInstance; } } }</code> </pre><br>  Suppose that this class has some business logic that we need to support logging (functionality is not so important now). <br><br>  Let's see what is in our class MyLogger: <br><br><ol><li>  Static constructor set </li><li>  There is a private constructor without parameters </li><li>  Defined private static variable innerInstance </li><li>  And there is an open static property Instance for communication with the outside world. </li></ol><br>  For ease of analyzing this example inside the class constructors, we added a simple console output. <br><br>  Outside the class (without using tricks like reflection) we can only use the open static Instance property, which we can call as follows: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logger = MyLogger.Instance; } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">What will this program display?</b> <div class="spoiler_text">  We all know that the static constructor is called before accessing any member of the class (except for constants).  At the same time, it runs only once within the application domain. <br><br>  In our case, we are accessing a class member ‚Äî the Instance property ‚Äî which should first trigger the static constructor, and then invoke the instance constructor of the class.  Those.  the program will output: <br><br>  <b>Static Logger Constructor</b> <b><br></b>  <b>Instance Logger Constructor</b> <b><br></b> <br><br>  However, after launching the program we will get on the console: <br><br>  <b>Instance Logger Constructor</b> <b><br></b>  <b>Static Logger Constructor</b> <b><br></b> <br><br>  How so?  Instance constructor worked before the static constructor?!? <br>  Answer: Yes! <br><br>  And that's why. <br><br>  In the ECMA-334 standard of C #, the following is indicated on the static classes account: <br><br>  <i>17.4.5.1: ‚ÄúIf a static constructor (¬ß17.11) exists, the initializers occur immediately after the session.</i> <i><br></i>  <i>...</i> <i><br></i>  <i>11/17: ...</i> <br><br>  (What means in a free translation: if there is a static constructor in the class, then the initialization of the static fields starts immediately BEFORE the static constructor is started. <br>  ... <br>  If the class contains any static fields with initializers, then such initializers are started in the following order in the program text BEFORE launching the static constructor.) <br><br>  In our case, the static field innerInstance is declared together with the initializer, which is the class instance constructor.  According to the ECMA standard, the initializer must be called BEFORE calling the static constructor.  What happens in our program: the instance constructor, being the initializer of a static field, is called BEFORE the static constructor.  Agree, quite unexpectedly. <br><br>  Note that this is only true for static field initializers.  In general, a static constructor is called BEFORE a call to the instance constructor of a class. <br><br>  As, for example, here: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyLogger</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Static Logger Constructor"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Instance Logger Constructor"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyLogger(); } }</code> </pre><br>  And the program is expected to display on the console: <br><br>  <b>Static Logger Constructor</b> <b><br></b>  <b>Instance Logger Constructor</b> <b><br></b> <br></div></div><br><img src="https://habrastorage.org/webt/zr/ee/h3/zreeh3h-fqruztz8hdljydmzl1q.jpeg" alt="image"><br><br><h4>  Example 3 </h4><br>  Programmers often have to write helper functions (utilities, helpers, etc.) to make their lives easier.  Usually such functions are fairly simple and often take up only a few lines of code.  But you can even stumble out of the blue. <br><br>  Suppose we need to implement such a function that checks a number for oddness (that is, that a number is not divisible by 2 without a remainder). <br><br>  The implementation might look like this: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isOddNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (i % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre><br>  At first glance, everything is fine and, for example, for the numbers 5.7 and 11, we expectedly get True. <br><br><div class="spoiler">  <b class="spoiler_title">And what does the isOddNumber (-5) function return?</b> <div class="spoiler_text">  -5 is an odd number, but in response to our function, we get False! <br>  We will understand what is the reason. <br><br>  According to <a href="https://docs.microsoft.com/ru-ru/dotnet/csharp/language-reference/operators/remainder-operator">MSDN</a> , the following is written about the operator of the remainder of division%: <br>  "For integer operands, the result of a% b is the value produced by a - (a / b) * b" <br>  In our case, for a = -5, b = 2 we get: <br>  -5% 2 = (-5) - ((-5) / 2) * 2 = -5 + 4 = -1 <br>  But -1 is not always equal to 1, which explains our result False. <br><br>  The% operator is sensitive to the sign of the operands.  Therefore, in order not to receive such "surprises", it is better to compare the result with zero, which has no sign: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isOddNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (i % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre><br>  Or create a separate parity function and implement logic through it: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isEvenNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (i % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isOddNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !isEvenNumber(i); }</code> </pre><br></div></div><br><h4>  Example 4 </h4><br>  Anyone who has programmed in C # has probably met LINQ, which is so convenient to work with collections, creating queries, filtering and aggregating data ... <br><br>  We will not look under the hood LINQ.  Perhaps we will do it another time. <br><br>  In the meantime, consider a small example: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] dataArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> summResult = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selectedData = dataArray.Select( x =&gt; { summResult += x; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x; }); Console.WriteLine(summResult);</code> </pre><br><div class="spoiler">  <b class="spoiler_title">What will this code output?</b> <div class="spoiler_text">  We will get on the screen the value of the variable summResult, which is equal to the initial value, i.e.  0 <br><br>  Why did it happen? <br><br>  Because the definition of a LINQ query and the launch of this query are two operations that are performed separately.  Thus, the definition of a query does not mean its start / execution. <br><br>  The variable summResult is used inside the anonymous delegate in the Select method: the elements of the dataArray array are sequentially iterated and added to the summResult variable. <br><br>  We can assume that our code will print the sum of the elements of the dataArray array.  But LINQ doesn't work that way. <br><br>  Consider the variable selectedData.  The var keyword is ‚Äúsyntactic sugar‚Äù, which in many cases reduces the size of the program code and improves its readability.  And the actual type of the selectedData variable implements the IEnumerable interface.  Those.  our code looks like this: <br><br><pre> <code class="cs hljs"> IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; selectedData = dataArray.Select( x =&gt; { summResult += x; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x; });</code> </pre><br>  Here we define the query (Query), but the query itself does not run.  Similarly, you can work with the database by setting the SQL query as a string, but to get the result, refer to the database and run this query explicitly. <br><br>  That is, for the time being, we only asked for the request, but did not launch it.  That is why the value of the summResult variable remains unchanged.  And you can run a query, for example, using the ToArray, ToList or ToDictionary methods: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] dataArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> summResult = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π selectedData IEnumerable&lt;int&gt; selectedData = dataArray.Select( x =&gt; { summResult += x; return x; }); // –∑–∞–ø—É—Å–∫–∞–µ–º –∑–∞–ø—Ä–æ—Å selectedData selectedData.ToArray(); // –ø–µ—á–∞—Ç–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π summResult Console.WriteLine(summResult);</span></span></code> </pre><br>  This code will already display the value of the variable summResult, equal to the sum of all elements of the dataArray array, equal to 15. <br><br>  With this sorted out.  And what then will this program display? <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] dataArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span> }; <span class="hljs-comment"><span class="hljs-comment">//1 var summResult = dataArray.Sum() + dataArray.Skip(3).Take(2).Sum(); //2 var groupedData = dataArray.GroupBy(x =&gt; x).Select( //3 x =&gt; { summResult += x.Key; return x.Key; }); Console.WriteLine(summResult); //4</span></span></code> </pre><br>  The variable groupedData (line 3) actually implements the IEnumerable interface and essentially defines the query to the dataArray data source.  This means that for an anonymous delegate to work, which changes the value of the summResult variable, this query must be run explicitly.  But there is no such launch in our program.  Therefore, the value of the variable summResult will be changed only in line 2, and we can disregard everything else in our calculations. <br><br>  Then it is easy to calculate the value of the variable summResult, which is, respectively, 15 + 7, i.e.  22 <br></div></div><br><h4>  Example 5 </h4><br>  Let's say at once - we do not consider this example at our lectures at the Academy, but sometimes we discuss it during coffee breaks more like an anecdote. <br><br>  Despite the fact that it is unlikely to be indicative from the point of view of determining the level of the developer, this example was encountered in several different tests.  Perhaps it is used for universality, because it works the same way both in C and C ++, and in C # and Java. <br><br>  So let there be a line of code: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)+(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)-(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)+(<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)<span class="hljs-number"><span class="hljs-number">-1</span></span>;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">What is the value of the variable i?</b> <div class="spoiler_text">  Answer: 1 <br><br>  One might think that here numerical arithmetic is used over the sizes of each type in bytes, since the ‚Äú+‚Äù and ‚Äú-‚Äù signs are quite unexpectedly found for type conversion. <br><br>  It is known that in C # the type integer has a size of 4 bytes, long - 8, char - 2. <br><br>  Then it is easy to think that our line of code will be equivalent to the following arithmetic expression: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = (<span class="hljs-number"><span class="hljs-number">4</span></span>)+(<span class="hljs-number"><span class="hljs-number">2</span></span>)-(<span class="hljs-number"><span class="hljs-number">4</span></span>)+(<span class="hljs-number"><span class="hljs-number">8</span></span>)<span class="hljs-number"><span class="hljs-number">-1</span></span>;</code> </pre><br>  However, it is not.  And in order to confuse and direct by such false reasoning, the example can be changed, for example, as follows: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)+(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)-(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)+(<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)-<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>);</code> </pre><br>  The signs ‚Äú+‚Äù and ‚Äú-‚Äù are used in this example not as binary arithmetic operations, but as unary operators.  Then our line of code is only a sequence of explicit type conversions mixed with calls to unary operations, which can be written like this: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)( <span class="hljs-comment"><span class="hljs-comment">// call explicit operator int(char), ie char to int +( // call unary operator + (char)( // call explicit operator char(int), ie int to char -( // call unary operator - (int)( // call explicit operator int(long), ie long to int +( // call unary operator + (long)( // call explicit operator long(int), ie int to long -1 ) ) ) ) ) ) );</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/0a/wm/vn/0awmvncxvmyw1jzjgc_uavq8rf8.jpeg" alt="image"><br><br><h3>  Interested in Studying at Veeam Academy? </h3><br>  Now there is a set for spring intensive C # in St. Petersburg, and we invite everyone to take an online test on the <a href="https://academy.veeam.ru/%3Futm_source%3Dhabrahabr.ru%26utm_medium%3Dreferral%26utm_campaign%3Dacademy_habr">Veeam Academy</a> website <a href="https://academy.veeam.ru/%3Futm_source%3Dhabrahabr.ru%26utm_medium%3Dreferral%26utm_campaign%3Dacademy_habr">.</a> <br><br>  The course starts on February 18, 2019, will run until mid-May and will be, as always, completely free.  Registration for anyone who wants to pass entrance testing is already available on the Academy website: <a href="https://academy.veeam.ru/%3Futm_source%3Dhabrahabr.ru%26utm_medium%3Dreferral%26utm_campaign%3Dacademy_habr">academy.veeam.ru</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vg/k6/ol/vgk6olkeyayj8hqamzvva75ycrk.jpeg" alt="image" width="50%"></div></div><p>Source: <a href="https://habr.com/ru/post/439478/">https://habr.com/ru/post/439478/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>