<div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/gj/tv/dt/gjtvdtel7o-zeawppyzey9bhfh4.jpeg"><br><br>  The need for regular readings of metering devices and transmission of received data to the resource provider is an integral part of the life of a modern person. <br><br>  Although the operation of taking testimony is not very burdensome, but it is accompanied by a “human factor”: you can forget about it, make mistakes when removing or sending data, there may be mistakes on the other hand.  In addition, the increase in the cost of resources increases the responsibility of the parties and leads to an increase in mistrust between them, attempts of theft on the one hand, the appearance of an army of controllers on the other hand, and this leads to a further increase in the cost of resources. <a name="habracut"></a>  The generally accepted solution of these, as well as other problems, is automation or, in other words, the introduction of a third “objective” side - a machine that performs two main functions (performs two main roles): <br><br><ol><li>  receiving data from metering devices (the role of the reader); </li><li>  data transfer to interested parties (transmitter role). </li></ol><br>  To date, there are many technical solutions for introducing a mediator machine into relations between a supplier and a consumer of resources.  These solutions differ from each other as devices for the execution of roles, and channels of communication between them, metering devices and data recipients.  The typical structure of such solutions is shown in the diagram. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8g/1o/ae/8g1oaer0etbzzzlwaz4zem6djw4.jpeg"></div><br>  Channel metering device - the reader is determined by the design of the meter: <br><br><table><tbody><tr><td>  <b>Type of metering device (meter)</b> </td><td>  <b>Channel type</b> </td><td>  <b>Note</b> </td></tr><tr><td>  Without pulse and interface outputs, without optical port </td><td>  Optical for image acquisition </td><td>  The resulting data is used to recognize </td></tr><tr><td>  With optical port </td><td>  Optical for data acquisition </td><td></td></tr><tr><td>  With pulse or interface ( <b>CAN, RS485, RS422, RS232</b> ) </td><td>  Wired for data </td><td></td></tr><tr><td>  With integrated reader </td><td>  Hidden </td><td>  The car has only the transmitter role. </td></tr></tbody></table><br>  The reader-transmitter channel is often hidden, since in most cases both roles are integrated in one device. <br><br>  Channel transmitter - the recipient of data has a complex structure and may consist of subchannels of various types.  There are usually three of them: the first subchannel can have a different type [ <a href="http://www.mdpi.com/2076-3417/6/3/68">1</a> ] - wired ( <b>PLC, xDSL, RSxxx</b> ) or wireless ( <b>LPWAN</b> ( <b>ZigBee, LoRa, Swift</b> ) <b>Bluetooth, WiFi</b> ), the second - <b>GSM / GPRS</b> or the Internet, the third - the Internet.  The boundary between the first and second subchannels is usually a hub or <b>DRC</b> , and between the second and third is the data processing server.  As an illustration, the decision of the Strizh company [ <a href="https://habrahabr.ru/company/oleg-bunin/blog/346658/">2</a> ] can be given: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4eb/378/b69/4eb378b69f0b4a4d07e8a2b85020725e.png"><br><br>  The abundance of the proposed technical solutions, on the one hand, and their insufficient distribution, on the other, indicates the existence of problems with the implementation of remote data collection systems.  In our opinion, these problems include the following: <br><br><ol><li>  A wide variety of metering devices in operation, including the presence of meters that have no interfaces.  This requires an appropriate variety of readers.  The main trend in solving this problem is the replacement of meters. <br>  In the West, the second round of meter replacements is taking place; on the first, counters with pulse output ( <b>AMR</b> generation) were installed, on the second, counters with integrated readers and disconnect devices ( <b>AMI</b> generation).  In our country, so far all projects are pilot in nature, and the SI State Register contains counters of all types. </li><li>  The existing infrastructure makes it possible to use for the first subchannel only <b>GSM</b> and <b>PLC</b> channel types, which are limitedly used due to the relatively high price of transmitters (modems), and the <b>PLC</b> can also be used only for electric meters.  Lower cost <b>LPWAN</b> transmitters require the deployment of appropriate infrastructure. </li><li>  Recipients of data are suppliers of various resources or management companies.  However, unlike in the West, infrastructure owners are often completely different companies (integrators, operators).  Due to the lack of standards, changing such a company leads to problems in the operation of the system.  In addition, suppliers of various resources act independently and inconsistently, which further complicates the implementation of an integrated system. </li><li>  End users will begin to feel the benefits of automation only after its final implementation and access to the personal account.  And on the example of installing meters with a pulse output, it can be seen that one can wait for this moment for years.  This leads to their lack of interest, so the implementation process is happening "from above" - ​​on the part of companies. <br>  Fortunately, the development of technology and the wide distribution of the Internet allows us to solve all the problems considered. </li></ol><br><h3>  1. Optical meter readout </h3><br>  Obtaining meter readings through the analysis of a static or dynamic image of an instrument display panel has long been a subject of research.  And in this direction significant progress has been achieved. <br><br>  Probably the most common way is to take photographs of the counter and recognize it on the server.  The latest example of this approach is the experiment of the Moscow Department of Information Technology: Muscovites were offered to photograph their water meters and send photos with real readings of hot and cold water meters.  It is planned that by the end of 2017, the developed neural network will be able to learn to accurately, quickly and accurately recognize meter readings from photographs [ <a href="https://realty.rbc.ru/news/598be2db9a794748e0a6feda">3</a> ]. <br><br>  With the development of mobile power, it has become possible to transfer recognition to these devices.  Additional appeal to this solution gives the possibility of combining the two processes - to obtain a photo and its recognition on one device.  The most famous and popular solutions are the development of the companies <b>Pixometer</b> [ <a href="http://pixometer.io/info/">4</a> ] and <b>Anyline</b> [ <a href="https://anyline.com/">5</a> ]. <br><br>  With all the simplicity of the idea of ​​obtaining the image and recognition of the meter readings on a mobile device, it is not very easy to use the corresponding solutions due to the increased requirements for image quality.  And here it is necessary to take into account that the counters are not always located in places convenient for photographing.  And if the user has reached the counter, then it is much easier for him to write down his readings on paper or on the same smartphone, for which, by the way, there are many quality solutions, for example [ <a href="https://www.iphones.ru/iNotes/352586">6</a> ]. <br><br>  Therefore, obtaining images of meters using stationary devices is certainly more convenient for the user than photographing them with smartphones.  In addition, the quality of such photographs is noticeably higher due to the constancy of distance and light.  There are also various solutions from amateur [ <a href="https://habrahabr.ru/post/220869/">7</a> ] to professional: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/zp/v_/qkzpv_u2ldj4psihi2a369ls7re.jpeg"></div><br>  <a href="http://www.accentcom.ru/sps-1g">[8] Optical GPRS-scanner Accent SPS-2</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yu/i6/ly/yui6lyhqnatchyg6f7mbjbnbxk0.jpeg"></div><br>  <a href="https://www.alibaba.com/product-detail/OCR-meter-reading-AMR-module-for_136187712.html">Optical reader of water meters of the Korean company Neckers Co., Ltd.</a> <br><br>  To recognize the photographs of the counters, remote servers are used. <br><br>  The most effective and convenient solution is when both the image acquisition from the counter and its recognition are performed on a device (optical reader) attached to the counter.  These include solutions from <b>Xemtec</b> [ <a href="http://www.xemtec.com/index.php/solutions-en/xemreader-en">10</a> ] <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dy/m1/gn/dym1gn9cewmtv4p7kc_n8ddgaic.jpeg"></div><br>  and <b>Q-loud</b> [ <a href="https://q-loud.de/energycam/">11</a> ] <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/s6/q9/dds6q9xywoozftoeavjtmykoqgu.png"></div><br>  Unfortunately, the remarkable devices of these companies have a fairly high price, about 250 euros (and this is without taking into account hubs and other peripherals!).  Taking into account the number of meters in an ordinary household, this makes their use in our conditions impossible. <br><br>  We are also developing a device for reading the meter readings, operating in plug &amp; play mode, but with an acceptable price (up to $ 30).  Due to the use of the new original recognition technology, our reader can work, just like the <b>Anyline</b> product, with any types of counters. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-t/_p/1f/-t_p1fz1si4jpyg5mf3ks6jpy_s.png"></div><br><br>  The video shows the operation of a prototype device with an <b>ESP8266</b> microcontroller, used to obtain an image and recognize meter readings.  Due to insufficient memory, recognition is carried out two digits per frame. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rrdi8eH5S3o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  [ <a href="https://habrahabr.ru/post/330936/">Method Description</a> ] <br><br><div class="spoiler">  <b class="spoiler_title">More prototypes</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/DxphYFW3jyQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PaMtYAc_aws" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><h3>  2. Universal infrastructure </h3><br>  According to the latest research, the Internet audience in Russia reached 87.7 million people.  (71% of the population, and among the youth audience - 98%).  RAEC predicts that by 2020 up to 85% of Russians will have access to the Internet in the Russian Federation [ <a href="http://www.tadviser.ru/index.php/%25D0%25A1%25D1%2582%25D0%25B0%25D1%2582%25D1%258C%25D1%258F:%25D0%2598%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D0%25B5%25D1%2582-%25D0%25B4%25D0%25BE%25D1%2581%25D1%2582%25D1%2583%25D0%25BF_(%25D1%2580%25D1%258B%25D0%25BD%25D0%25BE%25D0%25BA_%25D0%25A0%25D0%25BE%25D1%2581%25D1%2581%25D0%25B8%25D0%25B8)">13</a> ].  Such figures mean that today almost every household has access to the Internet.  For the implementation of remote data collection systems, this means the possibility of changing the structure of the transmitter - the receiver of the data.  Now this channel will contain only two subchannels: the first is the RF channel, the second is the Internet channel.  A hub separates the subchannels, which collects data from only a small number of counters of one household and transfers this data directly to resource providers, management companies, etc. <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/v7/yt/0o/v7yt0oweapzi3fdfykmg0bgqrc8.png"></a> </div><br><br>  Such infrastructure in combination with optical readers allows solving all the problems described above. <br><br><ol><li>  A variety of metering devices is irrelevant, since a board used by all counters is used to determine the readings.  The optical reader required for this has a low price, is easy to install and does not require any settings. </li><li>  For the first subchannel, very cheap low-power transmitters with a range of up to 50 m are used (the same type as in conventional radio controls).  For the second sub-channel - the Internet.  Hub features: <br><ul><li>  According to the schedule specified in the settings, it sends a command to the appropriate reader, receives a meter reading and saves it.  The same procedure (polling the counter) is possible on command at an arbitrary point in time. </li><li>  According to the set schedule (it may not coincide with the survey schedule) and the addresses are sent by the meter readings to the data recipient servers. </li><li>  Receives commands from the resource provider server. </li><li>  It has a WEB interface for working with users (owners of metering devices). </li></ul><br></li><li>  All resource providers, as well as management companies, are in equal states in the system and can receive remote access to meter readings at any time, as well as provide feedback. </li><li>  The user immediately after installing the hub receives the ability to remotely access meter readings. </li></ol><br><h3>  3. Home hub - the center of the smart home </h3><br>  Currently, the concept of a smart home is becoming more popular.  Management of engineering systems allows you to make housing more comfortable, which is desirable for many, but not necessary component of life.  At the same time, the worldwide trend to strengthen control over the consumption of resources makes the introduction of automated remote data collection necessary.  The combination of these two concepts in the framework of the considered universal system allows you to create requirements for a home hub as the center of the future smart home: <br><br><ol><li>  Receive from the user and store payment information for resources. </li><li>  Receive from the resource provider / management company and store payment information received from the user. </li><li>  Determine the amount of payment for the resource on the day of payment. </li><li>  To remind the user about the payment with the indication of the amount of the payment or to independently make payment upon the user's permission. </li><li>  Connect modules for communication using various protocols ( <b>Bluetooth, Z-Wave, ZigBee, Wi-Fi, ...</b> ). </li></ol><br>  Having such capabilities at the concentrator will make the payment of energy easy, transparent and controllable process, which will stimulate the acquisition and installation of remote data collection systems from users and will speed up the process of its widespread implementation. </div>