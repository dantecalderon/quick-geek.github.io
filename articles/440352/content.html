<div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/1o/pi/mt/1opimto0gflwzrrgtnc7un6ap8u.png"><br><p><br>  In the functional of the social network Vkontakte, a dangerous bug was discovered and successfully exploited - a stored XSS with the functionality of a network worm. </p><br><p>  Currently, the vulnerability is fixed. </p><a name="habracut"></a><br><p>  Communities and users of VKontakte ”on the evening of February 14 began to publish the same entry.  The record says that a personal message on the social network appeared advertising. </p><br><img src="https://habrastorage.org/webt/qt/dy/up/qtdyuptjutdmgqkl_7oy2veflfk.jpeg"><br><p>  A day before the hacking in the community "Bagos" was a discussion of vulnerability, however, the social network was not ready to attack. </p><br><img src="https://habrastorage.org/webt/ji/do/qx/jidoqxmjzaqysux62kifbfl-aw4.png"><br><p>  After the start of the attack, the community was blocked, but several clones immediately appeared. </p><br><p>  When receiving malicious code, it is immediately transmitted to all personal dialogues and communities of the attacker, increasing the pandemic. </p><br><img src="https://habrastorage.org/webt/fg/pq/dp/fgpqdpcah2vf5cmfq5i83araaeu.jpeg"><br><br><p>  Used javascript code can be <a href="https://pastebin.com/gEbKJZRE">found by reference</a> . </p><br><p>  It is noteworthy that the js-payload code contains several messages that are randomly added during distribution: </p><br><pre><code class="plaintext hljs">var t = ["Всё меньше причин оставаться ВК.. Ждем пока mail group окончательно загонят сайт в яму и переходим на telegram", "Дурову пора создавать новый вконтакте, этот уже испортили", "Прости, Паша, мы все прое*али", "Ну это уже ни в какие рамки", "ВКонтакте окончательно загнулись", "Мда, меилру продолжает губить все, к чему прикасается", "Это пи*дец, товарищи", "Раньше было лучше", "стало очень неудобно", "лучше бы делом занялись", "я просто в шоке", "без комментариев", "Как же достали со своими обновлениями", "Фуфло полное ,не трогайте сообщения!", "сначала музыка, теперь ЭТО", "С такими говновведениями, что тут бодяжат последнее время, со всякими дебильными ветоШными комментами, тупыми закладками, невидимыми репостами и т.д., все и так сбегут скоро"], d = ["Социальная сеть ВKонтакте зaпустила реклaму в личных сообщенияx пользоватeлей", "СМИ: ВКонтакте запустили pекламу в личных соoбщениях", "ВКонтакте запустили рекламу в сообщениях", "ВКонтакте появилась реклама в сообщениях", "ВКонтакте ввели рекламу в сообщениях", "ВКонтакте тестирует рекламу в личныx сообщениях", "ВКонтакте представили рекламу в личных сообщениях", "Реклaма в личных сoобщениях появилась ВКонтакте", "Пользователей BКонтакте взбесила реклама в личных сообщениях", "Пользователи ВКонтакте протестуют против рекламы в личных сообщениях", "Реклама в личных сообщениях вывела из себя пользователей ВКонтакте", "ВКонтакте: мы запускаем рекламу в личных сообщениях", "ВКонтакте: теперь рекламодатели могут размещать рекламу в сообщениях пользователей", "ВКонтакте прокомментировали жалобы пользoвателей на рекламy в сообщeниях", "Пользователи ВКонтакте в ярости из-за рекламы в личных сообщениях", "Пользователи бегут из социальной сети ВКонтакте из-за рекламы в личных сообщениях"],</code> </pre> <br><p>  Vulnerabilities of this class and effect are quite rare, but nonetheless still occur.  The cost of such a vulnerability should be assessed on the basis of its impact and the damage it can cause to users.  Some recerchers may disagree with the remuneration policy and choose an alternative way - using it in the wild for fun and drawing attention to the problem. </p><br><hr><br><p>  What to do: exit all social network sessions and change the password (optional, but desirable), and also check the phone number and email associated with the account. </p></div>