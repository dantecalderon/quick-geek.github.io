<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Critical vulnerability in Zemana products and not only</title>
  <meta name="description" content="It is no secret to anyone that installing an anti-virus product could open up additional attack vectors, but I was very surprised that the search and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Critical vulnerability in Zemana products and not only</h1><div class="post__text post__text-html js-mediator-article">  It is no secret to anyone that installing an anti-virus product could open up additional attack vectors, but I was very surprised that the search and exploitation of similar vulnerabilities in some products even in 2018 is not a problem. <br><br><img src="https://habrastorage.org/webt/3a/vo/p2/3avop2ymcnmsrbb2pd3q4_hq5ic.png"><br>  Woops <br><a name="habracut"></a><br>  The discovered vulnerability is contained in the procedure for updating the antivirus product.  Update configuration files are transmitted over the usual http connection and can be read by a person (which is not a vulnerability).  The responses from the company's servers have found links to update files that the antivirus executes when a new version is detected. <br><br><img src="https://habrastorage.org/webt/rj/oa/ad/rjoaadv6l3o3lqb0ksxohy6ffty.png"><br>  Update url <br><br>  Very surprising is the fact that even a simple substitution of the URL file on the third-party led to a <b>strange</b> warning antivirus. <br><br><img src="https://habrastorage.org/webt/g6/cp/nk/g6cpnkgt1at2wkjxtwepucjcsx0.png"><br>  Do you want to execute any file with system rights? <br><br>  If the user, without noticing the trick, agreed, then the antivirus downloaded the third-party file on the computer and performed it with the SYSTEM privileges.  And it could be not necessarily a user with administrator privileges. <br>  However, navryatli who in their right mind would agree to install such an "update".  Let's look at the possibility of <b>bypassing</b> this notification.  All update files are digitally signed and <b>must be</b> verified before execution.  Let's look at the ‚ÄúZmnAppUpdater‚Äù function and see an interesting section of the place where the ‚ÄúSignatureChecker‚Äù function is called in the ZAM.exe file <br><br><img src="https://habrastorage.org/webt/1w/d_/wa/1wd_wanykybzj-kuewh0kvhrac0.png"><br>  Missed check <br><br>  This function should verify the digital signature of the exe file and return the verification result code.  However, in the ‚ÄúZmnAppUpdater‚Äù function, the authors forgot to do this (the result is EAX = 0x80096010 (TRUST_E_BAD_DIGEST)).  Thus, it is possible <b>to execute arbitrary code on a remote system with SYSTEM rights without user interaction</b> just by running the man in the middle attack.  We clone the Security directory of the original update file into a fake update file and do not care that the digital signature cannot be verified by the operating system.  The Anti-Virus only checks for whose name the certificate is issued, but not its integrity. <br><br>  Vulnerability with identifier CVE-2019-6440 has been fixed since versions 3.x (beta). <br><br>  I will note one <b>more interesting moment</b> .  It has been <b>about a year</b> since the transfer of information about the vulnerability to its actual correction (starting with versions 3x).  Vulnerability is present in all products of the company, however <b>, it was decided to postpone the release of the emergency patch</b> until the release of the new major version.  Representatives of the company said that the <b>vulnerability is quite difficult to detect</b> , in the development of a new major version and the company does not plan to release patches, as it has more than 20 rebranding partners.  Of course, <b>vulnerability is present in all products of partner companies</b> .  Moreover, the <b>company, aware of the presence of a vulnerability, continues to actively promote versions with vulnerable code so far.</b> <br>  It would seem that a company engaged in information security should have released updates as soon as possible, however this is not the case and the safety of clients is not very worried about it. </div><p>Source: <a href="https://habr.com/ru/post/439906/">https://habr.com/ru/post/439906/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
</ul></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>