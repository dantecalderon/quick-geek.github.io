<div class="post__text post__text-html js-mediator-article">  Continued ( <a href="https://geektimes.ru/post/298795">Part 1</a> ), <a href="https://habr.com/company/mobile_one/blog/425755/">Part 3.</a> <br><br><img src="https://habrastorage.org/webt/vj/ea/fv/vjeafvrqie4rjvxv0foc8uco5p4.jpeg"><br><br><h2>  Messenger Functionality for Android and iOS </h2><br><h4>  No phone number is used for registration </h4><br>  When developing the messenger registration process, it became clear that the phone number as an identifier is not needed at all and even hinders. <br>  This is about the same as for some device to support Morse code, that is, an anachronism in its pure form. <br><br>  Surprisingly, many messengers stubbornly continue to register by phone number - apparently getting information about the owner is so important that they put up with the following problems: <br><a name="habracut"></a><br><h4>  No guaranteed SMS delivery for all operators </h4><br>  The percentage of successful receiving SMS on average is 60-70% and this is not surprising, since there are hundreds of countries, and in each country there are several operators and it is rather difficult to ensure the efficiency of each route. <br><br>  All large SMS aggregators (for example, Nexmo) do not guarantee delivery at all, and in countries such as Afghanistan, for example, it is impossible to send SMS to some operators.  For each operator, Nexmo has several routes and sometimes whole directions for this aggregator do not work for weeks. <br><br><h4>  SMS sending is expensive </h4><br>  Everyone remembers a case that happened not so long ago - WhatsApp blocking in Brazil. <br>  What happened then - millions of Brazilians began to register in other messengers - for example, TG said that it received millions of new users in this country. <br><br>  But not everyone knows that sending an SMS with a confirmation code to Brazil costs 10-12 cents on average. <br><br>  Let's calculate, let’s say that it has been registered 2 million - 10 cents * 2 million = 200 000 USD. <br>  Those.  200 000 USD was thrown out for one day irrevocably. <br><br>  Why permanently?  Because in a day WhatsApp was unblocked and users left with TG. <br><br>  Why am I telling all this? <br><br>  It seems to me that this is a reason to think - why are some instant messengers, despite the fact that it is inconvenient and expensive for them, persistently continue to demand telephone numbers from users? <br><br>  So, the messenger does not require the owner's phone number, all you need is to create a login that is checked for uniqueness and a password. <br><br>  When registering, email is asked only so that you can recover your password.  Those.  If you enter an incorrect email or do not confirm it, registration will still occur, only you will not be able to recover the password if you have forgotten it. <br><br><h4>  The messenger does not require access to your address book. </h4><br>  Unfortunately, almost all popular instant messengers require access to your phone book, one of your phone number is not enough for them. <br><br>  And people do not realize how dangerous this can be. <br><br>  Of course, on the one hand, it is very convenient - one day to get a notification that Plumber Petrovich also joined WhatsApp, Viber, etc., despite the fact that you spoke with him a couple of times more than a year ago. <br><br>  But the recent HYIP around the GetContact application shows that not everything is so simple - more than 2 billion numbers have already been merged, and the numbers of those who have not even installed this application have been merged. <br>  Imagine that all popular messengers know the numbers of your friends, acquaintances, relatives and this information is constantly updated.  You can build intersections, do analytics, target, etc. <br><br><h4>  Standard encryption </h4><br>  The messenger uses the standard TLS / SRTP encryption protocol.  Everything is encrypted, including audio and video calls. <br><br>  As a simple independent audit, you can do the following - connect a gateway or IP phone in parallel to your account that can encrypt via TLS / SRTP and enable this feature — the server will understand and pick up encryption. <br><br><h4>  Safety and privacy </h4><br>  In our opinion, the messenger turned out to be more secure than other advertised messengers, mainly due to the simple reason that we do not require a number and do not require access to the notebook. <br><br>  Even if we imagine a hypothetical case that the MITM attack succeeded and managed to decipher the messages, it will be completely incomprehensible to whom the correspondence belongs because there is no most important thing - the telephone number and the sides of communication cannot be identified. <br><br><h4>  Communication only after approval of the request </h4><br>  The messenger can not communicate with the user without sending a request to start communication and without obtaining permission from the other party. <br><br>  Spam protection. <br><br><h4>  Standard features </h4><br><img src="https://habrastorage.org/webt/hr/6z/eb/hr6zebri_fzwyqeeq-ndxckk28e.jpeg"><br><br>  All the standard functions are implemented in messengers: <br><br>  - text chat <br>  - send audio messages <br>  - sending files <br>  - location sharing <br>  - audio / video calls <br>  - group chats without limiting the number of participants <br><br><h4>  Auto Delete Messages </h4><br><img src="https://habrastorage.org/webt/bw/yy/8u/bwyy8uvenzaxm2ctj-d9b4ljqn8.jpeg"><br><br>  In chat rooms, you can enable auto-deletion of a message after a specified period of time has passed. <br><br><h4>  Remote location request </h4><br><img src="https://habrastorage.org/webt/2h/lv/ll/2hlvllvdy9kqmpest5_y-3zyf4u.jpeg"><br><br>  A user in a particular chat can turn on permission to request a geolocation from another chat participant. <br><br>  As a result, the other party can receive information about the location of the interlocutor independently at any time when this function is activated. <br><br>  It may be useful to control the location of children, elderly relatives, etc. <br><br><h4>  Users near </h4><br><img src="https://habrastorage.org/webt/sn/ie/um/snieum0jr0bmzupqkpcpmunsqsm.jpeg"><br><br>  The Users beside function shows the distance to those users who also enabled this mode.  The distance is limited to 100 km. <br><br>  When you turn off this mode, you become invisible, but you do not see other users. <br><br><h4>  Push-to-talk mode (push to talk, walkie talkie, walkie talkie) </h4><br><img src="https://habrastorage.org/webt/mi/ep/x0/miepx0xxc7op3_grvw5nju_mhua.jpeg"><br><br>  Real-time PTT - radio mode is implemented in the messenger. <br>  The mode works if enabled for each chat participant. <br>  Also works in group chats.  If in the group chat someone does not have this mode, then he simply does not hear such messages. <br><br>  The number of participants in the group with a walkie-talkie is not limited. <br>  You can set the night mode — that is, set a period of time in which Walkie-Talkie messages will not be heard (for example, at night). <br><br><h4>  Live TV mode </h4><br><img src="https://habrastorage.org/webt/2s/zx/u0/2szxu06dhkrslvfoftec0jjjwxe.jpeg"><br><br>  The Live TV feature allows you to turn a user's smartphone into a video camera. <br>  You can enable this mode both for any user of the messenger and for a specific group. <br><br>  Allows you to quickly organize video surveillance of the office, apartment, cottage, cars, etc. <br><br><h4>  SIP integration </h4><br><img src="https://habrastorage.org/webt/ys/z2/pj/ysz2pjand-8d4p_loh1gh1on5lq.jpeg"><br><br>  SIP in the messenger is supported in two modes - SIP Trunk and SIP client. <br><br><h4>  SIP Trunk mode </h4><br>  Allows you to connect to a registered account in parallel any IP phone, VOIP gateway or trunk from any IP PBX (virtual, on Asterisk, etc.) <br><br>  In the appropriate section SIP equpment of any account are data to connect. <br>  If you connect an IP phone, then when you call from the messenger user there will be a call to both the application and the IP phone. <br><br>  With the application, you can make an intercom call that will establish the connection between the IP phone and the application. <br><br>  In the case of connecting a trunk from a VOIP PBX, the call will arrive respectively on the trunk of the PBX, i.e., you can make calls to any PBX from the messenger ecosystem and process them as if the DID connection was made. <br><br>  The number of simultaneous calls is not limited. <br><br><h4>  SIP client with push notification </h4><br><img src="https://habrastorage.org/webt/jj/k7/iz/jjk7izrra_v9epzl-5opqtq7yse.jpeg"><br><br>  SIP client mode is designed respectively for registering the messenger as a client, similarly to such applications as Csimple, Linphone, etc. <br><br>  But unlike these clients, the messenger can work in sleep mode and, accordingly, has very low consumption while waiting. <br><br>  As it is known, the problem of all SIP clients is that they must periodically maintain registration with the SIP registration server, which means sending registration packets periodically.  As a result, these customers can not go into standby mode and are always online, which discharges the smartphone battery.  As a result, most users use such clients only for outgoing calls. <br><br>  Our SIP client is deprived of this drawback - when an incoming call comes, a push notification arrives, which “wakes up” the application and only then does the launch occur. <br><br>  Those.  Now, if someone uses DID numbers with SIP registration, he can receive incoming calls to these numbers in the sleep mode of the smartphone. <br><br>  Up to 8 simultaneous SIP registrations are supported. <br><br>  It can be useful both for individuals who use VOIP providers for making inexpensive calls, and for business - you can bring the internal number of the office PBX to the instant messenger and not be afraid that such a mode will discharge the battery. <br><br>  Also found an interesting opportunity to work in this mode - the work of one SIP account, one account simultaneously on different devices. <br><br>  At the same time, if an incoming call comes to a SIP number, then all the phones ring at once. <br>  It may be useful for those who want to save, to take, for example, a paid account with one provider and scatter for several people. <br><br>  Or, for example, take one number for incoming calls and scatter it to several people at once (employees, relatives, etc.). <br><br>  It is done this way - we register once, i.e.  we get only one login. <br><br>  Next, we register with the SIP provider, get an account, register it in the messenger. <br>  Further, other users download the messenger and log in with the same login, since the messenger supports simultaneous work with one login from several devices. <br>  Now you can make calls under one SIP account and receive calls to one SIP number at the same time. <br><br>  The number of users is almost unlimited. <br><br><h2>  Amazon Alexa Echo Integration </h2><br><img src="https://habrastorage.org/webt/u1/5g/d8/u15gd8rven06z2kcjwpbrgxk38s.jpeg"><br><br>  We also integrated Alex's bot from Amazon into the messenger. <br><br>  As a result, almost all of Alex's skills are now available to messenger users. <br>  At the initial entry into this mode, you will need to either enter an existing login for Amazon or create a new one. <br><br>  With the help of Alex, you can find out the weather, time, order a taxi (Uber), pizza, make purchases on Amazon and much more - about 20,000 skills are available. <br><br>  But the most important thing is that you can control smart sockets, lamps, switches, thermostats, smart locks and even cars with your voice. <br><br>  Every day there is an increasing number of devices that support Alex, ranging from cheap switches from Sonoff for $ 5 and ending with Fitbit bracelets. <br><br>  We implemented integration with Alexa Echo in three modes: <br><br>  <b>- Voice control</b> <br><br>  Everything is clear here - we press the button, we say, the devices are turned on, or questions are being answered, etc. <br><br>  <b>- Execution of text commands</b> <br><br>  Analogue of the messenger - we write in the line questions or commands to Alex, they are executed. <br>  Convenient when you need to keep quiet. <br><br>  - Execution of predefined patterns of commands on tapu on buttons <br><br><img src="https://habrastorage.org/webt/mp/kt/8u/mpkt8ubwf_1vicioyc6hlphppjg.jpeg"><br><br>  In this case, buttons with pre-programmed commands (which are often executed) are created and then pressing them to execute them - like a remote control. <br>  Such a remote control works naturally without a limit on the distance; you can control a house thousands of kilometers away. <br>  It is useful then when it is necessary to observe silence and at the same time laziness or inconvenient to write text. <br><br>  <b>API for Alexa</b> <br><br>  We went further and implemented a simple API in order to be able to control all devices and generally Alexa from other devices — from Arduino, from another messenger — through the included instant messenger. <br>  In this case, you just need to run certain json commands. <br><br><h2>  Bots </h2><br><img src="https://habrastorage.org/webt/wr/si/oo/wrsiooh0kuqdeiy2_j4wge1gbxw.jpeg"><br><br>  In the messenger ecosystem, you can create bots. <br><br>  Bots are of two types: <br><br>  <b>Standard bots</b> <br><br>  They can be created by any user using the API. <br>  In the search bar, such bots are no different from ordinary users. <br><br>  <b>Business bots</b> <br><br>  They differ in that the name of such a bot begins with an ampersand @ and when added, they fall into a specific section and are not mixed in the general list with regular users. <br>  Only we can create such bots and they are official bots. <br>  This also achieves cybersquatting protection for official bots. <br><br>  <b>Business accounts</b> <br><br><img src="https://habrastorage.org/webt/1f/q4/wl/1fq4wl0c15xlyoimzssyvu7rike.jpeg"><br><br>  Business accounts are a collection of three entities: <br><br>  1. The official business page <br>  2. The official bot of the company (starting from the bot-business card to a simple online store) <br>  3. Integration with IP PBX companies - the ability for the average user to make direct audio / video calls to the support, technical support, etc. <br><br>  Business accounts in the names have an ampersand sign @ and also fall into a separate section in the messenger and are created only by the administration. </div>