<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Underwater Ultrasonic Range Finder Module</title>
  <meta name="description" content="This device was born in the process of working on a computer project for diving, which in its composition should have a narrow-beam sonar-range finder...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Underwater Ultrasonic Range Finder Module</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/29/i7/5o/29i75ogx2epaydtsdfrnhleybto.jpeg" alt="image"><br><br>  This device was born in the process of working on a computer project for diving, which in its composition should have a narrow-beam sonar-range finder.  Whether we were looking badly, or, indeed, there is nothing on the market suitable for the parameters, but in the end, instead of purchasing a ready-made module, we decided to invent our own rangefinder for a diving computer.  Moreover, the process of integration into a compact computer case seemed simpler when separating the emitter and the electronic circuit in accordance with the free space inside the case. <br><br>  While the diving computer is waiting for its time, we got the idea: what if we select a rangefinder in a separate project?  Since we had difficulty finding a suitable module for the underwater range finder, someone else must have encountered similar difficulties in searching. <br><a name="habracut"></a><br>  The initial requirements for the module were the following: <br><br><ul><li>  simple digital interface.  Ideally, a UART with text commands / responses. </li><li>  supply voltage - 5 volts </li><li>  as compact as possible waterproof case </li></ul><br>  In order not to delay with the narration, I cite immediately the original working scheme with some explanations in the text. <br><br><img src="https://habrastorage.org/webt/no/_c/z6/no_cz6hih-2rcbeqvjmhgdvbqp8.png" alt="image"><br><br>  As you can see, the scheme is a classic version, conditionally divided into three main blocks: <br><br><ul><li>  Manager </li><li>  Transmitting </li><li>  Receiving </li></ul><br>  The MK STM32F302K8U6 was chosen as a control element, as a good combination of price, performance and dimensions.  The responsibility of this unit is to generate a signal for the transmitting unit, digitize and process the signal from the receiving unit, and provide user applications with access to configure the system and measurement data in a convenient format. <br><br>  The transmitting unit contains: gate driver, power switches, matching-raising transformer, anti-parallel diode assembly.  The last element, generally speaking, is not necessary in such schemes, but, in our case, plays an important role in ‚Äúdisconnecting‚Äù the transformer at the reception stage, when the value of the effective voltage on the piezoelectric element is lower than the diode opening voltage, which helps to isolate the input stage of the received signal amplifier transformer. <br><br>  The receiving unit is the most demanding to the quality of performance, on which almost everything depends.  On the one hand, it must digest hundreds of volts at the input during the generation of the probe pulse.  On the other hand, to provide amplification of the signal with an amplitude of the order of a microvolt with an acceptable signal-to-noise ratio and to the level of confident detection and capture on the ADC.  Two components are responsible for the ability to remain unharmed at hundreds of volts at the input: a high-voltage capacitor C2, on which the alternating current is limited and a counter-parallel diode assembly that limits the voltage to acceptable values.  It should be noted that this circuit is capable of performing its task only in a pulsed mode with a duration of the order of tens of microseconds. <br><br>  For the signal amplification, there are three cascade active bandpass filters, of which the last two are narrow-band filters of the second order, which provide good frequency selectivity.  However, the price of a good frequency selectivity is a more rigorous approach to choosing errors for the frequency-generating components, otherwise it is not possible to ensure the stability of the parameters from instance to instance.  Within the budget of the device, the optimal for our task were the errors of 0.1% for resistors and 0.5% for capacitors.  Further, according to the scheme: amplitude detector and passive low-pass filter, to suppress carrier residues passing through the detector. <br><br>  As for the acoustic part of the device, which is not visible on the circuit diagram, here the basic element is the JGK.757681.008-172 piezoelectric disk, 12.9 mm in diameter, 3.1 mm thick, with a resonant frequency of 640 kHz.  This element is both a transmitter pulse transmitter and a receiver of the reflected signal.  On the water side, it is insulated with a quarter-wave matching element (polyurethane resin).  Together with the analog circuit, the emitter / receiver design makes a great contribution to the quality of the device as a whole.  The speed of sound in plastic, which is used in the emitter as a matching / insulating element, is 2400 m / s.  This determined the thickness of the matching element - 0.9 mm. <br><br><img src="https://habrastorage.org/webt/50/y4/xe/50y4xewief8hd4a9tyivcriljr8.jpeg" alt="image"><br><br>  In the prototype of the printed circuit board, there were some flaws, but we made this device work with the minimum acceptable mode by means of mounted installation.  That was enough to capture the characteristics of the pattern. <br><br><img src="https://habrastorage.org/webt/vg/cu/al/vgcualze9mwlozu2rg7jpontis8.jpeg" alt="image"><br><br>  As a stand for measuring the directivity, we didn‚Äôt think of anything better than using a plastic trough full of water, in which our rangefinder module is installed as an emitter, and at a short distance from it a receiver ‚Äî a piezoelectric element connected to an oscilloscope.  The rangefinder module can rotate left and right from 0 to 180 ¬∞, at this time we remove the oscillogram from the receiver and determine the amplitude of the received signal depending on the angle of rotation of the radiator. <br><br><img src="https://habrastorage.org/webt/ew/8b/ua/ew8buazp3savmo9gkoroiamd-ag.jpeg"><br><br><img src="https://habrastorage.org/webt/hx/au/n0/hxaun0kn2etjldezgsbhqgwes9w.jpeg"><br><br>  Below is a graph of the final radiation pattern. <br><br><img src="https://habrastorage.org/webt/3f/oa/u7/3foau7aju2lntu9tnt0eo0attyg.jpeg"><br><br>  Further measurements were carried out in an improvised pool - a plastic pipe filled with water to a height of 1 meter.  By the way, we managed to detect three reflections from the bottom and the surface of the water, before the signal completely disappeared. <br><br>  Since we decided to use the UART interface with simple text commands (at the first stage), it was not too difficult to implement a combination of the rangefinder module with the GUI on a computer made in Processing. <br><br>  In the photo - an attempt to scan the bottom of a local reservoir using a ship with a rangefinder module installed and a radio transmitter to receive data from the module to a laptop.  Unfortunately, in moments of exciting testing of a piece of iron, you least think about the quality of the photos of the process. <br><br><img src="https://habrastorage.org/webt/2v/oi/ap/2voiapwbjxa0_4x_u4vrlazc-sg.jpeg"><br><br><img src="https://habrastorage.org/webt/ql/_2/me/ql_2meuodp47hc_q3-z0c_wnn0s.jpeg"><br><br>  And using the app for the smartphone Bluetooth Electronics and the USB-&gt; UART converter, you can realize a more mobile version of the test setup. <br><br><img src="https://habrastorage.org/webt/k9/oy/gf/k9oygfmxy1cua1enu-uv2pex45k.jpeg"><br><br><img src="https://habrastorage.org/webt/q8/ec/vc/q8ecvcfxtqjh-9w7vj-nyzzv-0c.jpeg"><br><br>  At the moment we are working on the following prototype of the rangefinder module, since there is really something to improve. <br><br>  For example, to realize a gradual amplification of the input signal so that the reflection from the nearest objects does not go off scale, and the amplification from distant objects is maximum.  Maybe use a cheaper element base.  Consider the option of filling the interior with a compound or silicone oil to seal and withstand high pressure. <br><br>  See you in the next issue! </div><p>Source: <a href="https://habr.com/ru/post/440222/">https://habr.com/ru/post/440222/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>