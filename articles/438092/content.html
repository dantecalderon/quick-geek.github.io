<div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/9i/0f/ph/9i0fphwieidaj5zcyevkyaxrkgo.jpeg"><br><br>  In past years, centralized attacks were carried out using IP telephony, now a new round, but using email.  Let us analyze the available electronic data on this attack. <br><br><blockquote>  Updated information on 02/01/2019. </blockquote><br><a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/l1/e5/xj/l1e5xjmfs_-o3zx8gozr8zm0ddu.jpeg"><br><br>  Problem: <br><br>  <i>2017: “The anonymity of the call is ensured by the fact that an attacker, using IP-telephony, can substitute any number of the caller, including the numbers of real uncomplicated subscribers from anywhere in the world.</i>  <i>This IP telephony feature makes it difficult for security officials to work.</i>  <i>Connecting the voice gateway of IP-telephony to the networks of telecom operators often happens illegally, with the substitution of the caller's number, IP-addresses and other identifiers ”</i> <br><br>  2019: According to the press services of the administrations and from the staff of medical institutions and schools in different regions and cities, they received emails with threats and demands to perform certain actions. <br><br>  Law enforcement agencies together with the executive authorities began to act in accordance with their powers, which meant checking each message. <br><br>  Institutions that were listed in the text of the letters, began to hold emergency events. <br><br>  <b>None of the facts on the received threats were confirmed, the work of the institutions was resumed in full.</b> <br><br><div class="spoiler">  <b class="spoiler_title">Initial data:</b> <div class="spoiler_text">  Let's try to abstract from the situation as a whole and go through the points from some published in the public domain emails, photos of which are presented below. <br><br><img src="https://habrastorage.org/webt/tx/cq/cy/txcqcyxfd4irts8b4mr9i31rvw0.jpeg"><br><br><img src="https://habrastorage.org/webt/ou/b8/zv/oub8zvbe0nrcqfps3btifeulkue.jpeg"><br><br><img src="https://habrastorage.org/webt/t7/sm/5o/t7sm5ob4l5sidrmvwkjoyjnlyy8.jpeg"><br><br><img src="https://habrastorage.org/webt/gg/6o/yj/gg6oyjrghobxrbhldfwchb029uc.jpeg"><br><br><img src="https://habrastorage.org/webt/kv/kl/zo/kvklzowg_xja0by_wrd6htavo9a.jpeg"><br><br><img src="https://habrastorage.org/webt/yn/pl/z_/ynplz_n9kms9trtbgvhgaf5rfxa.jpeg"><br><br>  Data on the information on the "official headers" in the letters there. <br></div></div><br>  <b>Data analysis:</b> <br><br>  All emails were sent using the free mailfence mail com service, which positions itself as a “secure and confidential email service.” <br><br>  At the moment, some providers in the Russian Federation have restricted access to this service. <br><br>  We will try to enter this service and register.  We get the following failure: <br><br><img src="https://habrastorage.org/webt/hg/vn/lh/hgvnlhdrnanlwi7toeaxgcvdc04.jpeg"><br><br>  Using the VPN plugin, you can go a little further and register: <br><br><img src="https://habrastorage.org/webt/mh/4e/o0/mh4eo0tcijivrg51-a4wxmk1hzc.jpeg"><br><br>  However, here we have this choice of possible email addresses. <br><br><img src="https://habrastorage.org/webt/9t/or/wm/9torwmsep65obaoampkpxv0crww.jpeg"><br><br>  Thus, there is a suspicion that the email addresses that were used in the attack were created quite a long time ago on this system, when there was such an opportunity to choose another domain name earlier.  This means that the attack was not spontaneous, and the addresses were created earlier by some pool. <br><br>  And why do we need to create a mailbox in this service? <br><br>  When registering, you must specify your working email address, which will send a link to confirm registration with the service. <br><br>  Next, we check how the <a href="https://mailfence.com/sw%3Ftype%3DL%26state%3D0%26lf%3Dmailfence%26nextpage%3D%252Fc%252Fmailfence%252Flogin.jsp%3FresetPassword%3D1">password reset</a> process takes place <a href="https://mailfence.com/sw%3Ftype%3DL%26state%3D0%26lf%3Dmailfence%26nextpage%3D%252Fc%252Fmailfence%252Flogin.jsp%3FresetPassword%3D1">in this service</a> . <br><br>  Enter your username and / or your e-mail address: <br>  Enter after the username or email (in the test case we have mail.ru) and we get: <br><br>  To reset your password, an e-mail was sent to: <br>  sin***@***mail.ru <br><br>  Thus, we can find out the first three characters of the user name and the last 5 characters of the second-level mail domain.  (thanks <a href="https://habr.com/ru/users/michaelkl/" class="user_link">michaelkl</a> for the <a href="https://habr.com/ru/post/438092/">comment!</a> ) <br><br>  Moreover, when requesting a password reset, you can specify a username or email. <br><br>  And according to the addresses from the sent e-mails, when requesting a password reset, you can specify only e-mail. <br><br><img src="https://habrastorage.org/webt/1x/gj/ri/1xgjrifk-4qllxwb_u8d9yydjuu.jpeg"><br><br>  putin.fsb2@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  kul***@***utoo.email <br><br><img src="https://habrastorage.org/webt/jp/jl/dv/jpjldvks0mycszvy8uksvewbxwm.jpeg"><br><br>  just.bro@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  bbl***@***imail.com <br><br>  A single thread leads to gmail.com: <br><br><img src="https://habrastorage.org/webt/y2/lb/un/y2lbunsvub-4mdjwp9yvjn5a9ng.jpeg"><br><br>  kor.bol@mailfence.com <br>  to reset your password, an e-mail was sent to: <br>  vov***@***gmail.com <br><br>  Here you can search for the full address, but for a long time: <br><br><img src="https://habrastorage.org/webt/xu/fp/iu/xufpiu2d3icy_vhh1mgrx7dv8ne.jpeg"><br><br>  This address, by the way, is out of the entire list by the fact that it has a connection with gmail.com. <br><br>  Another address is there: <br>  kiano.lok@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  put***@***gmail.com <br><br>  There is a suspicion that this is an imitator, as an option, which also contributed to the wave of mailings, but with mercenary goals in order to commit its malicious intent in place of events (theft, data deletion, when no one is near, etc.). <br><br>  Further, if somewhere in the address there are numbers, then by slightly changing or removing them, we can also check these addresses: <br><br>  putin.fsb@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  poc***@***cloud.info <br><br>  putin.fsb1@mailfence.com <br>  o reset your password, an e-mail was sent to: <br>  joo***@***email.com <br><br>  putin.fsb3@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  bud***@***email.com <br><br>  putin.fsb4@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  bep***@***itnow.com <br><br>  Thus, you can still expect to receive letters from these email addresses. <br><br>  And here, nevertheless, for the registration in the mailfence dot com, the service temp-mail dot org was used, <br><img src="https://habrastorage.org/webt/nn/vg/sv/nnvgsvs0v7msvoxg-j2uzukrrye.jpeg"><br><br>  As a result, two different mail services were used in eight email addresses. <br><br>  Addition: new letters also come from the free mail mail dot bg mail server. <br><br>  jekson.lo1@mailfence.com <br>  o reset your password, an e-mail was sent to: <br>  pet***@***mail.bg <br><br>  Data from MosIgra: <br>  <a href="https://habr.com/ru/company/mosigra/blog/439036/">habr.com/ru/company/mosigra/blog/439036</a> <br>  laki.kak@mailfence.com <br>  To reset your password, an e-mail was sent to: <br>  ale***@***mail.uk <br><br>  How the victims were chosen for the attack, judging by the mailing lists, it is clear that the addresses were copied from the websites of state institutions or “driven in” manually, because these data are publicly available. <br><br>  The range of simultaneous recipients in the letters (2-6-10) is small, so that the mail servers do not restrict the distribution and the letters do not fall into the "Spam" folder. <br><br><div class="spoiler">  <b class="spoiler_title">Excerpts from the service headers:</b> <div class="spoiler_text"> Received: from wilbur.contactoffice.com (wilbur.contactoffice.com [212.3.242.68]) <br>  (Client certificate not present) <br>  Return-Path: putin.fsb3@mailfence.com <br>  domain of mailfence.com designates 212.3.242.68 as permitted sender, <br>  rule = [ip4: 212.3.242.64/26]) smtp.mail=putin.fsb3@mailfence.com;  dkim = pass <br>  DKIM-Signature: v = 1;  a = rsa-sha256;  c = relaxed / simple;  d = mailfence.com; <br>  X-Priority: 3 <br>  Reply-To: Putin FSB &lt;putin.fsb3@mailfence.com&gt; <br>  From: Putin FSB &lt;putin.fsb3@mailfence.com&gt; <br>  X-Mailer: ContactOffice Mail <br>  X-ContactOffice-Account: com: 188677102 <br><br>  Received: from mxfront13g.mail.yandex.net ([127.0.0.1]) <br>  by mxfront13g.mail.yandex.net with LMTP id a6sJli0I <br>  for &lt;info@mosigra.ru&gt;;  Tue, Feb 5 2019 11:00:14 +0300 <br>  Received: from wilbur.contactoffice.com (wilbur.contactoffice.com [212.3.242.68]) <br>  by mxfront13g.mail.yandex.net (nwsmtp / Yandex) with ESMTPS id jttuF4mQRo-0DAa1MBL; <br>  Tue 05 Feb 2019 11:00:13 +0300 <br>  (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits)) <br>  (Client certificate not present) <br>  Return-Path: laki.kak@mailfence.com <br>  X-Yandex-Front: mxfront13g.mail.yandex.net <br>  X-Yandex-TimeMark: 1549353613 <br>  Authentication-Results: mxfront13g.mail.yandex.net;  spf = pass (mxfront13g.mail.yandex.net: domain authorized Sender, rule = [ip4: 212.3.242.64/26]) smtp.mail=laki.kak@mailfence.com;  dkim = pass header.i=@mailfence.com <br>  X-Yandex-Spam: 2 <br>  X-Yandex-Fwd: MzM4MDAwNDcyNDYzOTM2Mzg1OSwyMTg3Njc1NDQ5ODIwMzIwNzMz <br>  Received: from ichabod.co-bxl (ichabod.co-bxl [10.2.0.36]) <br>  by wilbur.contactoffice.com (Postfix) with ESMTP id 16350329D; <br>  Tue Feb 5, 2019 09:00:13 +0100 (CET) <br>  DKIM-Signature: v = 1;  a = rsa-sha256;  c = relaxed / simple;  d = mailfence.com; <br>  s = 20160819-nLV10XS2;  t = 1549353613; <br>  bh = gADFkQslj8dDCkx + Y9OhJNmeT7fosViIkpUDPPk1UO8 =; <br>  h = Date: To: Subject: Reply-To: From: From; <br>  b = Th6eWs74xYE35Y5pouZD / 9vbA / oJZ6jyrtzWrMs3XilthYjL3DnwVm1SiysHGHr4J <br>  6ROHYI / HMAnLOJfv + JsKC574UzsmjU1yhikwYLakMPTWKiqcR6knC4mXkfWFm / fXHU <br>  LPod1MeMeNlD1rqEXnkr8wJk4GX / s6DzCUVxC5qzcv6ChEwa5DJOvIg0mxMxP9UfMr <br>  LaPBQIGOiELGYfFOWi8XwGW1BDFfKXCgE0vxYYo8lqgXuXN720BHTv + CksccUdo44v <br>  KyDZEQYqM7J3JhjL8GCiaWxfLBbEkLqYCHnRUEGyKbC2pqT23c2TaafXXW7g5raN63 <br>  WyVocjjQbTDpA == <br>  Date: Tue, Feb 5 2019 09:00:10 +0100 (CET) <br>  Message-ID: &lt;790975597.619629.1549353610731@ichabod.co-bxl&gt; <br>  MIME-Version: 1.0 <br>  Content-Type: text / plain;  charset = utf-8 <br>  Content-Transfer-Encoding: base64 <br>  To: info@torrogrill.ru, kapitoly_adm@cosmik.ru, kashirskaya.enkatc@enka.com, <br>  6112158@re-reserved.ru, info@mosigra.ru, info@toy.ru, <br>  filion@minisolife.ru, 6412027@re-reserved.ru, info@modi.ru, <br>  office@melonfashion.ru <br>  Subject: =? Utf-8? B? 0L7RgtCy0LXRgiDQvdCwINC30LDQv9GA0L7RgQ ==? = <br>  X-Priority: 3 <br>  Reply-To: laki kak &lt;laki.kak@mailfence.com&gt; <br>  From: laki kak &lt;laki.kak@mailfence.com&gt; <br>  X-Mailer: ContactOffice Mail <br>  X-ContactOffice-Account: com: 190697286 <br>  X-Yandex-Forward: c4503a689c840ee5c1704413e6045827 <br></div></div><br><br>  <b>Recommendations:</b> <br><br>  System administrators of institutions, if possible, check email more often, create a filter for emails from “mailfence dot com” in a separate folder and immediately report them, according to their job descriptions, save service headers and all data for further analysis. <br><br>  <b>Tactics:</b> <br><br>  Just the question - why so many email addresses are used in ezines? <br><br>  The answer is simple - the Achilles' heel of the service used is the monetization of services and the possibility of registering through one-time mailboxes (one-time mail service). <br><br>  1. So, most likely, all accounts used for mailing are now on a free plan, which includes only 500 MB emails. <br><br>  If this box is “filled up” with messages with attachments and overfilled, then it will first have to be cleaned in order to make further distribution.  Paid plans are already payment for services and additional opening of your bank data. <br><br>  So, you can help with this by sending letters as large as possible to the addresses below. <br><br>  putin.fsb@mailfence.com <br>  putin.fsb1@mailfence.com <br>  putin.fsb2@mailfence.com <br>  putin.fsb3@mailfence.com <br>  putin.fsb4@mailfence.com <br><br>  just.bro@mailfence.com <br>  kor.bol@mailfence.com <br>  kiano.lok@mailfence.com <br>  jekson.lo1@mailfence.com <br>  laki.kak@mailfence.com <br><br>  2. Interception of mailbox management by <a href="https://mailfence.com/sw%3Ftype%3DL%26state%3D0%26lf%3Dmailfence%26nextpage%3D%252Fc%252Fmailfence%252Flogin.jsp%3FresetPassword%3D1">resetting the password</a> and selecting a <a href="https://temp-mail.org/en/option/change/">login through the one-time mail service</a> . <br><br>  Theoretically, it is possible to get access to the mailboxes listed in item 1, if it is possible to perform a large amount of actions: <br>  - select the desired login and domain in the temp-mail org dot <br>  - send a password reset command to the address mailfence dot com <br>  - get an email about resetting your password in temp-mail org <br>  - login to your mailbox account at dot com <br><br>  Data for selection (where * is one or more characters (1-4 Latin letters most likely) in the user name): <br><br>  <u>Difficult situation:</u> <br>  password reset - putin.fsb1@mailfence.com <br>  one-time mail service - joo*@321-email.com <br>  one-time mail service - joo*@braun4email.com <br>  one-time mail service - joo*@utooemail.com <br><br>  password reset - putin.fsb3@mailfence.com <br>  one-time mail service - bud*@321-email.com <br>  one-time mail service - bud*@braun4email.com <br>  one-time mail service - bud*@utooemail.com <br><br>  <u>There is only one domain to check:</u> <br><br>  password reset - putin.fsb2@mailfence.com <br>  one-time mail service - kul*@utoo.email <br><br>  password reset - putin.fsb4@mailfence.com <br>  one-time mail service - bep*@4senditnow.com <br><br>  password reset - just.bro@mailfence.com <br>  one-time mail service - bbl*@heximail.com <br><br>  3. Alternatively, by iterating (by pressing the “delete” button in the service) of the <a href="https://temp-mail.org/en/option/delete/">staffed suggested logins</a> (4-8 characters long), find from the proposed new login that which starts with <b>kul / bep / bbl / bud / joo</b> . <br><br>  Item 3 can be implemented using software methods. <br><br>  If anyone is interested and can find access to at least one mailbox through a large brute force of data on the login in the one-time mail service and can (block) stop the mailing from it - it will be great. <br><br><blockquote>  We will not dwell on the linguistic and stylistic analysis of the content of the letters, although, coupled with spelling errors and some consonant syllables in the text, there is something to think about.  However, it is possible that this dialectic was introduced into the text specifically for compromise. <br><br>  This article is related to analytical topics, please follow the rules of the resource in the comments and not go beyond the generally accepted framework. <br></blockquote></div>