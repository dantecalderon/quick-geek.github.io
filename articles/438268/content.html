<div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/-r/bw/2w/-rbw2wnzmz1pueguwv8g8f0ttrc.jpeg"><br><br><h2>  Prologue </h2><br>  Verbalization of the article will start with a statement from one domestic "cyberpunk", which demonstrated the "0day-vulnerability in Virtualbox". <br><a name="habracut"></a><br><blockquote>  “The reason is the disagreement with the current realities in information security, more precisely, in the direction of security research and bug bounty. <br><br>  It is considered normal to wait for a patch for vulnerabilities for six months, if only these bugs are no longer in public access. <br><br>  In the area of ​​bug bounty programs is considered normal: <br><br><ol><li>  Wait more than a month until the vulnerability is verified and the decision to acquire it is announced. </li><li>  On the go, change the decision on whether the program will buy bugs for this software.  Today you have learned that yes, they will buy, and in a week you come with bugs and exploits and get the answer that no, they will not. </li><li>  Do not have a clear list of applications for which the bugs will pay.  Yes, it is convenient for bug bounty organizers, no, it is inconvenient for researchers. </li><li>  Not have clearly defined upper and lower price limits for vulnerabilities.  There are a lot of factors affecting the price, but researchers need to see what it is worth wasting their time and what is not worth the day of work. </li><li>  Mania of greatness and marketing nonsense: give names to vulnerabilities and create websites for them;  hold a thousand conferences a year;  to exaggerate the importance of their work;  consider yourself a "savior of the world."  Go down to earth, Your Highness. " </li></ol><br>  ................... MorteNoir <br></blockquote>  I agree with the researcher. <br><br><h4>  Subject of publication - steganography </h4><br>  Steganography is a way of transmitting or storing information, taking into account the fact that such a transmission is secret <i>(Wikipedia)</i> , in other words, steganography is hiding the presence / existence of the secret message itself without attracting too much attention. <br><br>  At the end of last year, I discovered a vulnerability in the field of steganography: in the Android application “PixelKnoot”.  The PixelKnoot app is the development of world saviors The Guardian Project is a popular company with a worldwide reputation in the field of paranoid mobile <a href="http://bit.ly/2CohD7d">development</a> .  Orbot / Orweb / Orfox, etc. - the development of their hands business. <br>  The guys from the "star team" Guardianproject <a href="http://bit.ly/2QGT2mW">described</a> their application in the GP as <br><blockquote>  “★ INVISIBLE CHANGES: Even an experienced analyst should not be able to detect any message.  Bytes image should appear undistorted. " <br></blockquote><br>  on of.sayte so <br><blockquote>  ATTACK RESISTANT: It is an automated tool for detecting and steganographic content in images. </blockquote><br>  This is not quite so - “marketing nonsense!”.  I carried out a Stegoanalysis and found a way: to determine whether the presence of the secret message itself in the picture exists or not, encoded with PixelKnot.  Time for data analysis: analysis of such picture albums, where the secret, and where it is not, goes to the "weak machine" ~ 1s / 1picture. <br><br>  I contacted The Guardian Project technical support with my “thoughts” about the fact that everything is not so smooth from a technical point of view, as stated in their description of PixelKnot in GP and on of.sayte.  And these guys, like politicians, love boredom: neither bug bounty programs, nor timely feedback.  Received several "slow answers" asking not to disclose details of vulnerability to the public, and in the body of one of the letters such a wish from the "World's Saviors <a href="https://en.wikipedia.org/wiki/The_Guardian_Project_(software)">The Guardian Project</a> " themselves: to publish the PixelKnot problem on Github-e.  Hmm ... um ... these are the mental sounds. <br><br>  Some controversial logic: “not to disclose a 0day vulnerability to the public, but to publish it on Github”.  At the same time, “they” did not update PixelKnot for almost <b>two years</b> <i>(PixelKnot v1.0.1 from 17/02/2017, the number of downloads from GP&gt; 100k.)</i> .  Can you imagine what the gap is two years in the information security in the era of numbers?  In the body of the letter there were links to open source and PD.  <i>(one of such <a href="http://bit.ly/2U80EMm">conscientious</a> )</i> .  Of course, no one is going to contact you for a report or a “proposal to confirm a vulnerability / pay”.  Maybe from one side it looks quite righteous, but what about the “problem”? <br><br>  Like MorteNoir <i>(if I understood his message correctly ...)</i> , I don’t always like this policy, even though The Guardian projects are Open Source Projects.  “It made me angry” not that the “Gods” were vulnerable, but the fact that they very reluctantly respond to letters ~ “rms” letter once a month. <br><div class="spoiler">  <b class="spoiler_title">$ Retreat</b> <div class="spoiler_text">  In the article I will touch upon the domestic office: Superjob.  A commercial company that knows about a bug in its Android application since last fall and cannot fix it, shame IMHO). <br>  He drew a parallel between the two companies, because in both cases a bug report <i>(if they confirmed a vulnerability / bug)</i> requested a ridiculous amount - $ 10.  Superjob was stupid for a long time and didn’t understand where they had a problem there <i>(although I correctly described the problem “in words” in the context of technical support letters),</i> as soon as I suggested “filming a bug on a $ 10 video,” the company immediately gave back.  Technical support immediately confirmed the problem on its side and said “thank you”, but of course I didn’t deserve any $.  I do not want to pay a lot of attention to this superjob bug in this article, I’ll give answers to technical support letters <br><blockquote>  “Hello, ne555! <br>  Thank you for contacting Superjob.ru site support service. <br>  Ne555, I see that the application was not updated according to my recommendation.  Update it, please.  Also send screenshots of the screen, how you look at the moment with the impossibility of scrolling and moving the column to add.  intelligence.  We will try to figure it out. " <br></blockquote><br><blockquote>  “Hello, ne555! <br>  Thank you for contacting Superjob.ru site support service. <br>  ne555, thank you very much for the information!  The question was passed to the developers, we will try to correct this nuance in the next versions of the application. <br></blockquote><br><blockquote>  “Hello, ne555! <br>  Thank you for contacting Superjob.ru site support service. <br>  ne555, yes, we understand exactly where at the moment we have a flaw in the application and this question is still in the work of the developers.  Expect to be fixed in the next versions. ” <br></blockquote><br>  <b>The bug has not been eliminated since last autumn in the next versions of the application ...</b> <br></div></div><br>  For example, software for imitation - ON Veracrypt.  Free software with open source, but recently the guys offered their bug bounty <a href="http://bit.ly/2U5hThl">program</a> <i>(after finding a “serious error” in their code)</i> , I don’t have questions of ethical morality <i>(about revealing / not revealing details to the public)</i> . <br><br>  Initially and publicly, I slightly touched upon the PixelKnot steganography problem in one of my works: “Mobile Lab on Android for Penetration Testing”, of course, few people paid attention to the problem.  Later I came up with, organized a contest and timed it to the problem in steganography: PixelKnot.  Similarly, the metric shows low popularity, but this step more strongly aroused public interest in the problem in steganography.  Now I publish the vulnerability of PixelKnot in the media on Habré, which is what the “speech” below will go about. <br><br><h2>  () day-vulnerability in PixelKnot </h2><br>  Using the Android application PixelKnot hid the secret message in the picture.  The processed picture, like a picture, was about nothing - nothing has changed in it, and MAT / 2 did not reveal any aspects of the metadata of the processed photo. <br><br>  Compared binary with the original - nothing "such", except for processing the format JPEG. <br><img src="https://habrastorage.org/webt/1m/ab/qi/1mabqiuwgmegjqtofke5rrsql1k.jpeg"><br><br>  The dumped file on the PC, looked at different programs on GNU / Linux / Windows 7: GIMP / Photoshop and standard OS programs for viewing and editing images - nothing. <br>  I missed the original photo through Steghide / Stegosuite steganography and compared all instances to binwalk <i>(GNU / Linux)</i> - there is a clue.  The original image and the images processed in Steghide and Stegosuite were determined by the executable code, but the PixelKnot image was not <i>(I checked a dozen more images processed in PixelKnot - none of them “passed” the binwalk, but this is not enough ...)</i> . <br><img src="https://habrastorage.org/webt/dk/wq/fp/dkwqfpozjded3q-h68ljnvs531u.png"><br>  PixelKnot processed image - binwalk don't define. <br><br>  I tried the bruthos attack <a href="https://github.com/Paradoxis/StegCracker">Stegcracker</a> - nothing <i>(SC - brutes photos, processed only in Steghide)</i> <br>  Held bruthos attack Stegbreak - nothing <i>(the tool is very ancient, brut, but does not understand the steganography of PixelKnot / Steghide / Stegosuite).</i> <br><br>  Engaged light infantry: a modified tool 15 years old - <a href="https://github.com/s-fiebig/stegdetect-stegbreak">Stegdetect</a> <br><img src="https://habrastorage.org/webt/wt/dw/gz/wtdwgzmisb071zfrwznjjin3rva.png"><br>  From the results of the analysis I see that out of 5 photos processed in PixelKnot, two photos successfully obfuscated the tool, and also one picture processed in Steghide slipped unnoticed. <br><br>  Pull the coefficient.  luminance and chrominance components of the image <i>(since all the information about the image for the eye, including the secret, is contained either in coefficients or in components)</i> .  Empirically, something stands out: obvious artifacts in the "blue" in the picture PixelKnot <i>, but this analysis of the photo manually, with automatic steanalysis, such as photo albums, so "famously" the necessary coefficient / cop.</i>  <i>brightness and chromaticity to identify chaotic pixelate not pick up.</i> <br><img src="https://habrastorage.org/webt/0z/df/8t/0zdf8tddtfotd_3jonmmm8tdd3q.png"><br>  a fragment of the investigated photo, processed in PixelKnot. <br><br>  Then I realized the completely random thing that came to mind: I renamed the file, <u>discarding</u> the image extension <i>(.jpg / .png. PixelKnot.jpg&gt; PixelKnot)</i> .  Opened an image file without an extension using KDE / Mate / Windows / Android with standard image viewers - nothing, but it didn’t open in Photoshop - an error!  I think, here it is, found "Cibola"!  But no, Photoshop is angry and does not open the photo without the extension <i>(.jpg / ...)</i> in ordinary photos. <br><br>  He continued his steganalysis, opened the image without an extension in the GIMP, and received a similar error, as in Photoshop.  But!  GIMP, in contrast to Photoshop, opens ordinary pictures with a folded extension!  That is, GIMP is “stuck” on images processed in PixelKnot <i>(provided that the file processed in PixelKnot has an extension, or otherwise everything is fine / opens)</i> . <br><br>  He conducted a number of different and similar experiments / manipulations with “secret messages in pictures” in Stegosuite <i>(GUI)</i> and Steghide <i>(CLI)</i> .  These "friends" did not disappoint.  In a photo album, it was not always possible to calculate a picture with a secret message <i>(not having the original)</i> , that is, the problem of “revealing the fact of having a secret message in a picture” remained only with PixelKnot. <br><br>  <b>But how to carry out PixelKnot Steganalysis, if there are tens and hundreds of pictures with different extensions and so on <i>(how to search for “the only one in a haystack”)</i> ?</b> <br><br>  Swinging the found vulnerability: an effective way to stegoanalyze photos processed in PixelKnot on GNU / Linux. <br><br>  1) Open Double Commander&gt; group file renaming&gt; select photo album&gt; open file extension <i>(.jpg / .png / ...)</i> is an almost instant file operation. <br><br><img src="https://habrastorage.org/webt/q5/wl/xi/q5wlxircf5xhhj-gf6vnjvipd7c.jpeg"><br><br>  2) I open GIMP&gt; file&gt; open as layers&gt; select any photo album with previously expanded photo extensions.  I am waiting.  If among the images you find the processed photos in PixelKnot, then the GIMP software will issue, upon completion of processing all the files, the names of all the photos that contain the presence of a secret message.  On the analysis of such photos takes ~ 1s / 1 picture <i>(this is the Intel 2x CPU of the last decade).</i> <br><br><img src="https://habrastorage.org/webt/aa/km/mg/aakmmgw4_fyzgxmrxd74jnfdjhs.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/h12De8i9dzE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Epilogue </h2><br>  According to the F5 steganographic algorithm that uses The Guardian Project, PixelKnot hides a secret message in the body of the picture ( <i>not in the name and not in the metadata</i> ), for example, if the picture contains one word on a uniform background, this will not be enough to process the photo in PixelKnot.  With a few words on a uniform background, PixelKnot photo processing will be successful, but it will also be visible to the naked eye. <br><div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ol/hy/eh/olhyehrnbmqu6jgbvxcvzgyupuo.jpeg"><br></div></div><br>  A system is considered hacked if the analyst <i>succeeds</i> in proving at least the presence of a hidden message (the <i>task was completed successfully</i> ). <br>  I have no other technical claims to PixelKnot, on free Android firmware Resurrection Remix or LineageOS - PixelKnot software works without any failures, however, due to the demonstrated vulnerability, the PixelKnot application <b>completely</b> <u>loses</u> its meaning. <br><br>  <i>UPD, after a day.</i> <i><br></i>  <i>Thursday turned out to be a crazy day for Habr: dozens of articles were published, a lot of minuses flew.</i>  <i>Several publications were “poisoned”.</i> <i><br></i>  <i>It's funny that IT made a whipping (trampled) on a good article that came out on the same day with the following distinctive title: &lt;Definition of a “toxic personality” in IT&gt;.</i> <i><br></i>  <i>Another author showed a weakness: he deleted his article, later deleted his other work and deactivated his account on Habré (sawed out).</i> <i><br></i>  <i>Toxic behavior continued until the evening.</i>  <i>In the evening, an interesting thing happened to smooth out the consequences of the nihilism “someone” walked through all the articles (except minus ones) and added +3, but such voice manipulation was ineffective, and an hour later they served the second batch, only +2 put it to everyone.</i>  <i>Little, the next day (in the morning), another +3 were distributed.</i> <i><br></i>  <i>IMHO, do not want the "minuses" publish your articles on weekends, or publish on specialized resources.</i> <i><br><br></i> <div class="spoiler">  <i><b class="spoiler_title">Found in the open spaces of the network</b></i> <div class="spoiler_text"> <i><img src="https://habrastorage.org/webt/8k/1r/7m/8k1r7m_7tuwepu9xioz1umywjja.png"><br></i>  <i><a href="https://t.me/HNewsChat/314503">t.me/HNewsChat/314503</a></i> <i><br></i> </div></div> <i><br></i>  <i>The article will not be deleted by the author from the portal under any circumstances.</i> </div>