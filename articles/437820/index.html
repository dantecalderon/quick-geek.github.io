<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>50 shades of security Drupal</title>
  <meta name="description" content="1. For password hashing, a modified version of phpass is used , which was disowned on the official website. But they don‚Äôt rush to change the mechanis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>50 shades of security Drupal</h1><div class="post__text post__text-html js-mediator-article"><ol><li>  For password hashing, a modified version of <a href="https://www.openwall.com/phpass">phpass is used</a> , which was disowned on the official website.  But they don‚Äôt rush to change the mechanism <a href="https://www.drupal.org/project/drupal/issues/1845004">[# 1845004]</a> . </li><li>  They do not even want to give the opportunity to select the hashing mechanism <a href="https://www.drupal.org/project/drupal/issues/2939888">[# 2939888]</a> . </li><li>  The number of iterations for the persistence of hashing has not been updated for more than 7 years <a href="https://www.drupal.org/project/drupal/issues/1850638">[# 1850638]</a> , although an increase in iterations of at least 2 years has been <a href="https://www.drupal.org/project/drupal/issues/1203852">suggested [# 1203852]</a> . </li><li>  When using PostgreSQL, password hashes are compared case insensitive <a href="https://www.drupal.org/project/drupal/issues/2475539">[# 2475539]</a> . </li><li>  Also with PostgreSQL there are problems with SSL support <a href="https://www.drupal.org/project/drupal/issues/850600">[# 850600]</a> . </li><li>  The minimum allowed version of PostgreSQL 9.2, which has long been without security support <a href="https://www.drupal.org/project/drupal/issues/2846994">[# 2846994]</a> . </li><li>  The official build of Drupal contains outdated versions of vendor libraries (due to compatibility with PHP 5.5).  Some of them, like Zend, even have known vulnerabilities <a href="https://www.drupal.org/project/drupal/issues/2989631">[# 2989631]</a> . </li><li>  Also in the assembly are all the tests, test modules, test topics and vendor libraries for testing, which increases not only the size of the archive, but also the area of ‚Äã‚Äãpossible gaps <a href="https://www.drupal.org/project/drupal/issues/2338671">[# 2338671]</a> . </li><li>  The idea of ‚Äã‚Äãmoving executable files outside the site <a href="https://www.drupal.org/project/drupal/issues/1672986">[# 1672986] was also stalled</a> . </li><li>  Check for updates implemented using GET requests over an insecure HTTP protocol <a href="https://www.drupal.org/project/drupal/issues/1538118">[# 1538118]</a> .  With the MITM attack, you can slip any links to the archives of the modules (the domain and hash sums are not checked).  You can also collect information about the composition of the site, the list of developers and their activity (requests from local versions of sites match ip with accounts on d.org).  HTTP protocol allows you to place a script to collect information outside of drupal.org. </li><li>  A user with id = 1 is the most valuable object to attack, because he always has all permissions on the site, and also has all attempts to deprive him of these rights <a href="https://www.drupal.org/project/drupal/issues/540008">[# 540008]</a> . </li><li>  This behavior is not entirely obvious, since visually in the admin panel this user is no different from others.  But even an attempt to highlight this feature ended in nothing <a href="https://www.drupal.org/project/drupal/issues/572240">[# 572240]</a> . </li><li>  You can take control of this divine user with id = 1 by any administrator, or another user with the necessary permissions <a href="https://www.drupal.org/project/drupal/issues/39636">[# 39636]</a> . </li><li>  Certain rights implicitly give control over the entire site, but outwardly, they also do not stand out in any way <a href="https://www.drupal.org/project/drupal/issues/2846365">[# 2846365]</a> , <a href="https://www.drupal.org/project/drupal/issues/594412">[# 594412]</a> . </li><li>  Some rights may even be misleading.  For example, the right to view logs actually allows you to delete them <a href="https://www.drupal.org/project/drupal/issues/1635646">[# 1635646]</a> . </li><li>  Bringing order to the permissions has long been an urgent task, but it is simply ignored <a href="https://www.drupal.org/project/drupal/issues/2628870">[# 2628870]</a> , <a href="https://www.drupal.org/project/drupal/issues/2667018">[# 2667018]</a> . </li><li>  An administrator cannot delete a file object uploaded by another user, no matter how malicious <a href="https://www.drupal.org/project/drupal/issues/2949017">[# 2949017]</a> . </li><li>  The hook_file_download does not use the corresponding controller <a href="https://www.drupal.org/project/drupal/issues/2148353">[# 2148353]</a> for validation. </li><li>  Does not work validation for files on the client side <a href="https://www.drupal.org/project/drupal/issues/2938441">[# 2938441]</a> . </li><li>  Weak checks download arbitrary files <a href="https://www.drupal.org/project/drupal/issues/2543590">[# 2543590]</a> , not to mention all sorts of RarJpeg gluing. </li><li>  Some file checks rely only on the .htaccess rules <a href="https://www.drupal.org/project/drupal/issues/2829048">[# 2829048]</a> . </li><li>  In .htaccess, there are enough other security rules that are implicitly lost when switching to another environment (especially Nginx), but the implementation of similar rules of web.config has stalled <a href="https://www.drupal.org/project/drupal/issues/154339">[# 154339]</a> , <a href="https://www.drupal.org/project/drupal/issues/2669870">[# 2669870]</a> . </li><li>  By default, you can upload images to any site with Drupal 8 with a simple POST request consisting of the name of the registration form and a field with the user's avatar.  It is noteworthy that in Drupal 7, the withdrawal of such a field by default was refused <a href="https://www.drupal.org/project/drupal/issues/31056">[# 31056]</a> , but those times are over. </li><li>  When you repeatedly download a file with the same name, there is a problem with the implementation of the algorithm for generating unique file names <a href="https://www.drupal.org/project/drupal/issues/2684403">[# 2684403]</a> . </li><li>  Filtering image addresses is also lame.  Therefore, you can log off users with a picture with src = '/ user / logout' <a href="https://www.drupal.org/project/drupal/issues/144538">[# 144538]</a> , or implement a DOS attack by placing a couple of hundred pictures with src = 'very / hard / page'. </li><li>  Another way to eat resources is to load 1000x1 images into the fields, which are processed using the ‚ÄúScale and crop‚Äù effect <a href="https://www.drupal.org/project/drupal/issues/2931533">[# 2931533]</a> , <a href="https://www.drupal.org/project/drupal/issues/872206">[# 872206]</a> . </li><li>  You can clog the database with the garbage cache simply by going through the urls <a href="https://www.drupal.org/project/drupal/issues/1245482">[# 1245482]</a> , although the cache system and without any outside help perfectly take all the resources for storing the results that even from scratch would get faster <a href="https://www.drupal.org/project/drupal/issues/2888838">[# 2888838]</a> . </li><li>  You can load the site and clog the logs with error messages using special requests to contextual links <a href="https://www.drupal.org/project/drupal/issues/2864933">[# 2864933]</a> . </li><li>  Access to attached files and images is always there, regardless of access to the content <a href="https://www.drupal.org/project/drupal/issues/2904842">[# 2904842]</a> . </li><li>  Content comments will also remain available when content access is <a href="https://www.drupal.org/project/drupal/issues/1781766">denied [# 1781766]</a> . </li><li>  Registered to use on the site can be found by post on password recovery <a href="https://www.drupal.org/project/drupal/issues/1521996">[# 1521996]</a> . </li><li>  The password reset form is not flood protected <a href="https://www.drupal.org/project/drupal/issues/1681832">[# 1681832]</a> . </li><li>  When creating and checking passwords, without any warning, all whitespace characters ("\ t \ n \ r \ 0 \ x0B") are deleted around <a href="https://www.drupal.org/project/drupal/issues/1921576">[# 1921576]</a> .  This can be a surprise for the user, and a slight indulgence for the brute force algorithm. </li><li>  If you are not able to get a password hash for brute force, but there is a user session, then you can unlock the password without restrictions through the account itself, for example, changing the mailbox <a href="https://www.drupal.org/project/drupal/issues/2339399">[# 2339399]</a> . </li><li>  By the way, if anything, the user does not even know that his box has been changed, because the attempt to implement this feature has been <a href="https://www.drupal.org/project/drupal/issues/85494">stopped</a> for more than a year <a href="https://www.drupal.org/project/drupal/issues/85494">[# 85494]</a> . </li><li>  The session generation algorithm is also so-so <a href="https://www.drupal.org/project/drupal/issues/2238561">[# 2238561]</a> . </li><li>  Cookies flow between sites that are located in subfolders <a href="https://www.drupal.org/project/drupal/issues/2515054">[# 2515054]</a> . </li><li>  In some cases, you can block users by manipulating requests for incorrect password entry <a href="https://www.drupal.org/project/drupal/issues/2449335">[# 2449335]</a> . </li><li>  Access to editing templates Twig allows you to gain unlimited control over the site <a href="https://www.drupal.org/project/drupal/issues/2860607">[# 2860607]</a> . </li><li>  XSS attack through Twig attributes <a href="https://www.drupal.org/project/drupal/issues/2567743">[# 2567743]</a> , <a href="https://www.drupal.org/project/drupal/issues/2552837">[# 2552837]</a> , <a href="https://www.drupal.org/project/drupal/issues/2544110">[# 2544110] is stubbornly ignored</a> . </li><li>  You can also embed XSS in info files.  For example, through the description or package fields, which can be interesting to exploit through features <a href="https://www.drupal.org/project/drupal/issues/846430">[# 846430]</a> . </li><li>  The security header X-XSS-Protection <a href="https://www.drupal.org/project/drupal/issues/2868150">[# 2868150] is</a> not used. </li><li>  XSS can also be pushed through the class PlaingTextOutput method of rewriting, although the class name suggests the opposite <a href="https://www.drupal.org/project/drupal/issues/2896735">[# 2896735]</a> . </li><li>  It can also be a surprise that some methods check and cache the access rights of the current user, and not the one that was passed to them <a href="https://www.drupal.org/project/drupal/issues/2628870">[# 2628870]</a> , <a href="https://www.drupal.org/project/drupal/issues/2266809">[# 2266809]</a> . </li><li>  Due to incorrect cache settings, you can make it impossible for a user to view their own profile <a href="https://www.drupal.org/project/drupal/issues/2614230">[# 2614230]</a> .  A similar trick can be done with certain settings and with content <a href="https://www.drupal.org/project/drupal/issues/2982770">[# 2982770]</a> , and with media <a href="https://www.drupal.org/project/drupal/issues/2889855">[# 2889855]</a> . </li><li>  Statistics of material views can be easily manipulated through the usual for loop in the browser console, spinning thousands of views per minute, even if you do not have access to the material itself.  Even non-existent materials <a href="https://www.drupal.org/project/drupal/issues/2616330">[# 2616330]</a> can be wound. </li><li>  Lame external validation <a href="https://www.drupal.org/project/drupal/issues/2691099">[# 2691099]</a> , <a href="https://www.drupal.org/project/drupal/issues/2652236">[# 2652236]</a> . </li><li>  There is no full protection from <a href="http://breachattack.com/">breachattack.com</a> <a href="https://www.drupal.org/project/drupal/issues/2234243">[# 2234243]</a> . </li><li>  If you configure Content Security Policy, then the content editor <a href="https://www.drupal.org/project/drupal/issues/2789139">[# 2789139]</a> falls off. </li><li>  This is an amateur collection that does not pretend to anything.  Maybe someone knows holes pohlesche?  From 30/01/2019 to 10/15/2020, there is a <a href="https://juliareda.eu/2018/12/eu-fossa-bug-bounties/">bounty</a> from the EU with a budget of ‚Ç¨ 89,000.00.  You can try to fix something.  But if it does not work out - do not despair, the mantels of this project are trained to maneuver supremely between tasks to keep Drupal in one place for years. </li>
</ol></div><p>Source: <a href="https://habr.com/ru/post/437820/">https://habr.com/ru/post/437820/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>