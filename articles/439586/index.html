<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SPBm protocol as the basis of Extreme Automated Campus</title>
  <meta name="description" content="Extreme Networks Extreme Automated Campus solutions provide the ability to simultaneously use multiple transmission paths and quickly recover in the e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>SPBm protocol as the basis of Extreme Automated Campus</h1><div class="post__text post__text-html js-mediator-article">  Extreme Networks Extreme Automated Campus solutions provide the ability to simultaneously use multiple transmission paths and quickly recover in the event of an accident.  A network consisting of multiple physical switches is one distributed network.  Traffic, at the same time, always goes along the shortest available path. <br>  Extreme Automated Campus is basically building an Ethernet Fabric based on the symbiosis of IEEE 802.1ah, 802.1aq and RFC6329 standards.  How it works, why it is easy and convenient to install, scale and administer the open in our article. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i4/po/mt/i4pomtyluijv9l_zqwz_ejfs2zy.jpeg" alt="image"></div><a name="habracut"></a><br>  The ‚ÄúData plane‚Äù of the factory is an <a href="https://ru.wikipedia.org/wiki/IEEE_802.1ah-2008">IEEE 802.1ah</a> implementation, when the ethernet packet is completely, together with the header, encapsulated in a new ethernet packet, which is why it is called MAC-in-MAC or another PBB (Provider Backbone Bridges).  Since MAC-in-MAC is already supported by the hardware by most of the chipsets released to the market, this, in fact, predetermined its greater popularity in comparison with the TRILL protocol. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tb/8t/d6/tb8td6wwmsabxvresfky87u2nk0.jpeg" alt="image"></div><br><br>  In the 802.1ah header, in addition to the MAC addresses and the backbone VLAN number, which are necessary for sending packets between the nodes of the factory, the I-SID (Individual Service ID) field is also transmitted, which determines the user traffic belonging to a particular service.  The I-SID field has a length of 24 bit, so theoretically the factory can switch over 16.7 million different services. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kt/cj/6f/ktcj6fwf_c1puyjpftrfdgt20ei.jpeg" alt="image"></div><br><br>  The ‚ÄúControl Plane‚Äù of the factory is the SPB ‚ÄúShortest Path Bridging‚Äù protocol, which is approved by the <a href="https://ru.wikipedia.org/wiki/IEEE_802.1aq">IEEE 802.1aq</a> standard.  The standard itself describes two different modes of operation for SPBv and SPBm, based on VLAN and MAC-in-MAC, respectively.  In our particular case, SPBm is implemented.  The standard introduces a specific new terminology: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3o/2v/lt/3o2vltfefrhosdlgk57-tto1ll0.jpeg" alt="image"></div><br><br>  BEB - Backbone Edge Bridge <br>  BCB - Backbone Core Bridge <br>  B-VLAN - Backbone VLAN <br>  C-VLAN - Customer VLAN <br>  UNI - User to Network Interface <br>  NNI - Network to Network Interface <br>  VSN - Virtual Service Network <br><br>  The terms themselves do not really need an explanation, but for those who are familiar with MPLS they will recall terms used such as P-router, PE-router, LSP, L2 / L3VPN ... <br><br>  The SPBm logic itself is implemented using the IS-IS protocol.  <a href="https://tools.ietf.org/html/rfc6329">RFC6329</a> - <i>‚ÄúIS-IS Extensions Supporting IEEE 802.1aq Shortest Path Bridging‚Äù</i> describes the additional TLVs necessary for SPB to work correctly. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mf/a8/3z/mfa83zm-zrikdf3wklzwd2c-n0w.jpeg" alt="image"></div><br><br>  All switches included in the factory first establish a neighborhood using IS-IS and then form the L1 IS-IS area.  Then each node calculates using the Dijkstra algorithm SPT (Shortest Path Tree) from itself to all other nodes.  Then, using IS-IS, the B-VLAN FIB is filled.  For B-VLAN, ‚Äúflooding, broadcasting, learning‚Äù is disabled, ports cannot be added manually either.  Actually, this is why the trunk MAC addresses are always known and under operator control, C-MACs are encapsulated in the 802.1ah header, and no study of these MACs takes place inside the factory. <br>  For Unicast, a single SPT option is calculated for each configured B-VLAN.  An example of a filled Unicast FIB might look like this. <br><br><pre><code class="plaintext hljs">Switch# show isis spbm unicast-fib ================================================================================ SPBM UNICAST FIB ENTRY INFO ================================================================================ DESTINATION BVLAN SYSID HOST-NAME OUTGOING COST ADDRESS INTERFACE -------------------------------------------------------------------------------- 00:16:ca:23:73:df 1000 0016.ca23.73df SPBM-1 1/21 10 00:16:ca:23:73:df 2000 0016.ca23.73df SPBM-1 1/21 10 00:18:b0:bb:b3:df 1000 0018.b0bb.b3df SPBM-2 MLT-2 10 00:14:c7:e1:33:e0 1000 0018.b0bb.b3df SPBM-2 MLT-2 10 00:18:b0:bb:b3:df 2000 0018.b0bb.b3df SPBM-2 MLT-2 10 -------------------------------------------------------------------------------- Total number of SPBM UNICAST FIB entries 5 --------------------------------------------------------------------------------</code> </pre> <br>  For Multicast, all possible SPT pairs are calculated. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sq/x3/q8/sqx3q8coortpq_o6c9yknxudopa.jpeg" alt="image"></div><br><br>  For example, for a service terminated on 4 BEBs, 4 SPTs will be calculated for each B-VLAN.  Each such SPT is calculated based on the I-SID of the configured service and BEB which is the root of this tree.  Each SPBM node has its own multicast address for each VSN.  This address (according to the standard) consists of 2 parts ‚ÄúNickname / Source B-MAC‚Äù + ‚ÄúI-SID‚Äù <br><br>  <b>For example:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/br/yv/rt/bryvrtkezkzvjydstw4hij6hih4.jpeg" alt="image"></div><br><br>  <b>Source: 0A-BC-DE / ISID: fe-dc-ba (I-SID 16,702,650)</b> <b><br></b>  <b>MMAC-DA: A <i>3</i> -BC-DE-FE-DC-BA</b> <br>  (A-shifts into place ‚ÄúMSB‚Äù upper four bits; 3 - fixed value) <br><br>  An example of a filled multicast FIB: <br><br><pre> <code class="plaintext hljs">Switch:1(config)#show isis spbm multicast-fib ========================================================================================== SPBM MULTICAST FIB ENTRY INFO ========================================================================================== MCAST DA ISID BVLAN SYSID HOST-NAME OUTGOING-INTERFACES INCOMING INTERFACE ------------------------------------------------------------------------------------------ 03:00:07:e4:e2:02 15000066 1001 0077.0077.0077 Switch-25 1/33 MLT-2 03:00:08:e4:e2:02 15000066 1001 0088.0088.0088 Switch-33 1/50,1/33 40.40.40.40 03:00:41:00:04:4d 1101 4058 00bb.0000.4100 Switch-1(*)1/3,1/49,0.0.0.0 TunnelHQ 03:00:41:00:04:4f 1103 4058 00bb.0000.4100 Switch-1(*)1/3,1/49,0.0.0.0 cpp ------------------------------------------------------------------------------------------ Total number of SPBM MULTICAST FIB entries 4 ------------------------------------------------------------------------------------------</code> </pre><br>  To prevent loops, the factory uses RPFC (Reverse Path Forwarding Check), the logic of which is also provided using IS-IS.  With RPFC, traffic is only received from a valid ‚Äúsource B-MAC / VLAN‚Äù, the remaining packets are discarded. <br>  Actually, after this it remains only to register the necessary services, the tincture of which is performed only on the border of the factory (that is, BEB switches). <br>  Examples of supported services are presented below. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ca/gj/xt/cagjxta8som533ku_ls_wcw6vha.jpeg" alt="image"></div><br><br>  The features when working with IP multicast streams should include the following: <br><br><ul><li>  In an existing VSN, when receiving an IP multicast stream, the factory assigns a service I-SID (16000001 - 16600000) and sends this information in the form of a TLV 185/186 </li><li>  After IGMP join in this VSN, the factory calculates SPT for the service I-SID and fills in the FIB </li></ul><br>  <b>Advantages of "Extreme Automated Campus":</b> <br><br>  ‚Ä¢ Works on open standards <br>  ‚Ä¢ Supports standard Ethernet OAM tools - IEEE 802.1ag and ITU-T Y.1731 <br>  ‚Ä¢ IS-IS operates at L2 level; no IP configuration is required inside the factory <br>  ‚Ä¢ SPT (Shortest path tree) is calculated on the basis of metrics and there are no blocked links. <br>  ‚Ä¢ No need to configure STP in the factory kernel <br>  ‚Ä¢ All participants in the factory after the calculations have the same set of SPT <br>  ‚Ä¢ Symmetrical path between any two nodes <br>  ‚Ä¢ RPFC (Reverse Path Forwarding Check) fixes loops <br>  ‚Ä¢ ECMP (Equal Cost Multiple Paths) support for balancing <br>  ‚Ä¢ Support for sending multicast ‚Äú1-many‚Äù, ‚Äúmany-1‚Äù, ‚Äúmany-many‚Äù <br>  ‚Ä¢ Factory is one virtual hop for user traffic <br>  ‚Ä¢ Factory work on top of any physical topology: ring, full-mesh, partial-mesh, daisy-chain ... <br>  ‚Ä¢ Highly scalable up to 1000 nodes in one factory. <br>  ‚Ä¢ Setting up services only at the factory border <br>  ‚Ä¢ Minimization of the human factor <br>  ‚Ä¢ Convergence after failures up to 200ms <br><br>  UPD: A VOSS virtual machine image for testing Extreme Automated Campus can be downloaded on <a href="https://github.com/extremenetworks/Virtual_VOSS">github.</a> </div><p>Source: <a href="https://habr.com/ru/post/439586/">https://habr.com/ru/post/439586/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>