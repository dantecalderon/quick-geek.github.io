<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Excel metadata files</title>
  <meta name="description" content="Not so long ago, I faced the task of analyzing the number of Excel files created in a particular month of the year. I will not go into details, I will...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Excel metadata files</h1><div class="post__text post__text-html js-mediator-article"><p>  Not so long ago, I faced the task of analyzing the number of Excel files created in a particular month of the year.  I will not go into details, I will say briefly: to evaluate the work of employees of one firm.  There were about a thousand files available and the essence of the task was to make a clear graph in the form of a histogram for the head of the company, in which month of the year and how many files were made (these were invoices). <a name="habracut"></a><br>  I thought it would be nice to use file metadata for this purpose, i.e.  run the available files on a cycle, extract the file creation dates and load it all as a list into Matplotlib to create a histogram. </p><br><p>  I have never worked with metadata before this time, although there was a need from time to time, but it was managed by other means, so there was no experience.  And in the next morning, having made sandwiches and hovering a liter cup of coffee, he began to implement his idea. </p><br><p>  "Started" of course strongly said.  First of all, it is natural to search the Internet for information about metadata, about working with them in Python, similar projects, etc.  Almost immediately I came across the oletools module for Python, it is on both GitHub and PyPi, there is some good documentation.  I studied her for a couple of hours.  Installed oletools.  Everything worked, the metadata was correctly extracted.  But.  In the terminal.  I needed a script with a loop.  Wherever I didn‚Äôt search on the Internet how to make friends oletools and IDLE, I reached 15 (!) Pages in a search engine.  Information zero. </p><br><p>  I am sure, without a doubt, that this is a wonderful module, probably very powerful, but it didn‚Äôt come to me at all.  In the next attempt (by the evening) to force the script to somehow extract the file metadata, another exception was raised.  And here I noticed that oletools loads the olefile module for work.  I typed in a search engine and what was my surprise when I discovered that this was exactly what I had been looking for all day.  Very clear documentation.  I read it in half an hour and immediately, as I read, I sketched a script. </p><br><pre><code class="plaintext hljs">–°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ olefile –≤ —Å–∏—Å—Ç–µ–º–µ: pip3 install --user olefile</code> </pre> <br><p>  And here is the script itself that extracts metadata from an Excel file (I only needed the value of meta.last_saved_time): </p><br><pre> <code class="plaintext hljs">import olefile File_Ole='File.xls' assert olefile.isOleFile(File_Ole) # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ OLE —Ñ–∞–π–ª–∞ ole = olefile.OleFileIO(File_Ole) meta = ole.get_metadata() # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö print('–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞: '+str(meta.create_time)) # –í—ã–≤–æ–¥ –¥–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ print('–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: '+str(meta.last_saved_time))# –í—ã–≤–æ–¥ –¥–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ meta.dump() # –í—ã–≤–æ–¥ –≤—Å–µ—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –Ω–∞ —ç–∫—Ä–∞–Ω ole.close() # –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞</code> </pre> <br><p>  I will not give here all the code of my script, my task in this post was to tell about simple and fast extraction of metadata from an Excel file using the olefile module.  By the way, this module extracts metadata from a variety of file formats, more information <a href="https://www.decalage.info/olefile">can be found in the documentation</a> . </p><br><p>  It is also worth noting for the sake of fairness that olefile extracts metadata only from Excel 1997-2003 files, i.e.  with the .xls extension.  For .xlsx files, I wrote a converter with the pyexcel module. </p><br><p>  Well that's all.  Thank you for your attention, I hope my post will help someone save time, nerves and, most importantly, keep a good mood. </p></div><p>Source: <a href="https://habr.com/ru/post/439358/">https://habr.com/ru/post/439358/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>