<div class="post__text post__text-html js-mediator-article">  If your application has a registration function that includes the ability or necessity to enter a new username and password, you will most likely be interested in the innovation in <a href="https://apple.com/ru/ios/ios-12/">“iOS 12”</a> , which I would like to describe.  This is a service that comes up with new passwords for the user, automatically inserts them into the required fields and safely stores them in <a href="https://developer.apple.com/documentation/security/keychain_services">Keychain</a> . <br><a name="habracut"></a><br>  Automatically generated system passwords are the most resistant to selection (being randomly generated sequences of characters - adjusted for customizable restrictions, but more on that later), relieve application users from having to invent a sequence on their own and flexibly adjust to the needs of a particular application.  Support for new functionality is quite easily provided, but not without features.  But first things first. <br><br><h3>  Rights and obligations </h3><br>  First of all, the application must declare its desire to use this functionality.  In the <a href="https://help.apple.com/xcode/mac/current/">“Capabilities”</a> list of the corresponding <a href="https://developer.apple.com/library/archive/featuredarticles/XcodeConcepts/Concept-Targets.html">“Target”,</a> you must first have a domain in the <a href="https://developer.apple.com/documentation/security/password_autofill/setting_up_an_app_s_associated_domains">“Associated Domains”</a> list.  Strangely enough, the application must have an “Associated Domain” in order to be able to use the generated passwords and store them in the user's Keychain (these two functions are interconnected, and generation cannot be used separately from storage). <br><br>  If the application already supports the <a href="https://developer.apple.com/documentation/security/shared_web_credentials">use of shared accounts with your site (the so-called "Shared Credentials")</a> , then this step is already behind.  It may also be already behind, and if the application supports <a href="https://developer.apple.com/ios/universal-links/">Universal Links</a> or another mechanism for handling external <a href="https://en.wikipedia.org/wiki/URL">URLs</a> . <br><br>  Anyway, after adding this compatibility, the application will have a new <a href="https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/AboutEntitlements.html">“Entitlement”</a> . <br><br>  In addition to this more general compatibility, the application should also have “Capatibility” <a href="https://help.apple.com/developer-account/">“AutoFill Credential Provider”</a> - this allows the application, if it has permission from the user, to use the system logins and passwords.  Adding this compatibility will cause the <a href="https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_developer_authentication-services_autofill-credential-provider">“AutoFill Credential Provider Entitlement”</a> permission <a href="https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_developer_authentication-services_autofill-credential-provider">to appear</a> . <br><blockquote>  By the way, adding this and other features is available only to members of <a href="https://developer.apple.com/support/app-capabilities/">the Apple Developer Program</a> . </blockquote>  The two functions listed must also be included in the Provisioning Profile application. <br><br><h3>  Dependencies used </h3><br>  Adding the appropriate compatibility will cause the <a href="https://developer.apple.com/documentation/authenticationservices">“AuthenticationServices”</a> <a href="https://en.wikipedia.org/wiki/Software_framework">framework to</a> appear in the Linked Frameworks and Libraries list of the corresponding “target”.  This moment has some features that are worth mentioning. <br><br>  Firstly, the automatic addition of the associated framework may not “work” the first time: when you run the application on a real device from my instance <a href="https://developer.apple.com/xcode/">of Xcode</a> version 10.1, the application immediately “crashed” due to the lack of “AuthenticationServices”.  Manual removal of the framework and adding it back to the list of related components solved the problem. <br><br>  Secondly, the automatic addition of the framework marks it as “Required”.  If your application implies the ability to work "under" "iOS" versions below 12, it will also cause it to crash at the launch stage "from under" operating systems of lower versions.  "AuthenticationServices" are available only for version 12th systems.  This problem is solved by marking the framework as <a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Concepts/WeakLinking.html">“Optional”</a> . <br><br><h3>  Support in text fields </h3><br>  To support the functionality of the text fields, the <a href="https://developer.apple.com/documentation/uikit/uitextinputtraits/1649656-textcontenttype"><code>textContentType</code></a> protocol's <a href="https://developer.apple.com/documentation/uikit/uitextinputtraits"><code>UITextInputTraits</code></a> variable is used.  The <a href="https://developer.apple.com/documentation/uikit/uitextfield"><code>UITextField</code></a> class, which is most likely used to enter the username and password in the application, already implements the requirements of the protocol we need. <br><br>  <code>textContentType</code> is a field of type <a href="https://developer.apple.com/documentation/uikit/uitextcontenttype"><code>UITextContentType</code></a> containing only a set of constants.  The one we need at the moment is <a href="https://developer.apple.com/documentation/uikit/uitextcontenttype/2980929-newpassword"><code>newPassword</code></a> , which is used to enter a new password currently being invented (not to be confused with just the <a href="https://developer.apple.com/documentation/uikit/uitextcontenttype/2865813-password"><code>password</code></a> used to enter an already existing password). <br><br><pre> <code class="plaintext hljs">let passwordTextField = UITextField() if #available(iOS 12, *) { passwordTextField.textContentType = .newPassword }</code> </pre> <br>  Setting the <code>textContentType</code> value <code>textContentType</code> wrapped in an <a href="https://en.wikipedia.org/wiki/Application_programming_interface">“API”</a> availability check, because, like the general functionality, this constant is only available starting from “iOS 12”. <br><br>  In addition to the content type, the text field must ensure secure data entry: <br><br><pre> <code class="plaintext hljs">passwordTextField.isSecureTextEntry = true</code> </pre> <br>  Although the application may well provide the functionality popular in our time to show and hide the entered password, the generated password will be offered only if at this moment the flag is <a href="https://developer.apple.com/documentation/swift/true"><code>true</code></a> . <br><br>  An interesting moment is connected with the content type of the text field: if there is no other field on the screen, with the content type <a href="https://developer.apple.com/documentation/uikit/uitextcontenttype/2866088-username"><code>username</code></a> , the automatically-generated password will not be offered.  This is due to the fact that the functionality is based not only on the specified content type of the text field, but on the <a href="https://developer.apple.com/documentation/security/password_autofill/enabling_password_autofill_on_a_text_input_view">heuristic analysis of the screen contents</a> . <br><br>  It seems that the password generation “breaks” the logic of the screens that require you to enter a new password for verification twice.  At least, I have not yet found a way to use these two functionalities together.  And it seems that <a href="https://stackoverflow.com/questions/52850197/ios-12-swift-strong-password-autofill-doesnt-work-as-expected">I am not alone</a> . <br><br>  It is worth mentioning that if the login semantically is an email address (and, therefore, really want to have the appropriate type of keyboard), the <a href="https://developer.apple.com/documentation/uikit/uitextinputtraits/1624457-keyboardtype">keyboard</a> and content <a href="https://developer.apple.com/documentation/uikit/uitextinputtraits/1624457-keyboardtype">types</a> can be combined: <br><br><pre> <code class="plaintext hljs">let userNameTextField = UITextField() userNameTextField.keyboardType = .emailAddress userNameTextField.textContentType = .username</code> </pre> <br><h3>  Password Requirements </h3><br>  Often, user passwords must comply with certain rules (have a certain length, include certain characters, etc.).  These rules can be specified so that the system takes them into account when generating passwords.  This is done through the <code>UITextInputTraits</code> <a href="https://developer.apple.com/documentation/uikit/uitextinputtraits/2980934-passwordrules"><code>passwordRules</code></a> property.  For example: <br><br><pre> <code class="plaintext hljs">if #available(iOS 12, *) { passwordTextField.passwordRules = UITextInputPasswordRules(descriptor: "required: upper; required: lower; required: digit; minlength: 8;") }</code> </pre> <br>  The property is also available only starting with "iOS 12". <br><br>  Property Type - <a href="https://developer.apple.com/documentation/uikit/uitextinputpasswordrules"><code>UITextInputPasswordRules</code></a> .  Initialization - using the string-handle.  The descriptor has an uncomplicated syntax and consists of simple password requirements, separated by a semicolon.  Each requirement is a key-value pair, separated by a colon.  A key is a type of a rule (for example, “necessarily includes” - <code>required</code> ), and a value is an element that must follow this rule (for example, numbers - <code>digit</code> ). <br><br>  In the example above, the descriptor means: <br><br><ul><li>  <code>required: upper</code> - the presence of at least one capital letter is required; </li><li>  <code>required: lower</code> - the same for at least one lower case letter; </li><li>  <code>required: digit</code> - the same for at least one small digit; </li><li>  <code>minlength: 8</code> - minimum length - eight characters. </li></ul><br>  A detailed listing of possible keys and values ​​can be found in a <a href="https://nshipster.com/uitextinputpasswordrules/">nice article published on the NSHipster website</a> . <br><br>  And <a href="https://apple.com/">“Apple”</a> offers a rather convenient <a href="https://developer.apple.com/password-rules/">assistant for writing descriptors</a> , which provides not only a convenient way of constructing them, but also checking the generated descriptors in the form of an unlimited number of generated examples.  There you can see which rules are applied by default. <br><br><h3>  Validation </h3><br>  Just in case, it should be clarified that the password generation mechanism does not provide validation of the data entered by the user - you need to take care of this yourself.  Which, of course, is quite logical, since  The user of the application can reject the proposed auto-generated password or even prohibit the generation of passwords and auto-complete fields. <br><br><h3>  Interface builder </h3><br>  What is remarkable and in the spirit of our time, all of the listed text field settings can be set in <a href="https://developer.apple.com/xcode/interface-builder/">“Interface Builder”</a> , up to “Password Rule”: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/098/29a/2cb/09829a2cb9624b92c8da4b938c424e48.png" alt="image"><br><br><h3>  Functionality check </h3><br>  The functionality is not complicated, but it has a number of nuances: when setting it up, you can easily forget something.  In this case, in the “debug” assemblies, when the corresponding text field is activated, the reason for which the functionality is not currently in effect will be displayed in the console. <br><br>  For example: <br><br><pre> <code class="plaintext hljs">[AutoFill] Cannot show Automatic Strong Passwords for app bundleID: &lt;...&gt; due to error: Cannot save passwords for this app. Make sure you have set up Associated Domains for your app and AutoFill Passwords is enabled in Settings</code> </pre> <br>  You should also always keep in mind that this type of functionality is among the actions for which user permission is required.  In this case, as many as two are required: <br><br>  1. iCloud Keychain; <br>  2. AutoFill. <br><br><h3>  Conclusion </h3><br>  This seems to be all that should be addressed while providing support for the new functionality.  If someone in the process of working on this has encountered other interesting features, I will comment once and, if necessary, will definitely supplement the article. <br><br>  The feature is quite interesting and, if used properly, is quite capable of improving the <a href="https://en.wikipedia.org/wiki/User_experience">user experience of</a> your application! </div>