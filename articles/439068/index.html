<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Spam campaign ‚ÄúLove you‚Äù redirected to Japan</title>
  <meta name="description" content="Studying the fresh wave of spam in Russia , we noticed another attack. Since mid-January 2019, the famous ‚ÄúLove you‚Äù campaign has been refined and red...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Spam campaign ‚ÄúLove you‚Äù redirected to Japan</h1><div class="post__text post__text-html js-mediator-article">  Studying the fresh <a href="https://habr.com/ru/company/eset/blog/437982/">wave of spam in Russia</a> , we noticed another attack.  Since mid-January 2019, the famous <a href="https://isc.sans.edu/forums/diary/Heartbreaking%2BEmails%2BLove%2BYou%2BMalspam/24512/">‚ÄúLove you‚Äù campaign has been</a> refined and redirected to Japan, where it is used to distribute the GandCrab 5.1 encoder. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ra/fh/ddrafhnk4sd9uhjypkigh7nvehk.jpeg"></div><br>  According to telemetry, the latest version of ‚ÄúLove you‚Äù was launched on January 28, 2019, its activity was approximately twice as high as the initial one (see the chart below).  As in mid-January, a set of malicious payloads is distributed with some updates using spam.  So, we have seen attempts to download a cryptominer, software for changing system settings, a malicious bootloader, the Phorpiex worm, and the GandCrab version 5.1 encoder. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/ko/g6/i0/kog6i0kmafgezzxhb51ya7kbxyw.png"><br><br>  <i>Figure 1. Detection of malicious JavaScript attachments distributed in the ‚ÄúLove you‚Äù campaign and its latest wave</i> <br><br>  As of January 29, 2019, the vast majority of detections are in Japan (95%), tens of thousands of malicious emails are detected every hour.  On the same day, JS / Danger.ScriptAttachment (according to the ESET classification - malicious JavaScript distributed via email attachments) was the fourth-largest threat in the world and # 1 threat in Japan (see below). <br><br><img src="https://habrastorage.org/webt/t9/zm/r1/t9zmr1crdhy5ynqz7ebllufh-ay.png"><br><br>  <i>Figure 2. JS / Danger.Script Attachment was the # 1 threat in Japan as of January 29</i> <br><br><h4>  Attack scenario </h4><br>  In the last campaign, the attackers changed the texts of the mailings, moving from ‚ÄúLove You‚Äù in the subject line to headlines related to Japan.  Many smiles remain in the subject and body of the letter. <br><br>  Topics of the letters that we saw during the analysis: <br><br>  - Yui Aragaki;) <br>  - Kyary Pamyu Pamyu;) <br>  - Kyoko Fukada;) <br>  - Yuriko Yoshitaka;) <br>  - Sheena Ringo;) <br>  - Misia;) <br>  (Japanese showbiz stars) <br><br>  The studied malicious attachments are ZIP archives disguised as images with the names of the PIC0- [9-digit-number] format 2019-jpg.zip.  The figure below shows examples of such letters. <br><br><img src="https://habrastorage.org/webt/ys/ij/ob/ysijob11j2fc-kqfn8xyysnalqc.png"><br>  <i>Figure 3. Examples of spam letters from the ‚ÄúJapanese‚Äù campaign</i> <br><br>  The ZIP archive contains a JavaScript file with the name in the same format, but ending only in .js.  After extracting and running, JavaScript loads the payload of the first stage from the attacker's C &amp; C server ‚Äî an EXE file detected by ESET products as Win32 / TrojanDownloader.Agent.EJN.  URLs that host this payload have a path ending in bl * wj * b.exe (the file name is changed) and krabler.exe;  This payload is loaded into C: \ Users \ [username] \ AppData \ Local \ Temp [random] .exe. <br><br>  The first stage payload downloads one of the following final payloads from the same C &amp; C server: <br><br>  - GandCrab version 5.1 encoder <br>  - crypto miner <br>  - worm Phorpiex <br>  - loader, working in accordance with the language settings (downloads the payload only if the language settings of the infected computer correspond to China, Vietnam, South Korea, Japan, Turkey, Germany, Australia or the UK) <br>  - software to change system settings <br><br>  GandCrab 5.1 encrypts files by adding a random five-character extension to their names.  Redemption claims that contain this extension in file names and their contents are created in each folder affected by the encryptor. <br><br><img src="https://habrastorage.org/webt/tm/g8/1u/tmg81uxqctzkbwq2j8nxxitkdh4.png"><br>  <i>Figure 4. GandCrab v5.1 buyout requirement</i> <br><br>  The payload of this campaign is downloaded from IP-address 92.63.197 [.] 153, the geolocation of which corresponds to Ukraine.  The address has been used in the ‚ÄúLove you‚Äù campaign since mid-January. <br><br><h3>  Indicators of compromise </h3><br>  <b>Examples of hashes of malicious ZIP attachments</b> <br> <code>8551C5F6BCA1B34D8BE6F1D392A41E91EEA9158B <br> BAAA91F700587BEA6FC469FD68BD8DE08A65D5C7 <br> 9CE6131C0313F6DD7E3A56D30C74D9E8E426D831 <br> 83A0D471C6425DE421145424E60F9B90B201A3DF <br> 57F94E450E2A504837F70D7B6E8E58CDDFA2B026</code> <br> <br>  ESET Detection: JS / Danger.ScriptAttachment <br><br>  <b>Examples of JavaScript hash loaders</b> <br> <code>cfe6331bdbd150a8cf9808f0b10e0fad4de5cda2 <br> c50f080689d9fb2ff6e731f72e18b8fe605f35e8 <br> 750474ff726bdbd34ffc223f430b021e6a356dd7 <br> 1445ea29bd624527517bfd34a7b7c0f1cf1787f6 <br> 791a9770daaf8454782d01a9308f0709576f75f9</code> <br> <br>  ESET detection: JS / TrojanDownloader.Agent.SYW or JS / TrojanDownloader.Nemucod.EDK <br><br>  <b>Examples of first stage payload hashes</b> <br> <code>47C1F1B9DC715D6054772B028AD5C8DF00A73FFC</code> <br> <br>  ESET detection: Win32 / TrojanDownloader.Agent.EJN <br><br>  <b>Examples of final payload hashes</b> <br>  Encoder GandCrab <code>885159F6F04133157871E1D9AA7D764BFF0F04A3</code> Win32 / Filecoder.GandCrab.E <br>  <code>14E8A0B57410B31A8A4195D34BED49829EBD47E9</code> Win32 / CoinMiner.BEX <br>  Phorpiex <code>D6DC8ED8B551C040869CD830B237320FD2E3434A</code> Win32 / Phorpiex.J Worm <br>  Loader <code>AEC1D93E25B077896FF4A3001E7B3DA61DA21D7D</code> Win32 / TrojanDownloader.Agent.EEQ <br>  Software for changing system settings <code>979CCEC1DF757DCF30576E56287FCAD606C7FD2C</code> Win32 / Agent.VQU <br><br>  <b>C &amp; C server used in the campaign</b> <br> <code>92.63.197[.]153</code> </div><p>Source: <a href="https://habr.com/ru/post/439068/">https://habr.com/ru/post/439068/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
</ul></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>