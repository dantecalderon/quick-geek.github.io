<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JDK 12 release candidate: Shenandoah, G1, JMH, Arm64. Swing bugs hit back</title>
  <meta name="description" content="240 days have passed since the release of the JEP 3: JDK Release Process , and the hellish machine for producing new versions does not want to stop. S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>JDK 12 release candidate: Shenandoah, G1, JMH, Arm64. Swing bugs hit back</h1><div class="post__text post__text-html js-mediator-article"><p>  240 days have passed since the release of the <a href="http://openjdk.java.net/jeps/3">JEP 3: JDK Release Process</a> , and the hellish machine for producing new versions does not want to stop.  So, it's <a href="https://mail.openjdk.java.net/pipermail/jdk-dev/2019-February/002583.html">time</a> for <a href="https://mail.openjdk.java.net/pipermail/jdk-dev/2019-February/002583.html">the next release candidate</a> .  This is a period when all bridges are burned, bugs with P2-P5 priorities no longer mean anything, and the days before the release are numbered. </p><br><p><img src="https://habrastorage.org/webt/rm/ls/lc/rmlslczx_0wk26jxxrrs85wt380.png"></p><a name="habracut"></a><br><h1 id="bagi">  Bugs </h1><br><p>  Not all bugs with P1 priority are closed.  You can <a href="https://bugs.openjdk.java.net/browse/JDK-8218469%3Ffilter%3D33410">view the</a> full list of problems <a href="https://bugs.openjdk.java.net/browse/JDK-8218469%3Ffilter%3D33410">in the bugtracker</a> .  And here the strangest thing awaits us: they all relate strictly to Swing when using GTKLookAndFeel. </p><br><ul><li>  <a href="https://bugs.openjdk.java.net/browse/JDK-8218469%3Ffilter%3D33410">JSlider display issue with slider for GTKLookAndFeel</a> ; </li><li>  <a href="https://bugs.openjdk.java.net/browse/JDK-8218470%3Ffilter%3D33410">JScrollBar display issue with GTKLookAndFeel</a> ; </li><li>  <a href="https://bugs.openjdk.java.net/browse/JDK-8218472%3Ffilter%3D33410">JProgressBar display issue with GTKLookAndFeel</a> ; </li><li>  <a href="https://bugs.openjdk.java.net/browse/JDK-8218473%3Ffilter%3D33410">JOptionPane display issue with GTKLookAndFeel</a> ; </li><li>  <a href="https://bugs.openjdk.java.net/browse/JDK-8218479%3Ffilter%3D33410">JTextPane display issue with GTKLookAndFeel</a> . </li></ul><br><p>  Already mentally said: "What is wrong with these guys in Swing?".  This time they are not to blame.  If someone doesn't know, Gtk is a free toolkit for developing graphical interfaces, especially on the GNU / Linux operating system for X11 and Wayland. </p><br><p>  Since Gtk 3.20, they have <a href="https://developer.gnome.org/gtk3/stable/ch32s10.html">changed the way they</a> work with many styles and widgets.  Instead of style classes and type names, element names are now used.  GTK 3.20 was released <a href="https://github.com/GNOME/gtk/releases%3Fafter%3D3.20.0">on March 21, 2016</a> , and it was a very <a href="https://help.gnome.org/misc/release-notes/3.20/">large</a> release - 28933 commit and Wayland by default.  In general, the whole Gnome began to look slightly different. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c84/80a/af1/c8480aaf1fd309a44e9290faa2c3b58d.png"></p><br><p>  Not surprisingly, Swing could have forgotten something and failed to test it.  Some of the bugs were shifted to priority on P2 and transferred to JDK 13. For example, <a href="https://bugs.openjdk.java.net/browse/JDK-8177960">here is this bug about the fact</a> that Motif in MacOS, as if to put it mildly, is no longer such an actual graphic environment: </p><br><p><img src="https://habrastorage.org/webt/dt/a5/0p/dta50prbuqzx19le5beowsqkuy0.png"></p><br><p>  It will be funny if on Habr√© someone really still uses Motif and AWT.  I hope the twelfth JDK will not be canceled because of this, otherwise it will be the most epic in Java for her entire young release story. </p><br><h1 id="fichi">  Features </h1><br><p>  JEPs in this list will be listed not by importance, but only by their sequence number.  This is so that you suddenly do not think that Shenanda and JMH got to the top because of personal sympathies. </p><br><p>  <strong>189: <a href="http://openjdk.java.net/jeps/189">Shenandoah: A Low-Pause-Time Garbage Collector (Experimental)</a></strong> </p><br><p>  It would be nice if it happened a year ago, and Shenanda got into the LTS.  Okay, wait - and thanks for that.  Shenandoah is a low-ported collector that achieves its low pause due to the multi-stream evacuation phase.  Moreover, the pauses do not depend on the size of the hip, so you can safely turn terabyte hip on the prod. </p><br><p>  <strong>230: <a href="http://openjdk.java.net/jeps/230">Microbenchmark Suite</a></strong> </p><br><p> A JMH based test suite is added to the JDK, and the JMH itself is also added.  It lies in the <code>jdk/jdk/test/micro/org/openjdk/bench</code> .  JMH is a framework for creating, assembling, running and analyzing micro-benchmarks for Java and other JVM-languages, written <a href="https://shipilev.net/">by you understand who</a> .  JMH is now de facto the standard for microbench marks, and the emergence of such JEPs is a matter of time. </p><br><p>  <strong><a href="http://openjdk.java.net/jeps/325">325: Switch Expressions (Preview)</a></strong> </p><br><p>  Instead of a thousand descriptions: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numLetters = <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (day) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MONDAY, FRIDAY, SUNDAY -&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TUESDAY -&gt; <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> THURSDAY, SATURDAY -&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> WEDNESDAY -&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>; };</code> </pre> <br><p>  <strong>334: <a href="http://openjdk.java.net/jeps/334">JVM Constants API</a></strong> </p><br><p>  The goal is to provide a set of types for formally modeling descriptions of classes, methods, and other entities in runtime and classfiles, and pull them into basic classes like <code>String</code> or <code>Class</code> .  They live in packages like <code>java.lang.invoke.constant</code> and they don‚Äôt ask, but you can <a href="http://cr.openjdk.java.net/~vromero/constant.api/webrev.04/constants.api.patch">look</a> at the patch <a href="http://cr.openjdk.java.net/~vromero/constant.api/webrev.04/constants.api.patch">here</a> . </p><br><p>  <strong>340: <a href="http://openjdk.java.net/jeps/340">One AArch64 Port, Not Two</a></strong> </p><br><p>  The old port of arm64 is thrown out into the cold, but the 32-bit ARM and aarch64 are actively sawn.  For the existence of these ports, it is necessary to thank, including the RedHat and <a href="http://bell-sw.com/">BellSoft companies</a> (by the way, the BellSoft office is located in St. Petersburg, next to the former Oracle office).  For the JDK 12 release, we will try to get a more detailed comment from the company representatives. </p><br><p>  <strong>341: <a href="http://openjdk.java.net/jeps/341">Default CDS Archives</a></strong> </p><br><p>  As a feature of CDS, it was available to us for a long time, but it was not clear why each time to write independently- <code>-Xshare:dump</code> , if the default result of executing this command is slightly predictable at the stage of creating the JDK distribution.  This annoying mistake will be repaired in JDK 12, the CDS archive will be generated by the creators of the distribution, even for night builds (provided they are 64-bit and native, not for cross-compilation). </p><br><p>  <strong>344: <a href="http://openjdk.java.net/jeps/344">Abortable Mixed Collections for G1</a></strong> </p><br><p>  This feature is needed by the internal mechanisms of the G1 garbage collector, so that it more often meets the requirements for the duration of the pause.  It so happens that it can be determined when G1 time and again incorrectly assesses the complexity of assembly, especially for old regions.  At this point, you can get scared and start collecting incrementally, step by step, and after each step be able to interrupt the assembly.  It is argued that this will allow better fit in the expected assembly time. </p><br><p>  <strong>346: <a href="http://openjdk.java.net/jeps/346">Promptly Return Unused Committed Memory from G1</a></strong> </p><br><p>  Now G1 gives commited memory to the operating system either with full GC or with parallel assembly.  Both G1 tries to avoid in every possible way, for which he thanks.  But this also means that the memory is devoured as it is not into itself, and it is possible to force G1 to eject the memory back only by some external method.  This is especially sad for any dockers and other hipsters without terabytes of RAM on the server.  Instead, it is proposed to do it in the same way that Shenanda or GenCon from OpenJ9 already knows how to determine insufficient hip utilization and, accordingly, reduce its use.  On some tests on Tomkate, this reduced the memory consumption by almost two times. </p><br><h1 id="chto-dalshe">  What's next </h1><br><p>  It was a review on the tops, and we will try to make a detailed analysis of the features closer to the release in the form of separate articles - JEP translations, screencasts with benchmarks, or something else.  Now we have to wait for the release, which is scheduled for March 19. </p><br><blockquote>  Minute advertising.  Very soon, on April 5-6, the JPoint conference will take place, which will bring together a huge number of people who know a lot about JDK and all sorts of new features.  For example, there will definitely be Simon Ritter from Azul with the report <a href="https://jpoint.ru/talks/35kmzgw4ds3gyt849hbaeo/%3Futm_source%3Dhabr%26utm_medium%3D440314">"JDK 12: Pitfalls for the unwary"</a> .  The right place to discuss the latest release!  More information about the JPoint can be found on the <a href="https://jpoint.ru/%3Futm_source%3Dhabr%26utm_medium%3D440314">official website</a> . </blockquote></div><p>Source: <a href="https://habr.com/ru/post/440314/">https://habr.com/ru/post/440314/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>