<div class="post__text post__text-html js-mediator-article">  Hello. <br><br>  In this article I want to describe the process of assembling my first arduino robot.  The material will be useful to other newcomers, just like me, who will want to make some kind of “self-running trolley”.  The article is a description of the stages of working with my additions on various nuances.  The link to the final code (most likely not the most ideal) is given at the end of the article. <br><br><img src="https://habrastorage.org/webt/gg/go/jt/gggojtfkexubr-5hiyumawj2gpw.jpeg"><br><br>  As far as possible I attracted my son (8 years) to participate.  What exactly happened to him, and what not - I singled out a part of the article for this, perhaps, someone will come in handy. <br><a name="habracut"></a><br><h2>  General description of the robot </h2><br>  First, a few words about the robot itself ( <b>idea</b> ).  I didn’t really want to collect something typical at the start.  At the same time, the set of components was fairly standard - chassis, engines, ultrasonic sensor, line sensor, LEDs, squeaker.  First, a robot was created from this “soup set” that guards its territory.  He rides on the intruder, who crossed the line of the circle, and then returns to the center.  However, in this version, a drawn line was needed, plus extra math to stay in the circle. <br><br>  Therefore, after some deliberation, I somewhat changed the idea and decided to make a “hunter” robot.  At the start, he turns around his axis, choosing a target (person) nearby.  If the "victim" is found, the "hunter" turns on the flasher and siren, and begins to go on it.  When a person moves away / runs off, the robot selects a new target and pursues it, and so on.  Such a robot does not need a limited circle, and it can work in an open area. <br><br>  As you can see, this is a lot like a catch-up game.  Although in the end, the robot did not turn out to be quite frisky, but it honestly interacts with the people around it.  Children especially like it (sometimes, it is true, it seems that they are about to crush it, as much as your heart beats ...).  I think for the promotion of technical design is a good solution. <br><br><h2>  Structure of the robot </h2><br>  So, we decided on the idea, move on to the <b>layout</b> .  The list of elements is formed from what the robot should be able to do.  Everything is quite obvious, so we will immediately look at the numbering: <br><br><img src="https://habrastorage.org/webt/0l/vg/gq/0lvggqarv4h03cxzyflrf_7x3vu.jpeg"><br><br>  The “brains” of the robot are the arduino uno (1);  Was in the set ordered from China.  For our purposes, it is quite enough (focusing on the number of pins used).  From the same set we took the finished chassis (2), on which two driving wheels (3) and one rear (freely rotating) (4) are mounted.  Also in the set was a ready battery compartment (5).  The robot has an ultrasonic sensor (HC-SR04) (6) in front, an engine driver (L298N) (7) at the rear, a LED flasher (8) in the center, and a little squeaker (9). <br><br>  At the layout stage, we look at: <br><br>  - so that everything fits <br>  - to be balanced <br>  - to be rationally placed <br><br>  In part, this has already been done by our Chinese colleagues for us.  Thus, the heavy battery compartment is placed in the center, and drive wheels are located approximately below it.  All other boards are light, they can be placed on the periphery. <br><br>  Nuances: <br><br><ol><li>  In the chassis of the set there are many factory openings, but what is the logic in them - I never figured it out.  The engines and the battery pack were fixed without problems, then the “fit” began with the drilling of new holes to fix this or that board. </li><li>  The brass pillars and other fasteners from the storerooms came to the rescue (sometimes they had to be twisted). </li><li>  Tires from each board passed through the clamps (again found in the vaults).  Very convenient, all the wires are beautiful and do not hang out. </li></ol><br><h2>  Individual blocks </h2><br>  Now I will go through the <b>blocks</b> and tell personally about each. <br><br>  <b>Battery compartment</b> <br><br>  It is clear that the robot must have a good source of energy.  The options may be different, I chose the version with 4 AA batteries.  In total, they give about 5 V, and this voltage can be directly applied to the pin 5V of the arduino board (bypassing the stabilizer). <br><br>  Of course, I had some wariness, but this solution is quite workable. <br><br>  Since power is needed everywhere, for convenience, I made two connectors in the center of the robot: one “distributes” the ground (on the right), and the second - 5 V (on the left). <br><br><img src="https://habrastorage.org/webt/ko/jj/am/kojjamjo6cxljkfgv8os3v1zq-4.jpeg"><br><br>  <b>Engines and driver</b> <br><br>  First, about the engine mount.  Fastening factory, but made with large tolerances.  In other words, engines can "wobble" a couple of millimeters left-right.  For our task, this is not critical, but somewhere it may influence (the robot will begin to lead to the side).  Just in case, I put the engines strictly parallel and fixed with glue. <br><br><img src="https://habrastorage.org/webt/f0/1k/bw/f01kbwansax8pzqihg4luq69xdk.jpeg"><br><br>  To control the engines, as I wrote above, the driver L298N is used.  According to the documentation, he has three pins for each engine: one for changing the speed and a pair of pins for the direction of rotation.  There is one important point.  It turns out that if the supply voltage is 5 V, then the speed control simply does not work!  That is, it either does not twist at all, or twists to the maximum.  This is the feature that caused me to “kill” a couple of evenings.  In the end, found a mention somewhere on one of the forums. <br><br>  Generally speaking, I needed a low rotational speed when the robot turned around - so that it had enough time to scan the space.  But, since with this idea nothing happened, we had to do it differently: a small turn - stop - turn - stop, etc. Again, not so elegant, but workable. <br><br>  Still here I will add that after each pursuit the robot chooses a random direction of a new turn (clockwise or counterclockwise). <br><br>  <b>Ultrasonic sensor</b> <br><br><img src="https://habrastorage.org/webt/ib/7p/88/ib7p88tghk0qnnesuhnrgrrmbvs.jpeg"><br><br>  Another piece of iron where I had to find a compromise solution.  Ultrasonic sensor on real obstacles gives unstable numbers.  Actually, it was expected.  Ideally, it works somewhere in competitions, where there are smooth, even and perpendicular surfaces, but if someone's feet “flash” in front of him, then additional treatment should be introduced. <br><br>  As such processing, I put the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2584%25D0%25B8%25D0%25BB%25D1%258C%25D1%2582%25D1%2580">median filter</a> on three counts.  Based on tests on real children (during the tests, no child was hurt!), It was enough for normalizing the data.  The physics here is simple: we have signals reflected from the <b>desired</b> objects (giving the required distance) and reflected from more distant, for example, walls.  The second ones are random outliers in measurements of the form 45, 46, <b>230</b> , 46, 46, 45, 45, <b>310</b> , 46 ... It is their median filter that cuts off. <br><br>  After all the processing, we get the distance to the nearest object.  If it is less than a certain threshold value - then we turn on the alarm and go straight to the "offender". <br><br>  <b>Flashing light and siren</b> <br><br>  Perhaps the simplest elements of all of the above.  They can be seen in the photos above.  There is nothing to write about the hardware here, so now let's move on to the <b>code</b> . <br><br><h2>  Management program </h2><br>  I don't see the meaning of the code in detail, who needs it - the link is at the end of the article, everything is quite readable.  But the general structure would be nice to explain. <br><br>  The first thing that had to be understood was that a robot is a real-time device.  More precisely, to remember, because I still do electronics before and now.  So, we immediately forget about the call <b>delay ()</b> , which they like to use in example sketches, and which simply “freezes” the program for a specified period of time.  Instead, as advised by experienced people, we introduce timers for each block.  Passed the required period - performed the action (increased the brightness of the LED, turned on the engine and so on). <br><br>  Timers can be interconnected.  For example, the squeaker works synchronously with the flasher.  This slightly simplifies the program. <br><br>  Naturally, everything is divided into separate functions (flasher, sound, turn, movement forward and so on).  If you do not do this, then you can’t figure out what comes from where or where. <br><br><h2>  Nuances of pedagogy </h2><br>  All that was described above, I did in my free time in the evenings.  In a slow mode, I spent about three weeks on the robot.  This could be the end, but I still promised to tell you about working with the child.  What is doable at that age? <br><br>  <b>Work on instructions</b> <br><br>  Every detail we first checked separately - LEDs, beeper, motors, sensors, etc. There are a large number of ready-made examples - some right in the development environment, others can be found on the Internet.  This undoubtedly pleases.  We take the code, we connect the part, we are convinced that it works, then we are already starting to change for our task.  Connections under the scheme and under some of my control the child makes himself.  It's good.  Work well according to the instructions, too, must be able to. <br><br>  <b>The order of work ("from the particular to the general")</b> <br><br>  This is a difficult item.  It is necessary to teach that a big project (“make a robot”) consists of small tasks (“connect a sensor”, “connect motors” ...), and those in turn from even smaller steps (“find a program”, “ connect fee "," download firmware "...).  In carrying out more or less understandable tasks of the lower level, we “close” the tasks of the average level, and of them the general result is already formed.  I explained, but, I think, awareness will not come soon.  Somewhere, probably, to adolescence. <br><br>  <b>Installation</b> <br><br>  Drilling, threads, screws, nuts, soldering and the smell of rosin - where do without it.  The child received the basic skill "Working with a soldering iron" - it was possible to solder several connections (I helped a little, I will not hide it).  Do not forget the explanation of safety. <br><br>  <b>Computer work</b> <br><br>  I wrote the program for the robot, but I managed to achieve some kind of passing results. <br><br>  First: English.  At school, he was just started, so we sorted out what is pishalka, migalka, yarkost and other transliteration.  Understood at least this.  I deliberately did not use my native English words, since we had not yet reached this level. <br><br>  Second: effective work.  They learned hot key combinations how to quickly perform typical operations.  Periodically, when we wrote the program, we changed places with the son, and I said that we need to do (replacement, search, etc.).  We had to repeat again and again: “select with a double click”, “hold Shift”, “hold Ctrl” and so on.  The learning process is not fast here, but I think the skills will gradually be deposited "in the subcortex". <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  You can say that the above is almost obvious.  But, honestly, this fall I had the opportunity to conduct computer science in 9th grade in one school.  That's horrible.  Pupils do not know such elementary things as Ctrl + Z, Ctrl + C and Ctrl + V, text selection with Shift-clamped or double click on a word and so on.  This is despite the fact that they had the third year of computer science education ... Make a conclusion yourself. <br></div></div><br>  Third: blind printing.  Comments in the code I trusted to print to the child (let it train).  Immediately put the right hands, so that the fingers gradually memorized the location of the keys. <br><br>  As you can see, we are still just beginning.  Skills and knowledge will hone further, in life will be useful. <br><br>  By the way, about the perspective ... <br><br><h2>  Further development </h2><br>  The robot is made, goes, flashes and beeps.  What now?  Inspired by what we have achieved, we plan to refine it further.  There is an idea to make a remote control - like a lunar rover.  It would be interesting, sitting at a conventional panel, to control the movement of a robot that travels in a completely different place.  But it will be a separate story ... <br><br>  And at the end, in fact, the heroes of this article (video on click): <br><br> <a href="https://www.youtube.com/watch%3Fv%3DfaFykvct8r8"><img src="https://habrastorage.org/webt/sy/sl/-i/sysl-imyjpywmbkkpg1n4w-s5w0.png"></a> <br><br>  Thanks for attention! <br><br>  → <a href="https://vk.com/doc35098661_487769877">Link to code</a> </div>