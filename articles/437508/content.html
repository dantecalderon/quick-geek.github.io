<div class="post__text post__text-html js-mediator-article"><h2>  TL; DR; </h2><br>  More recently (since about 1983), it turned out that OpenSSH, as the rsh heir, for the scp command (ex. Rcp) allows the <b>server</b> to choose which file and with which parameters to send you.  And the output vulnerabilities allow you to hide exactly which file you were transferred. <br>  That is, you ask file.txt, and get - exploit.bin <br>  And there are no fixes yet, such are the cases.  Use sftp or rsync. <br><a name="habracut"></a><br><h2>  Details </h2><br><ul><li>  <a href="https://sintonen.fi/advisories/scp-client-multiple-vulnerabilities.txt"><b>Source document</b></a> </li><li>  <a href="https://gist.github.com/mehaase/63e45c17bdbbd59e8e68d02ec58f4ca2"><b>Exploit</b></a> </li></ul><br><h3>  CVE-2019-6109 </h3><br>  The scp client does not check for extra characters in the file name, which allows you to hide the real name of the file being transferred (for example, ASCII codes) <br><br><h3>  CVE-2019-6110 </h3><br>  The scp client allows you to write to stderr and rewrite the data in the terminal, which allows you to hide the real name of the file being transferred (for example, ASCII codes). <br><br><h3>  CVE-2019-6111 </h3><br>  The scp client does not check which file is sent to it and does not compare it with what it requested.  Malicious server can upload to the client all that he wants, and with any mode. <br><br><h3>  Work example </h3><br><pre><code class="plaintext hljs">$ rm -rf * $ ls -la итого 36 drwxr-xr-x 2 user user 4096 янв 25 15:11 . drwx------ 99 user user 28672 янв 25 14:23 .. $ scp test@localhost:x.txt . x.txt 100% 32 0.3KB/s 00:00 $ ./exploit.sh # откуда он взялся?! You're hacked. Sorry for that Please upgrade your OpenSSH client $</code> </pre> <br>  In this example (a slightly modified exploit from the link above), the exploit.sh file with 755 permissions is loaded along with x.txt, and the fact of the transfer is overwritten with stderr. <br><br><h3>  Vulnerable Clients </h3><br>  In short, that's all.  OpenSSH including 7.9p1, putty, winscp &lt;5.13. <br>  Only WinSCP has fixes (5.14+) <br>  Use sftp / rsync when working with untrusted servers. </div>