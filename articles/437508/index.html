<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CVE-2019-6111 and other scp vulnerabilities</title>
  <meta name="description" content="TL; DR; 
 More recently (since about 1983), it turned out that OpenSSH, as the rsh heir, for the scp command (ex. Rcp) allows the server to choose whi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>CVE-2019-6111 and other scp vulnerabilities</h1><div class="post__text post__text-html js-mediator-article"><h2>  TL; DR; </h2><br>  More recently (since about 1983), it turned out that OpenSSH, as the rsh heir, for the scp command (ex. Rcp) allows the <b>server</b> to choose which file and with which parameters to send you.  And the output vulnerabilities allow you to hide exactly which file you were transferred. <br>  That is, you ask file.txt, and get - exploit.bin <br>  And there are no fixes yet, such are the cases.  Use sftp or rsync. <br><a name="habracut"></a><br><h2>  Details </h2><br><ul><li>  <a href="https://sintonen.fi/advisories/scp-client-multiple-vulnerabilities.txt"><b>Source document</b></a> </li><li>  <a href="https://gist.github.com/mehaase/63e45c17bdbbd59e8e68d02ec58f4ca2"><b>Exploit</b></a> </li></ul><br><h3>  CVE-2019-6109 </h3><br>  The scp client does not check for extra characters in the file name, which allows you to hide the real name of the file being transferred (for example, ASCII codes) <br><br><h3>  CVE-2019-6110 </h3><br>  The scp client allows you to write to stderr and rewrite the data in the terminal, which allows you to hide the real name of the file being transferred (for example, ASCII codes). <br><br><h3>  CVE-2019-6111 </h3><br>  The scp client does not check which file is sent to it and does not compare it with what it requested.  Malicious server can upload to the client all that he wants, and with any mode. <br><br><h3>  Work example </h3><br><pre><code class="plaintext hljs">$ rm -rf * $ ls -la –∏—Ç–æ–≥–æ 36 drwxr-xr-x 2 user user 4096 —è–Ω–≤ 25 15:11 . drwx------ 99 user user 28672 —è–Ω–≤ 25 14:23 .. $ scp test@localhost:x.txt . x.txt 100% 32 0.3KB/s 00:00 $ ./exploit.sh # –æ—Ç–∫—É–¥–∞ –æ–Ω –≤–∑—è–ª—Å—è?! You're hacked. Sorry for that Please upgrade your OpenSSH client $</code> </pre> <br>  In this example (a slightly modified exploit from the link above), the exploit.sh file with 755 permissions is loaded along with x.txt, and the fact of the transfer is overwritten with stderr. <br><br><h3>  Vulnerable Clients </h3><br>  In short, that's all.  OpenSSH including 7.9p1, putty, winscp &lt;5.13. <br>  Only WinSCP has fixes (5.14+) <br>  Use sftp / rsync when working with untrusted servers. </div><p>Source: <a href="https://habr.com/ru/post/437508/">https://habr.com/ru/post/437508/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>