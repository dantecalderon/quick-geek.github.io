<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I taught the robot to run YouTube videos</title>
  <meta name="description" content="We continue to talk about joint research projects of our students and JetBrains Research. In this article we will talk about the algorithms of deep le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>How I taught the robot to run YouTube videos</h1><div class="post__text post__text-html js-mediator-article">  We continue to talk about joint research projects of our students and JetBrains Research.  In this article we will talk about the algorithms of deep learning with reinforcement, which are used to simulate the human motor apparatus. <br><br>  To simulate all possible movements of a person and describe all the scenarios of behavior is a rather difficult task.  If we learn to understand how a person moves, and we can reproduce his movements ‚Äúin the image and likeness‚Äù - this will greatly facilitate the introduction of robots in many areas.  Just so that robots learn to repeat and analyze the movements themselves, and machine learning is used. <br><br><img src="https://habrastorage.org/webt/7a/0o/p2/7a0op2uyke7qxsumorgnpc2w6bw.jpeg"><br><a name="habracut"></a><br><h3>  About myself </h3><br>  My name is Alexander Malyshev, I am a graduate of a bachelor‚Äôs degree in Applied Mathematics and Informatics at St. Petersburg Academic University, and since this fall I am a first-year student at the St. Petersburg Higher School in Programming and Data Analysis.  In addition, I work in the ‚ÄúAgent Systems and Reinforcement Training‚Äù laboratory at JetBrains Research, and I also teach classes - lectures and practices - at the undergraduate program at the St. Petersburg Higher School. <br><br>  At the moment I am working on several projects in the field of deep learning with reinforcement (we started talking about this in the previous article).  And today I want to show my first project, which smoothly emerged from my thesis. <br><br><h3>  Task Description </h3><br><img src="https://habrastorage.org/webt/rg/-z/4v/rg-z4vgm68szktjuyvxwvns3fms.jpeg"><br><br>  To imitate the human musculoskeletal system, special environments are created that try to simulate the physical world as accurately as possible to solve a specific problem.  For example, the <a href="https://nips.cc/Conferences/2017">NIPS 2017</a> competition focused on creating a humanoid robot that simulates human walking. <br><br>  To solve this problem, commonly used methods of in-depth training with reinforcement, which lead to a good, but not optimal strategy.  In addition, in most cases, the training time is too long. <br><br>  As was rightly pointed out in the <a href="https://habr.com/ru/company/hsespb/blog/435636/">previous article</a> , the main problem when moving from invented / simple tasks to real / practical tasks is that rewards in such tasks are usually very rare.  For example, we can evaluate the passage of a long distance only in the case when the agent has reached the finish.  For this, he needs to perform a complex and correct sequence of actions, which is not always the case.  This problem can be solved by giving the agent at the start examples of how to ‚Äúplay‚Äù - the so-called expert demonstrations. <br><br>  I used this approach to solve this problem.  It turned out that to significantly improve the quality of training, we can use videos that show the movement of a person during a run.  In particular, you can try to use the motion coordinates of specific body parts (for example, feet) taken from a video on YouTube. <br><br><h4>  Environment </h4><br>  In reinforcement learning tasks, the interaction of the agent and the environment is considered.  One of the modern environments for modeling the human musculoskeletal system is the simulation environment OpenSim, using the physics engine Simbody. <br><img src="https://habrastorage.org/webt/ey/7i/a9/ey7ia98mnzhknkxormfjq8h16ai.jpeg"><br>  In this environment, the ‚Äúenvironment‚Äù is a three-dimensional world with obstacles, the ‚Äúagent‚Äù is a humanoid robot with six joints (ankle, knees and hips on two legs) and muscles that simulate the behavior of human muscles, and ‚Äúagent action‚Äù is real values ‚Äã‚Äãfrom 0 to 1, which determine the tension of the existing muscles. <br><br>  The reward is calculated as changing the position of the pelvis along the x axis minus the penalty for using bundles.  Thus, on the one hand, you need to go as far as possible for a certain time, and, on the other hand, you need to make sure that the muscles ‚Äúwork‚Äù as little as possible.  The training episode ends when either 1000 iterations are reached, or the pelvis height is lower than 0.65 meters, which means the fall of the human model. <br><br><h4>  Base implementation </h4><br>  The main task of reinforcement learning is to teach the robot to move quickly and efficiently in the environment. <br><br>  To test the hypothesis of whether learning at demonstrations helps, it was necessary to implement a basic algorithm that would learn to run fast, but suboptimally, like many already existing examples. <br><br>  To do this, we applied several tricks: <br><ul><li>  To begin with, it was necessary to adapt the OpenSim environment in order to effectively use reinforcement learning algorithms.  In particular, in the description of the environment, we added the two-dimensional coordinates of the positions of body parts relative to the pelvis. </li><li>  The number of distance passing examples was increased due to the symmetry of the environment.  In the initial position, the agent is absolutely symmetrical with respect to the left and right side of the body.  Therefore, after one passage of the distance, two examples can be added at once: the one that occurred, and mirror-symmetrical with respect to the left or right side of the agent's body. </li><li>  To increase the speed of the algorithm, frame skipping was implemented: the launch of the algorithm for selecting the next agent action was performed only every third iteration, in other cases the last selected action was repeated.  Thus, the number of iterations of the launch of the agent action selection algorithm was reduced from 1000 to 333, which reduced the number of required calculations. </li><li>  Previous modifications significantly accelerated learning, but the learning process was still slow.  Therefore, an acceleration method was additionally implemented, associated with a decrease in the accuracy of the calculations: the type of values ‚Äã‚Äãused in the agent state vector was changed from double to float. </li></ul><br><img src="https://habrastorage.org/webt/gd/2d/f-/gd2df-pmw2mr57fdkv3f2v4wscq.jpeg"><br><br>  This graph shows the improvement after each of the above optimizations, it shows the reward received for the epoch from the time of study. <br><br><h4>  So what's the deal with YouTube? </h4><br>  After developing the base model, we added the formation of a reward based on a potential function.  A potential function is introduced in order to give the robot useful information about the world around us: we say that some body positions that the running character took on the video are more ‚Äúbeneficial‚Äù (that is, it receives a greater reward for them) than others. <br><br>  We built the function on the basis of video data taken from YouTube-videos with the image of the running of real people and human characters of cartoons and computer games.  The total potential function was defined as the sum of the potential functions for each body part: a pelvis, two knees, and two feet.  Following the potential-based approach to the formation of remuneration, at each iteration of the algorithm, the agent is provided with an additional remuneration corresponding to changes in the potentials of the previous and current state.  Potential functions of separate parts of the body were built using the inverse distances between the corresponding coordinate of the body part in the video-generated data and the humanoid robot. <br><br>  We looked at three data sources: <br><br><img src="https://habrastorage.org/webt/dx/kj/fu/dxkjfucqrrs10em5qufmpm79htu.jpeg"><br>  <a href="https://www.youtube.com/watch%3Fv%3D2y6aVz0Acx0">Becker Alan.</a>  <a href="https://www.youtube.com/watch%3Fv%3D2y6aVz0Acx0">Animating Walk Cycles - 2010</a> <br><img src="https://habrastorage.org/webt/t9/21/qj/t921qjycmjofvpiugdfzvq7xx0y.jpeg"><br>  <a href="https://www.youtube.com/watch%3Fv%3DYbYOsE7JyXs">ProcrastinatorPro.</a>  <a href="https://www.youtube.com/watch%3Fv%3DYbYOsE7JyXs">QWOP Speedrun - 2010</a> <br><img src="https://habrastorage.org/webt/bv/w-/gp/bvw-gpck1vzqt-19axsnmou72r0.jpeg"><br>  <a href="https://www.youtube.com/watch%3Fv%3D5mVgThl-yMU">ShvetsovLeonid.HumanSpeedrun - 2015</a> <br><br>  ... and three different distance functions: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mi>f</mi><mn>1</mn><mo>:</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>d</mi><mi>y</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.881ex" height="2.419ex" viewBox="0 -780.1 5976.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-66" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-31" x="1302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-3A" x="2080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-64" x="2636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-78" x="3160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-2B" x="3954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-64" x="4955" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-79" x="5479" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mi>f</mi><mn>1</mn><mo>:</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>d</mi><mi>y</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> Pf1: dx + dy </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mi>f</mi><mn>2</mn><mo>:</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><msup><mi>y</mi><mn>2</mn></msup></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.623ex" height="2.901ex" viewBox="0 -987.6 8879.5 1249" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-66" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-32" x="1302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-3A" x="2080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-73" x="2886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-71" x="3356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-72" x="3816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-74" x="4268" y="0"></use><g transform="translate(4629,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-64" x="0" y="0"></use><g transform="translate(523,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-32" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-2B" x="1772" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-64" x="2772" y="0"></use><g transform="translate(3296,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-32" x="706" y="583"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mi>f</mi><mn>2</mn><mo>:</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><msup><mi>y</mi><mn>2</mn></msup></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> Pf2: \ sqrt {dx ^ 2 + dy ^ 2} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mi>f</mi><mn>3</mn><mo>:</mo><mi>d</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><msup><mi>y</mi><mn>2</mn></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.994ex" height="2.901ex" viewBox="0 -987.6 6886.5 1249" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-66" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-33" x="1302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-3A" x="2080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-64" x="2636" y="0"></use><g transform="translate(3160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-32" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-2B" x="4408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-64" x="5409" y="0"></use><g transform="translate(5932,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hsespb/blog/437402/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjF08lvQzwhWWRtVaukox1-PH1lIg#MJMAIN-32" x="706" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mi>f</mi><mn>3</mn><mo>:</mo><mi>d</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><msup><mi>y</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> Pf3: dx ^ 2 + dy ^ 2 </script></p><br>  Here dx (dy) is the absolute difference between the x (y) coordinate of the corresponding body parts taken from the video data and the x (y) coordinate of the agent. <br><br>  Below are the results obtained when comparing various data sources for a potential function based on PF2: <br><br><img src="https://habrastorage.org/webt/-2/lp/md/-2lpmdr1r2uxfrxrdof4wo7pvoe.jpeg"><br><br><h3>  results </h3><br>  Comparison of performance between the baseline and the approach to the formation of remuneration: <br><img src="https://habrastorage.org/webt/hl/bw/wg/hlbwwgobkweyf8iixrpvpowm2ts.jpeg"><br><br>  It turned out that the formation of remuneration significantly accelerates learning, reaching double speed in 12 hours of training.  The end result after 24 hours still shows a significant advantage of the approach using the potential functions method. <br><br><img src="https://habrastorage.org/webt/fm/2a/6u/fm2a6u9f1-toetffrxgy6c4v8wk.jpeg"><br><br>  Separately, I would like to note the following important result: we were able to theoretically prove that a reward based on a potential function does not impair the optimal policy.  In order to demonstrate this advantage in this context, we used a suboptimal agent generated by the base agent after 12 hours of training.  The resulting prototype agent was used as a data source for a potential function.  Obviously, the resulting agent with this approach will not work optimally, and the position of the feet and knees in most cases will not be in optimal positions.  Then the agent trained by the DDPG algorithm using the potential function was trained on the data obtained.  Next, a comparison was made of the learning outcomes of an agent with a potential function with a prototype agent.  The agent training schedule demonstrates that the RL agent is able to overcome the suboptimal performance of the data source. <br><br><h3>  The first steps in science </h3><br>  I completed my graduation project quite early.  It should be noted that we have a very responsible approach to the protection of a diploma.  Already in September, students know the topic, the evaluation criteria, and when to do it.  When everything is so clear, it is very convenient to work, there is no feeling ‚ÄúI have a whole year ahead, I can start doing it from the next week / month / half-year‚Äù.  As a result, if you work effectively, you can get the final results of the thesis by the New Year, and spend the remaining time on setting up the model, collecting statistically significant results and writing the text of the diploma.  That is exactly what happened to me. <br><br>  Two months before the diploma defense, I already had the text of the work ready, and my supervisor, Alexey Alexandrovich Shpilman, offered to write an article at <a href="http://ala2018.it.nuigalway.ie/">Workshop on Adaptive and Learning Agents (ALA)</a> at ICML-AAMAS.  The only thing I had to do was translate and repack thesis.  As a result, we sent an article to the conference and ... she was accepted!  This was my first publication and I was extremely happy when I saw in my mail a letter with the word ‚ÄúAccepted‚Äù.  Unfortunately, at the same time I was training in South Korea and could not personally attend the conference. <br><br>  In addition to the <a href="http://ala2018.it.nuigalway.ie/papers/ALA_2018_paper_32.pdf">publication</a> and recognition of the work done, the first conference brought me another pleasant result.  Alexey Alexandrovich began to involve me in writing reviews for other people's work.  It seems to me that this is very useful for gaining experience in evaluating new ideas: this way you can learn to analyze existing works, check the idea for originality and relevance. <br><br><h4>  Write an article at the workshop is good, but on the main track - better </h4><br>  After Korea, I got an internship at JetBrains Research and continued working on the project.  It was at this point that we checked three different formulas for the potential function and made a comparison.  We really wanted to share the results of our work, so we decided to write a full-fledged article on the main track <a href="https://www.icarcv.net/">ICARCV</a> conference in Singapore. <br><br>  Write an article on the workshop is good, but on the main track - better.  And, of course, I was very glad when I learned that the article was accepted!  Moreover, our colleagues and sponsors from JetBrains agreed to pay for my trip to the conference.  A great bonus was the opportunity to get acquainted with Singapore. <br><br>  When the tickets were already purchased, the hotel was booked and all I could do was get a visa, a letter arrived in the mail: <br><br><img src="https://habrastorage.org/webt/c-/3k/yx/c-3kyxnhq0tzwvfexrifvrgxgie.png"><br><br>  I was not given a visa despite the fact that I had documents confirming the presentation at the conference!  It turns out that the Embassy of Singapore does not accept applications from unmarried and unemployed girls under 35 years of age.  And even if the girl works, but not married, the chance to get a waiver is still very great. <br><br>  Fortunately, I learned that citizens of the Russian Federation traveling in transit can stay in Singapore for up to 96 hours.  As a result, I flew to Malaysia via Singapore, where I spent a total of almost eight days.  The conference itself lasted six days.  Due to restrictions, I attended the first four, then I had to leave to return to the closing.  After the conference, I decided to feel like a tourist and just walked around the city for two days and visited museums. <br><br>  I prepared a speech at the ICARCV in advance, back in St. Petersburg.  Rehearsed him at a reinforcement training workshop.  Therefore, speaking at the conference was exciting, but not scary.  The speech itself lasted 15 minutes, but after it there was a section of questions, which seemed to me very useful. <br><br>  I was asked some pretty interesting questions that pushed new ideas.  For example, about how we tagged data.  In our work, we labeled the data manually, and we were offered to use a library that automatically understands where the parts of the human body are.  Now we have just begun to implement this idea.  Read the entire work can be on the <a href="https://ieeexplore.ieee.org/document/8581310">link</a> . <br><br>  At ICARCV, I enjoyed talking with scientists and learned a lot of new ideas.  The number of interesting articles that I met in these few days was more than in the previous four years.  Now there is a machine learning ‚ÄúHYIP‚Äù in the world, and every day dozens of new articles appear on the Internet, among which it is very difficult to find something worthwhile.  It is for this, I think, that it is worth going to conferences: to find communities that discuss new interesting topics, learn about new ideas and share their own.  And make friends! </div><p>Source: <a href="https://habr.com/ru/post/437402/">https://habr.com/ru/post/437402/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>