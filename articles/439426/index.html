<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Situation: a new wave of attacks with the interception of DNS queries - we analyze the basic methods of protection</title>
  <meta name="description" content="Information security specialists have registered an increase in the number of DNS attacks hijacking the websites of private and government companies. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Situation: a new wave of attacks with the interception of DNS queries - we analyze the basic methods of protection</h1><div class="post__text post__text-html js-mediator-article">  Information security specialists have registered an increase in the number of <a href="https://ru.wikipedia.org/wiki/DNS_hijacking">DNS</a> attacks <a href="https://ru.wikipedia.org/wiki/DNS_hijacking">hijacking</a> the websites of private and government companies.  We tell who suffered and how to defend. <br><br> <a href="https://habr.com/ru/company/1cloud/blog/439426/"><img src="https://habrastorage.org/webt/_y/q6/cl/_yq6clswhhpxxpaaf0xbczdj3c8.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ Flickr / <a href="https://www.flickr.com/photos/krossbow/45809414935/">F Delventhal</a> / <a href="https://creativecommons.org/licenses/by/2.0/">CC BY</a> / Photo changed</i></font> <br><br><h2>  What happened </h2><br>  The information security organization FireEye <a href="https://arstechnica.com/information-technology/2019/01/a-dns-hijacking-wave-is-targeting-companies-at-an-almost-unprecedented-scale/">published a</a> report last month that reported on a massive wave of attacks on private companies and government organizations.  Attackers used the technique of DNS interception, or DNS hijacking.  They blocked TCP / IP configurations on the victim‚Äôs computer and transferred all requests to a fake DNS server.  This allowed them to direct user traffic to their own web servers and use them to steal personal data. <br><br>  According to FireEye, the growth in the number of such attacks began to grow in January 2017.  Hackers target domains from Europe, North America, the Middle East and North Africa.  At least six domains of <a href="https://www.cyberscoop.com/dhs-dns-directive-government-shutdown/">the</a> US <a href="https://www.cyberscoop.com/dhs-dns-directive-government-shutdown/">federal agencies</a> and <a href="https://www.theregister.co.uk/2019/01/10/fireeye_iran_dns_hijacking/">sites of the governments</a> of the Middle East countries have suffered. <br><br><h2>  What methods do hackers use? </h2><br>  FireEye experts in their report <a href="https://www.fireeye.com/blog/threat-research/2019/01/global-dns-hijacking-campaign-dns-record-manipulation-at-scale.html">point out</a> three DNS substitution patterns used by hackers.  The first of these was <a href="https://blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html">described</a> by Cisco security divisions ‚Äî Talos.  The attackers hacked the DNS service providers (for the time being it is not known for certain), and then <a href="https://www.fireeye.com/blog/threat-research/2019/01/global-dns-hijacking-campaign-dns-record-manipulation-at-scale.html">changed</a> <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B8%25D0%25BF%25D1%258B_%25D1%2580%25D0%25B5%25D1%2581%25D1%2583%25D1%2580%25D1%2581%25D0%25BD%25D1%258B%25D1%2585_%25D0%25B7%25D0%25B0%25D0%25BF%25D0%25B8%25D1%2581%25D0%25B5%25D0%25B9_DNS">the</a> DNS A <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B8%25D0%25BF%25D1%258B_%25D1%2580%25D0%25B5%25D1%2581%25D1%2583%25D1%2580%25D1%2581%25D0%25BD%25D1%258B%25D1%2585_%25D0%25B7%25D0%25B0%25D0%25BF%25D0%25B8%25D1%2581%25D0%25B5%25D0%25B9_DNS">record</a> , associating the real domain with the IP belonging to the hackers. <br><br>  As a result, the victims fell on a similar original site.  To achieve maximum similarity, even a cryptographic certificate, <a href="https://ru.wikipedia.org/wiki/Let%25E2%2580%2599s_Encrypt">Let's Encrypt</a> , was made for a fake website.  At the same time, requests from a fake resource were redirected to the original one.  The fake page returned true answers, and the substitution could be noticed only by longer loading pages. <br><br>  This attack scheme was used to hack into the websites of the UAE government, the Lebanese Ministry of Finance, and Middle East Airlines.  Hackers intercepted all traffic and redirected it to the IP address 185.20.187.8.  According to Talos experts, attackers stole passwords from the mailboxes of employees of organizations and data for accessing VPN services. <br><br>  The second scheme of the malefactors is connected with the change in the register of DNS addresses of the NS record of the domain.  It <a href="https://threatpost.com/unprecedented-dns-hijacking-attacks-linked-to-iran/140737/">is responsible</a> not for one page of a specific domain (for example: mail.victim.com), but for all links of the form x.victim.com.  The rest of the method is similar to the first one: hackers created a copy of the original site and redirected users to it, and then stole the data. <br><br>  The third method was often used in conjunction with the first two.  Website visitors were not immediately sent to a fake page.  First, they switched to an additional service - DNS Redirector.  He recognized where the user is sending the DNS request.  If a visitor entered a page from the victim‚Äôs network, he was redirected to a fake copy of the site.  To other users, the Redirector returned the real IP address, and the person got to the original resource. <br><br><h2>  What do they think about attacks? </h2><br>  Experts <a href="https://www.wired.com/story/iran-dns-hijacking/">can not</a> yet assess the exact damage from hacking, as the new victims of hackers become known after the publication of the report.  Therefore, even the US Department of Homeland Security (DHS) has drawn attention to the problem.  Specialists of the organization published a <a href="https://cyber.dhs.gov/assets/report/ed-19-01.pdf">directive</a> in which they formed a list of mandatory requirements for other federal agencies.  For example, DHS requires government departments to update the passwords for administrator accounts, enable multi-factor authentication in DNS accounts, and inspect all DNS records. <br><br><img src="https://habrastorage.org/webt/gs/yb/1v/gsyb1vae_sd77mqku1wvfww4f1u.jpeg"><br>  <font color="#A9A9A9"><i>/ Wikimedia / <a href="">ANIL KUMAR BOSE</a> / <a href="">CC BY-SA</a></i></font> <br><br>  Recommendations from the directive must be implemented by all agencies within ten working days.  According to the <a href="https://www.cyberscoop.com/dhs-dns-directive-government-shutdown/">publication of</a> CyberScoop, this period is quite rare in the documents of the Ministry.  This indicates the ‚Äúemergency‚Äù status of the directive. <br><br>  A remarkable series of hacks was also called by representatives of providers of DNS servers.  According <a href="https://searchsecurity.techtarget.com/news/252455758/Iran-implicated-in-DNS-hijacking-campaign-around-the-world">to</a> NS1 DNS hosting CEO Chris Bivers (Kris Beevers), the most important conclusion from the recent attacks is that organizations do not use basic defenses.  At its core, attacks are pretty simple, and many of them could be prevented. <br><br><h2>  How to protect </h2><br>  In their report, FireEye experts provide several protection methods that will help organizations prevent DNS hijacking attacks: <br><br>  <b>Enable Multifactor Authentication (MFA).</b>  This is one of the requirements that the Department of Homeland Security presented to the state departments.  Multifactor authentication complicates the task for attackers to connect to the control panel with the DNS settings. <br><br>  For example, 2FA could prevent attackers from replacing the Linux.org site in early December last year.  Fortunately, the attack was <a href="https://www.opennet.ru/opennews/art.shtml%3Fnum%3D49744">limited</a> only to vandalism with switching to another server in DNS. <br><br><blockquote>  ‚ÄúTwo-factor authentication is a simple security measure that will help protect against attacks with substitution of the DNS server response,‚Äù commented Sergey Belkin, head of the <a href="https://1cloud.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dsite">IaaS provider</a> development department at <a href="https://1cloud.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dsite">1cloud.ru</a> .  - Cloud providers can help with protection.  In particular, users of our free <a href="https://1cloud.ru/services/dns%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dsite">DNS hosting</a> can quickly connect 2FA using the <a href="https://1cloud.ru/news/2-factors-authentification%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dsite">prepared instructions</a> .  Additionally, customers can track all changes to their DNS records in their profile to make sure they are valid. ‚Äù </blockquote><br>  <b>Check the logs of certificates.</b>  Security experts advise administrators to double-check certificates using the <a href="https://www.certificate-transparency.org/">Certificate Transparency</a> tool.  This is an IETF standard and open source project that <a href="https://securitytrails.com/blog/what-are-certificate-transparency-logs">stores</a> information about all certificates issued for a specific domain. <br><br>  If it turns out that some of them were falsified, you can complain about the certificate and revoke it.  Special tools, such as <a href="https://github.com/SSLMate/certspotter">SSLMate</a> , will help you to track changes in the Certificate Transparency logs. <br><br>  <b>Go to DNS-over-TLS.</b>  To prevent attacks with DNS interception, some companies also use <a href="https://ru.wikipedia.org/wiki/DNS_%25D0%25BF%25D0%25BE%25D0%25B2%25D0%25B5%25D1%2580%25D1%2585_TLS">DNS-over-TLS</a> (DoT).  It encrypts and checks user requests to the DNS server and does not allow attackers to change the data.  For example, recently protocol support was <a href="https://security.googleblog.com/2019/01/google-public-dns-now-supports-dns-over.html">implemented</a> in Google Public DNS. <br><br><h2>  Perspectives </h2><br>  Attacks with DNS interception becomes more and more, and hackers are not always interested in user data.  Recently, dozens of hacked domains, including those from Mozilla and Yelp, <a href="https://arstechnica.com/information-technology/2019/01/godaddy-weakness-let-bomb-threat-scammers-hijack-thousands-of-big-name-domains/">used</a> to send fraudulent emails.  In this case, the hackers used a different attack pattern - they took control of the domains that the companies stopped using, but did not remove the provider from the DNS records. <br><br>  In most cases, hacking is to blame companies that did not bother with security issues.  Cloud providers can help deal with this problem. <br><br>  Often, the DNS servers of vendors, unlike the systems of companies, <a href="https://www.networkworld.com/article/3273891/hybrid-cloud/dns-in-the-cloud-why-and-why-not.html">are protected by</a> an additional protocol <a href="https://ru.wikipedia.org/wiki/DNSSEC">DNSSEC</a> .  It protects all DNS records with a digital signature that can only be created using a private key.  Hackers cannot enter arbitrary data into such a system, so it becomes more difficult to replace the response from the server. <br><br><h5>  Our posts from the corporate blog: </h5><br><ul><li>  <a href="https://1cloud.ru/blog/rezervnoe-kopirovanie-failov%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dblog">File backup: how to hedge against data loss</a> </li><li>  <a href="https://1cloud.ru/blog/intervju-s-klientom-1cloud-1c%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dblog">How 1cloud makes life easier for 1C developers.</a>  <a href="https://1cloud.ru/blog/intervju-s-klientom-1cloud-1c%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dblog">Interview with a client</a> </li><li>  <a href="https://1cloud.ru/blog/osobennosti-i-polza-obektnyh-hranilish%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Ddns%26utm_content%3Dblog">Where object storage is useful</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/439426/">https://habr.com/ru/post/439426/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>