<div class="post__text post__text-html js-mediator-article"><h1>  ... IP cameras, printers, automated process control systems and much more </h1><br>  <font color="gray"><b>Disclaimer</b> : The article is the result of several weeks of work.</font>  <font color="gray">I told the biggest problems to the server owners if I could find them, and to others about them in Cert.at.</font>  <font color="gray">In addition, I did not try to enter any device / service / site requiring a password.</font> <br><br>  <b>First of all: how to get all the IP-addresses of the whole country?</b> <br><br>  It is very simple.  IP addresses are not “generated” by the country, but are assigned by the central authority.  This means that there are lists of all IP addresses by country. <br><br>  Anyone can <a href="">download this list</a> .  Type <code>grep Austria IP2LOCATION-LITE-DB1.CSV &gt; austria.csv</code> and <a href="https://gist.github.com/chrisiaut/8473c8c0f28ca929e6f84e4e3d068241">run a simple script</a> to convert the IP addresses to a convenient format. <br><a name="habracut"></a><br>  11 million IPv4 addresses have been allocated to Austria.  More precisely, 11 170 487. <br><br>  If you do not want to mess around with your IP addresses <a href="https://www.shodan.io/">yourself</a> , use <a href="https://www.shodan.io/">Shodan.io</a> . <br><br><h1>  First target: unpatched Windows </h1><br>  Of course, no sysadmin in the country will put Windows SMB ports on the Network without filtering, right? <br><br> <code>masscan -p445 --rate 300 -iL austria.ips -oG austria.445.scan &amp;&amp; cat austria.445.scan | wc -l</code> <br> <br>  <b>1273 fully open systems found under Windows</b> . <br><br>  Wow.  This fact alone will make system administrators sweat, but since the Shadowbrokers published the ETERNALBLUE exploit, most IT specialists will agree that it’s not very good to put unprotected Windows machines on the Network. <br><br>  A positive point: <b>none of the 1273 machines were vulnerable to ETERNALBLUE</b> . <br><br><h1>  Enough about Windows, what about open resolvers? </h1><br>  Have you ever heard of open resolvers?  If not, then you heard about <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack">DDoS attacks</a> ?  This is a real problem on the Internet. <br><br>  It works like this: the attacker sends a small DNS request from a fake IP address (attack target), and the server responds to this IP address with a much larger packet.  The attacker spends only 40 bytes of traffic, and an open resolver sends the victim 4,000 bytes.  Thus, the attacker can attack the servers of large companies with volume traffic even from a regular smartphone.  What happens <a href="https://www.zdnet.com/article/github-was-hit-with-the-largest-ddos-attack-ever-seen/">quite often</a> . <br><br>  Check how many open resolvers in Austria. <br><br><h3>  We scan all Austria on port UDP 53 </h3><br>  I found in the country exactly 8728 publicly accessible DNS servers, which is 0.08% of all Austrian IP addresses. <br><br> <code>masscan -pU:53 -iL austria.ips -oG austria.53.scan &amp;&amp; cat austria.53.scan | wc -l</code> <br> <br>  But that means little.  More importantly, are they open resolvers? <br><br><h3>  Search for open resolvers </h3><br>  The method is simple: with the help of the <code>dig</code> command, we check if the random address that I provide will work on the IP resolving.  For the file with all IPs, I <code>dig +short test.openresolver.com TXT @ip.of.dns.server</code> command <code>dig +short test.openresolver.com TXT @ip.of.dns.server</code> .  If an <b>open-resolver-detected</b> response is received, the address is written to the log. <br><br>  Sadly ... using this method, I discovered that <b>25% of all Austrian DNS servers were open resolvers</b> .  However, in general, it is only 0.02% of Austrian IP addresses. <br><br><h1>  What else is vulnerable in Austria? </h1><br>  I'm glad you asked.  The easiest thing to check is port 80 (web servers and proxies). <br><br><h1>  Web servers </h1><br>  67,626 Austrian IP addresses are answered on port 80 (http).  Of these, 40,776 responded to a simple GET request (such a browser can send), and if you delete error messages, then 17,392 really working web servers remain. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/306/6c0/fec/3066c0fec163184abe28d26f731e3d08.png"></div><br>  The most popular Apache (from those that sent the <code>Server</code> header).  The oldest version I found - <code>Apache 1.3.12</code> from 2012 - runs on a Windows server.  Double nightmare. <br><br>  I also found four servers on <code>Windows CE</code> devices.  This system was released in 1996, and support was completely discontinued in 2013. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebc/db3/311/ebcdb331194e1008e8b60c4dad9cc97e.png"><br>  <i><font color="gray">Other old devices</font></i> <br><br><h3>  Visualization 17,000 websites </h3><br>  I wrote a script that takes a screenshot of any site using WKHTMLTOIMAGE to create a collage later.  The first collage turned out to be rather boring, as many sites display only a white page or error messages.  I had to put the filter on the minimum number of colors in the image. <br><br>  Just keep in mind that these are not all Austrian sites, but only the main pages that give out the web server to all IP addresses. <br><br>  Here is what a collage. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/951/7f9/8cf/9517f98cf448aff7e4b68d6ed60610da.jpg"></a> <br>  <i><font color="gray"><a href="">Full version</a> 3000 × 14500px occupies 12 MB</font></i> <br><br><h1>  Printers ... why not? </h1><br>  I found nine HP printers without logins, fully accessible from the Internet.  There were no passwords and even the seal worked. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84c/205/232/84c20523292d8e4e90ce36954659210c.jpg"><br>  <i><font color="gray">Printers without passwords (yes, I can print them)</font></i> <br><br>  This screenshots have the opportunity to send a fax through the website.  But the owner was lucky: since the device has a fax number, I called him and he deleted his printer from the Internet.  Well done! <br><br><h1>  Webcams </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/5e2/195/f16/5e2195f16e06ef5429f66696a5020b76.jpg"><br>  <i><font color="gray">Home security system showing someone's home</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f43/f3f/da3/f43f3fda35b7b8ab7f9745a6bbcddbf4.jpg"><br>  <i><font color="gray">Someone edited the text layer on top of the image and wrote “1984”</font></i> <br><br>  These are just two of more than 300 IP cameras that broadcast video without passwords.  If anything, all the cameras can be found <a href="https://www.insecam.org/en/bycountry/AT/">here</a> . <br><br><h3>  Finally, I'll show you some weird things I found. </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/fac/5f7/943/fac5f79436eb88c4e2d5b7954e1ba5c2.png"><br>  <i><font color="gray">Smart House.</font></i>  <i><font color="gray">Control of light and speakers</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e7/6a9/b78/5e76a9b786bbe8879c977178f958a636.jpg"><br>  <i><font color="gray">Sewage treatment plant</font></i> <br><br><h1>  Conclusion </h1><br>  Austria is a small country, but in the field of information security it has the same problems as the others.  Hazards should be more clearly recognized, and device suppliers and manufacturers should help users by offering safe default configurations. <br><br>  Companies should hire good system administrators to monitor the network infrastructure and keep the servers up to date. </div>