<div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ip/ds/cs/ipdscs4kq9sanmqsyphzumdxvck.png" alt="MikroTik RODOS-8/9/10" align="left"><br><br><h2>  A handy tool for managing PDUs in MikroTik routers </h2><br>  <b>MikroTik</b> company is known as a manufacturer of network equipment, characterized by high reliability at low cost and rich functionality.  The software foundation for MikroTik products is <b>RouterOS</b> , a Linux-based network operating system.  It runs on <b>RouterBOARD</b> - a large line of hardware solutions, which includes both purely operator equipment and platforms for home use.  RouterOS provides the administrator / user with a great deal of ability to configure and manage the router, allowing you to operate not only with the built-in functionality of the system, but also create your own versions of almost any solutions through script programming. <br><br>  In this article I will look at how you can use the advanced functionality of MikroTik routers to issue power management commands using a <b>PDU (Internet relay)</b> directly from a router through script functions. <a name="habracut"></a>  As a PDU, I used the OLYMP RODOS-8/9/10 Ethernet relay (devices are absolutely identical in terms of control), which remained after several projects and were “at hand”. <br><br><h2>  RouterOS PDU Management Features </h2><br>  The advanced functionality of RouterOS can allow: <br><br><ul><li>  Remotely turn on / off the power of devices connected to the PDU </li><li>  Remotely manage the PDU on the occurrence of various events on the network (for example, if there is no response from any device to ping, when a specific VPN client, a wifi network client, etc., connect to the router, depending on the time) (Scheduled) </li><li>  To notify the administrator or users about the change of the relay status on the PDU by email or phone number (by SMS) </li></ul><br>  Thus, it is possible to organize, for example, control of server equipment, turn on / off / restart “stuck” network equipment, turn on cooling or heating, lighting, manage any loads allowed by nominal power as part of Smart Home, and much more that can allow Your imagination. <br><br>  The ability to control Internet relays from RouterOS is provided by the <b>fetch</b> router command, the syntax of which is described in detail at the link at the end of the article. <br><br><h2>  PDU control via the fetch router command </h2><br>  The RODOS-8/9/10 PDUs support the following URL referral format: <br><br><div class="spoiler">  <b class="spoiler_title">http: // [login]: [Password] @ [IP address] [/ protect] / rb [X-1] [action] .cgi</b> <div class="spoiler_text"><ul><li>  Login and password - the relevant data to access the device in "protected mode" (protect) </li><li>  IP Address — The IP address of the device on the network. </li><li>  / protect - access key in "protected mode".  If the device is set to "open" access, / protect is not specified, also does not specify the login and password </li><li>  [action] - performed action on the relay: n-turn on, f-turn off, s-give a pulse of 1 sec duration </li><li>  X is the number of the relay that is accessed, the possible values ​​depend on the device model: <br><ol><li>  RODOS-8 - not specified, because  the device has a single relay </li><li>  RODOS-9 - X = 1 or X = 2 </li><li>  RODOS-10 - X = [1-4] </li></ol></li></ul><br>  All specified parameters are passed without brackets []. </div></div><br>  Thus, to solve our problem in RouterOS, to enable the first relay of our PDU, the following entry is enough: <br><br><pre><code class="hljs pgsql">/tool <span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span> url="http://[логин:пароль]@192.168.1.20/protect/rb0n"</code> </pre> <br>  If we want the device to return a response, we should use: <br><br><pre> <code class="hljs pgsql">/tool <span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span> url="http://[логин:пароль]@192.168.1.20/protect/rb0n" mode=http dst-<span class="hljs-type"><span class="hljs-type">path</span></span>="Rodosanswer.txt"; :<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> Rodosanswer [/file <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> Rodosanswer.txt contents];</code> </pre> <br>  The PDU response in our case is returned using the <b>json</b> mechanism to the <b>Rodosanswer</b> variable in the following form: <br><br><ul><li>  “Success!  "- in case of successful command execution </li><li>  “Fault” - when the command is not executed (as a rule, when contacting without specifying the login and password of the PDU in the URL line, if the PDU is in the “protected” mode) </li></ul><br><h2>  We create the PDU Rodos control function in the repository of the Mikrotik router </h2><br>  So let's get started.  Let's create a relay control function using the RODOS-10 control example in the MikroTik router scripts repository under the name "Func_RODOS10rele": <br><br><div class="spoiler">  <b class="spoiler_title">Code "Func_RODOS10rele"</b> <div class="spoiler_text"><pre> <code class="hljs mel">################ FuncRODOS10rele ###################### # Функция установки состояния реле PDU RODOS<span class="hljs-number"><span class="hljs-number">-10</span></span> # by Sergej Serkov <span class="hljs-number"><span class="hljs-number">23.12</span></span><span class="hljs-number"><span class="hljs-number">.2017</span></span> ####################################################### # определяем функцию, устанавливающую реле :<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> FuncRODOS10rele <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :local Sport <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([:len $Rport]=<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={:set Sport <span class="hljs-string"><span class="hljs-string">"80"</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={:set Sport $Rport;} :<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> FuncPing; :local PingAnswer [$FuncPing PingAdr=$Radr]; :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($PingAnswer=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :local Rprotect; :local Wprotect; :local Rmode <span class="hljs-string"><span class="hljs-string">"0"</span></span>; :local Nrele <span class="hljs-number"><span class="hljs-number">0</span></span>; :local Act; :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (([:len $Rlogin]=<span class="hljs-number"><span class="hljs-number">0</span></span>) and ([:len $Rpass]=<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={:set Rprotect <span class="hljs-string"><span class="hljs-string">""</span></span>; set Wprotect <span class="hljs-string"><span class="hljs-string">""</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={:set Rprotect (<span class="hljs-string"><span class="hljs-string">"$Rlogin"</span></span>.<span class="hljs-string"><span class="hljs-string">":"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Rpass"</span></span>.<span class="hljs-string"><span class="hljs-string">"@"</span></span>); set Wprotect <span class="hljs-string"><span class="hljs-string">"/protect"</span></span>;} :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Rstatus=<span class="hljs-string"><span class="hljs-string">"on"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={:set Rmode <span class="hljs-string"><span class="hljs-string">"1"</span></span>; :set Act <span class="hljs-string"><span class="hljs-string">"n"</span></span>} :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Rstatus=<span class="hljs-string"><span class="hljs-string">"off"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={:set Rmode <span class="hljs-string"><span class="hljs-string">"1"</span></span>; :set Act <span class="hljs-string"><span class="hljs-string">"f"</span></span>} :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Rstatus=<span class="hljs-string"><span class="hljs-string">"inv"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={:set Rmode <span class="hljs-string"><span class="hljs-string">"1"</span></span>; :set Act <span class="hljs-string"><span class="hljs-string">"s"</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={} :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Rmode=<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :set Nrele ([:tonum $Rrele] - <span class="hljs-number"><span class="hljs-number">1</span></span>); :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($Nrele &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> and ($Nrele &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :local StrFetchRodos; :set StrFetchRodos (<span class="hljs-string"><span class="hljs-string">"http://"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Rprotect"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Radr"</span></span>.<span class="hljs-string"><span class="hljs-string">":"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Sport"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Wprotect"</span></span>.<span class="hljs-string"><span class="hljs-string">"/rb"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Nrele"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Act"</span></span>.<span class="hljs-string"><span class="hljs-string">".cgi"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { [/tool fetch url=$StrFetchRodos mode=http dst-path=<span class="hljs-string"><span class="hljs-string">"Rodosanswer.txt"</span></span>;]; } on-<span class="hljs-keyword"><span class="hljs-keyword">error</span></span>={: <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> (<span class="hljs-string"><span class="hljs-string">"Call ERROR function &lt;RODOS10rele&gt; ERROR fetch command"</span></span>); :local Rodosanswer <span class="hljs-string"><span class="hljs-string">"ERROR: command ROS &lt;fetch&gt;"</span></span>; : <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Rodosanswer} :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">warning</span></span> (<span class="hljs-string"><span class="hljs-string">"Сall "</span></span>.<span class="hljs-string"><span class="hljs-string">"$Wprotect "</span></span>.<span class="hljs-string"><span class="hljs-string">"function &lt;RODOS10rele&gt; set rele #"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Rrele "</span></span>.<span class="hljs-string"><span class="hljs-string">"is ["</span></span>.<span class="hljs-string"><span class="hljs-string">"$Rstatus"</span></span>.<span class="hljs-string"><span class="hljs-string">"]"</span></span>); :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :delay <span class="hljs-number"><span class="hljs-number">2</span></span>s; :local Rodosanswer [/<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> get Rodosanswer.txt contents]; /<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> remove Rodosanswer.txt; :<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Rodosanswer; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={ :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> (<span class="hljs-string"><span class="hljs-string">"Сall ERROR"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Wprotect "</span></span>.<span class="hljs-string"><span class="hljs-string">"function &lt;RODOS10rele&gt; set rele#"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Rrele"</span></span>.<span class="hljs-string"><span class="hljs-string">" but NUMBER RELE MISMATCH"</span></span>); :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :local Rodosanswer <span class="hljs-string"><span class="hljs-string">"ERROR: rele range mismath"</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Rodosanswer;} } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={ :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> (<span class="hljs-string"><span class="hljs-string">"Сall ERROR"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Wprotect "</span></span>.<span class="hljs-string"><span class="hljs-string">"function &lt;RODOS10rele&gt; set rele#"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Rrele"</span></span>.<span class="hljs-string"><span class="hljs-string">" but RELE REGIME SET MISMATCH"</span></span>); :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :local Rodosanswer <span class="hljs-string"><span class="hljs-string">"ERROR: rele regime set mismatch"</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Rodosanswer;} } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={ :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> (<span class="hljs-string"><span class="hljs-string">"Сall ERROR"</span></span>.<span class="hljs-string"><span class="hljs-string">"$Wprotect "</span></span>.<span class="hljs-string"><span class="hljs-string">"function &lt;RODOS10rele&gt; but DEVICE NOT RESPONDED"</span></span>); :<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> info <span class="hljs-string"><span class="hljs-string">""</span></span>; :local Rodosanswer <span class="hljs-string"><span class="hljs-string">"ERROR: device not responded"</span></span>; :<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Rodosanswer;} }</code> </pre></div></div><br>  The FuncRODOS10rele function also uses in its work another small ping network address checking function - <b>FuncPing</b> , which should be present in the environment of the router's repository variables when the main function is running. <br><br><div class="spoiler">  <b class="spoiler_title">Code "Func_Ping"</b> <div class="spoiler_text"><pre> <code class="hljs mel">:<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> FuncPing <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :local PingCount <span class="hljs-number"><span class="hljs-number">3</span></span>; # количество пингов; :local Result [/ping $PingAdr count=$PingCount]; :delay <span class="hljs-number"><span class="hljs-number">2</span></span>s; :local PingAnswer <span class="hljs-string"><span class="hljs-string">""</span></span>; :local MainIfInetOk false; :set MainIfInetOk ((<span class="hljs-number"><span class="hljs-number">3</span></span>*$Result) &gt;= (<span class="hljs-number"><span class="hljs-number">2</span></span> * $PingCount)) :put <span class="hljs-string"><span class="hljs-string">"MainIfInetOk=$MainIfInetOk"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$MainIfInetOk) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :set PingAnswer <span class="hljs-string"><span class="hljs-string">"ERROR"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($MainIfInetOk) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={ :set PingAnswer <span class="hljs-string"><span class="hljs-string">"OK"</span></span> } :<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $PingAnswer;}</code> </pre></div></div><br><h2>  Application of relay control function </h2><br>  As parameters of the function FuncRODOS10rele, you need to pass the following: <br><br><ul><li>  Radr - device IP address </li><li>  Rport - http port.  If the standard port for http (80) is configured, this parameter can be omitted. </li><li>  Rrele - the number of the relay over which we perform the action (for RODOS-10 [1-4]), <br>  for RODOS-9 [1-2], for RODOS-8 is not transmitted) </li><li>  Rstatus - the action to be performed (“off” —disable; “on” —include; “inv” - to give an impulse) </li><li>  Rlogin - login, Rpass - device access password <br>  (if they are not specified, the command call without "/ protect" is used) <br></li></ul><br><div class="spoiler">  <b class="spoiler_title">Example 1: a function call with access to the PDU through the standard http port when the "protected mode" is turned off in the module, the inclusion of relay No. 2:</b> <div class="spoiler_text"><pre> <code class="hljs json">[$FuncRODOS10rele Radr=<span class="hljs-string"><span class="hljs-string">"192.168.1.20"</span></span> Rrele=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Rstatus=<span class="hljs-string"><span class="hljs-string">"on"</span></span>]</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Example 2: function call with access to the PDU via the configured http 8021 port with the “protected mode” set, relay # 2 shutdown</b> <div class="spoiler_text"><pre> <code class="hljs json">[$FuncRODOS10rele Radr=<span class="hljs-string"><span class="hljs-string">"192.168.1.20"</span></span> Rport=<span class="hljs-string"><span class="hljs-string">"8021"</span></span> Rrele=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Rstatus=<span class="hljs-string"><span class="hljs-string">"off"</span></span> Rlogin=<span class="hljs-string"><span class="hljs-string">"login"</span></span> Rpass=<span class="hljs-string"><span class="hljs-string">"password"</span></span>]</code> </pre> </div></div><br>  The function response can be returned in the string variable <b>Rodosanswer</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Rodosanswer may contain the following text:</b> <div class="spoiler_text"><pre>  • "Success!" - in the case of successful treatment and execution of the command

  • "Fault" - in case of erroneous handling and non-execution of the command

  • "ERROR: rele range mismatch" - in case of specifying an invalid relay number 
	 in the Rrele function parameter for this device version

  • "ERROR: rele set set mismatch" - in case of unspecified or incorrect 
     the specified parameter of the function Rstatus ("on", "off", "inv")

  • "ERROR: device not responded" - in case of no response from the device 
     on ping

  • "ERROR: command ROS &lt;fetch&gt;" - in case of an error directly
     when executing the RouterOS fetch URL command (as a rule, when
     the specified port number in Rport, incorrectly specified Rlogine parameters
     and / or Rpass)
</pre></div></div><br>  You can call the relay control function on the PDU from any of your other scripts as follows: <br><br><ol><li>  First you need to execute the scripts that place the necessary functions in the environment of the variables of the router repository.  This can be done only once, for example, when starting a router from the RouterOS Scheduler ( <b>/ system schеduler</b> ) <br><br><pre> <code class="hljs pgsql"># однократно запускаем скрипт функции для ее размещения в окружении /<span class="hljs-keyword"><span class="hljs-keyword">system</span></span> script run Func_RODOS10rele; # аналогично устанавливаем в окружение функцию «FuncPing» # (используется функцией FuncRODOS10rele) /<span class="hljs-keyword"><span class="hljs-keyword">system</span></span> script run Func_Ping;</code> </pre> </li><li>  After the functions are defined, you can use them (in particular, call FuncRODOS10rele) <br><br>  As an example, let’s call our function by applying a pulse to relay No. 4 PDU RODOS-10: <br><br><pre> <code class="hljs ruby"><span class="hljs-symbol"><span class="hljs-symbol">:global</span></span> FuncRODOS10rele; <span class="hljs-symbol"><span class="hljs-symbol">:local</span></span> Rodosanswer [$FuncRODOS10rele Radr=<span class="hljs-string"><span class="hljs-string">"192.168.1.20"</span></span> Rport=<span class="hljs-string"><span class="hljs-string">"8021"</span></span> Rrele=<span class="hljs-string"><span class="hljs-string">"4"</span></span> Rstatus=<span class="hljs-string"><span class="hljs-string">"inv"</span></span> Rlogin=<span class="hljs-string"><span class="hljs-string">"login"</span></span> Rpass=<span class="hljs-string"><span class="hljs-string">"password"</span></span>]; <span class="hljs-symbol"><span class="hljs-symbol">:log</span></span> info $Rodosanswer;</code> </pre><br>  The answer will be returned to the variable <b>Rodosanswer</b> and, in this case, displayed in the log of the router. <br><br><h2>  Ready library of functions for working with PDU </h2><br>  For ease of use, I created a library of functions for Rodos PDU models 8, 9, 10, and 10 DIN versions (library version 1.0 dated December 25, 2017).  Library scripts are combined into the Func_RODOS.rsc file, which can be imported to RouterOS with the following WINBOX utility terminal command: <br><br><pre> <code class="hljs swift">/<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> file= Func_RODOS.rsc</code> </pre> <br>  The import process can take from 20 seconds to 1 minute depending on the model of the Mikrotik router (its speed). <br>  In this case, all the scripts that were previously available in the router are not affected, the functions and scripts of the Func_RODOS library are added to the existing repository scripts. <br><br><div class="spoiler">  <b class="spoiler_title">The library Rodos.rsc version 1.0 contains the following scripts:</b> <div class="spoiler_text"><ul><li>  start_RODOS - running this script sets all functions in the environment of variables </li><li>  Func_Ping - the function of checking the address to "ping" </li><li>  Func_Mail - the function of sending an arbitrary message to the mail of the administrator of the router </li><li>  Func_RODOS8rele - PDU RODOS-8 relay control function </li><li>  Func_RODOS8reset - reset function ("reset") relay PDU RODOS-8 </li><li>  Func_RODOS9rele - ... similarly for the models mentioned ... </li><li>  Func_RODOS9reset </li><li>  Func_RODOS10rele </li><li>  Func_RODOS10reset </li><li>  call_example [...] - examples of library function calls </li><li>  Func_RODOS_lib - all PDU functions (except Ping and Mail) in one script file </li></ul></div></div><br>  After importing the library, you can delete unnecessary functions and scripts from the repository, leaving only the functions of your PDU model and scripts with FuncMail and FuncPing functions. <br><br>  In the library, for each of the supported PDU models, there are also convenient reset functions ("reloads") (labeled in the names as "~ reset").  The parameters of the reload functions are the same as the parameters of the relay installation functions, except for the “Rstatus” parameter, which is not used during the “reboot” and the additional optional parameter Rtime, which defines the time in seconds between switching off and switching on the switched relay (if Rtime is not transferred to the function, the default is time 5 seconds). <br><br>  Reboot functions work as follows: <br><ol><li>  The specified relay is sent a command to turn off </li><li>  It then waits for Rtime seconds followed by an enable command.  At the same time, the reset functions refer to the corresponding relay setting functions, which must be defined before calling the first </li></ol><br>  Thus, if, before calling the reset function, a certain relay was turned on, it will be turned off and after a specified time it is turned back on (and the load connected to it is “reset”).  A similar operation is performed on the switched off relay and after the function is run, the relay becomes on (that is, in this case, the function works as a function of switching on the relay).  The reset functions are conveniently used for rebooting connected to the Rodos PDU of “hung” network equipment (access points, routers, switches, various servers, etc ...). <br><br>  The source code of the Rodos.rsc library (functions and scripts — examples of accessing them) are “commented on” in sufficient detail, which may be useful for those who want to understand the work of the library in detail (and perhaps even independently modify them, or write your own version). <br><br>  In the examples of the reboot function calls after the function has been worked out, messages are sent to the administrator’s email address of the router (you can specify your email address in the script variable settings).  In this case, the scripts use the RouterOS mail service from <b>/ tool e-mail</b> , the parameters of which should be correctly configured by you in advance. <br><br><h2>  Future plans </h2><br>  In the future, the library of scripts for the Rodos PDU will be expanded - it is planned to create functions for the RODOS-16 Internet weather station, which has “on board”, in addition to the relay, I / O lines and temperature / humidity / atmospheric pressure sensors.  It is also planned to implement the logging of functions not only to the log of the router and to the mail, but also to the specified phone number of the user’s choice (by sending SMS messages via the router's modem). <br><br>  It is possible that in the process of using the library by users (including readers of this material) any errors will be revealed, which, as a rule, are unavoidable during any development.  All errors, comments and suggestions please inform me for their correction. <br><br>  <a href="https://wiki.mikrotik.com/wiki/Manual:Tools/Fetch">Link to the Fetch command description for MikroTik routers</a> <br>  <a href="https://olimp-z.ru/products/RODOS-8_9_10/RODOS-8_9_10.pdf">Link to the documentation for the PDUs used</a> <br>  <a href="https://cloud.mail.ru/public/9iqF/6Hbacdwsr">Link to Rodos PDU script library</a> <br><br>  Serkov Sergey Vladimirovich, 12.26.2017 </li></ol></div>