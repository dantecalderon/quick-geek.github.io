<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Xcode 10.2, macOS Mojave 10.14.4, iOS 12.1 and other beta versions</title>
  <meta name="description" content="New Xcode beta, macOS Mojave and iOS have been released - and here are the main points that I learned. 

 Swift 5 for Xcode 10.2 beta 
 Swift 
 First ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Xcode 10.2, macOS Mojave 10.14.4, iOS 12.1 and other beta versions</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/nh/62/fp/nh62fpv4v4whs_gzolx479bjnv0.jpeg"><br><br>  New Xcode beta, macOS Mojave and iOS have been released - and here are the main points that I learned. <br><br><h1>  Swift 5 for Xcode 10.2 beta </h1><br><h2>  Swift </h2><br>  First of all, the latest beta version of Xcode comes bundled with the new version of Swift: <br><br> <code>Apple Swift 5.0 (swiftlang-1001.0.45.7 clang-1001.0.37.7) <br> Target: x86_64-apple-darwin18.2.0 <br> ABI version: 0.6</code> <br> <br>  Let's start with the most exciting news: <br><blockquote>  Swift apps no longer include the DLL for the Swift standard library and the Swift SDK overlay in versions for iOS 12.2, watchOS 5.2 and tvOS 12.2.  As a result, Swift applications are reduced in size when deployed for testing in TestFlight or when compressing an archive for a distribution. </blockquote>  ABI is finally going to be stable, and this is great news.  In my opinion, today this is one of the key problems of Swift - not because of side effects, but because of unfulfilled promises.  Some of my friends even rewrite extensions for Apple Watch on Objective-C to reduce the size of a binary file (from about 15 MB to 1 MB).  To learn more about the state of ABI, please use the following links: <a href="https://swift.org/abi-stability/">Swift ABI Dashboard and Swift ABI</a> <a href="">Stability Manifesto</a> . <br><a name="habracut"></a><br><blockquote>  The @dynamicCallable attribute allows you to call named types as well as functions using simple syntactic sugar.  The main purpose is to ensure compatibility with dynamic languages.  ( <a href="">SE-0216</a> ) </blockquote><br>  Example: <br><br><pre> <code class="plaintext hljs">@dynamicCallable struct ToyCallable {   func dynamicallyCall(withArguments: [Int]) {}   func dynamicallyCall(withKeywordArguments: KeyValuePairs&lt;String, Int&gt;) {} } let x = ToyCallable() x(1, 2, 3) // Desugars to `x.dynamicallyCall(withArguments: [1, 2, 3])` x(label: 1, 2) // Desugars to `x.dynamicallyCall(withKeywordArguments: ["label": 1, "": 2])</code> </pre> <br>  This topic is quite extensive, and the innovation makes me have mixed feelings.  Paul Hudson was able to talk about it from a neutral position in the article " <a href="https://www.hackingwithswift.com/articles/126/whats-new-in-swift-5-0">What's new in Swift 5.0</a> ". <br><blockquote>  Swift 3 compatibility mode is excluded.  Supported values ‚Äã‚Äãfor the <code>-swift-version</code> flag are 4, 4.2, and 5. </blockquote><br>  The era is leaving: source-level compatibility with Swift 3 is no longer.  This step was expected, it was announced in Swift 5 Roadmap, and yet.  I strongly advise you to refresh your memory by reading the <a href="https://swift.org/blog/5-0-release-process/">Swift 5.0 Release Process</a> .  Swift 5 is already near - be prepared. <br><blockquote>  In Swift 5 mode, switch statements on enumerations declared in Objective-C or coming from system frameworks must process unknown values ‚Äã‚Äã‚Äî that is, those that may be added in the future or that can be defined separately in the Objective-C implementation file. <br><br>  Formally, Objective-C allows any value to be included in an enumeration if it corresponds to the base type.  These unknown cases can be processed using the new case of <code>@unknown default</code> , which still issues a warning if any known cases in the switch are missing.  They can be controlled using the normal <code>default</code> .  If you specify an enumeration in Objective-C and do not want clients to have to handle unknown values, use the <code>NS_CLOSED_ENUM</code> macro instead of <code>NS_ENUM</code> .  The Swift compiler recognizes it and does not require setting the <code>default</code> in a switch statement. <br><br>  In Swift 4 and 4.2 modes, you can also use the <code>@unknown default</code> .  If you do not do this and skip the unknown value in the switch, the program will be interrupted - just as it was in Swift 4.2 and Xcode 10.1 ( <a href="">SE-0192</a> ) </blockquote><br>  This is a long-standing problem that still causes inconvenience, especially if you prefer not to set <code>default</code> switches.  I remember how much agony the <code>.provisional</code> option in the <code>UNAuthorizationOptions</code> type appeared in iOS 12.  Now, with the introduction of case'and <code>unknown</code> , to cope with such situations has become much easier. <br><br><h3>  Swift Package Manager </h3><br><blockquote>  Now packages can choose the minimum required version for the Apple platform (macOS, iOS) when using the Package.swift configuration file from Swift 5. Building a package is not possible if at least one of the dependencies the minimum platform version is greater than the version specified for the package itself.  ( <a href="">SE-0236</a> ) </blockquote><br>  In my opinion, this is the main news regarding SPM.  In fact, this feature can solve many problems that prevent SPM from becoming useful in the iOS world.  In my <a href="https://dive.github.io/swift-package-manager/ios/2019/01/20/swift_package_manager_vs_ios.html">last article,</a> I tried to analyze the current state of SPM in the context of iOS development.  It seems that now I will have to revise the conclusions. <br><br>  But there are problems: <br><br><ul><li>  in some projects there is a regression of the compile time compared to previous releases; <br></li><li>  command line projects <code>dyld: Library not loaded</code> on startup, giving the error <code>dyld: Library not loaded</code> <br>  (library not loaded).  Crutch: Set custom build for <code>SWIFT_FORCE_STATIC_LINK_STDLIB=YES</code> . <br></li></ul><br>  The <a href="https://developer.apple.com/documentation/xcode_release_notes/xcode_10_2_beta_release_notes/swift_5_release_notes_for_xcode_10_2_beta">change log</a> lists many corrected problems and other information about Swift 5 that may be important to your business.  Review them: you may decide to use inherited assigned initializers with a variable number of arguments.  Or, suddenly, you are faced with the problem of interlocking due to complex recursive type definitions with classes and generics.  Alternatively, generic pseudonyms in the <code>@objc</code> method cause you inconvenience. <br><br><h1>  Xcode 10.2 beta </h1><br><h3>  Clang compiler </h3><br>  There are many new alerts for the Clang compiler, and most of them are related to frameworks and modules.  This fact is quite interesting, since it ( <i>presumably</i> ) speaks of integrating the Swift Package Manager as a tool for managing dependencies.  Here, in my opinion, the most important points: <br><blockquote><ul><li>  A new diagnostic identifies framework headers that use inclusions with quotes instead of framework-style inclusions.  By default, the alert is turned off, but you can turn it on by passing the <code>clang</code> <code>-Wquoted-include-in-framework-header</code> option; <br></li><li>  open framework headers can erroneously perform <code>#import</code> or <code>#include</code> private headers, which leads to disruption of the structure, and sometimes to the cyclic import of modules.  About such violations will report a new diagnosis.  It is disabled by default in <code>clang</code> and is controlled by the <code>-Wframework-include-private-from-public</code> flag; <br></li><li>  Using <code>@import</code> in framework headers does not allow using them without modules.  New diagnostics seeks out <code>@import</code> in the headers when passing the <code>‚Äîfmodules</code> flag.  By default, it is disabled and controlled by the <code>-Watimport-in-framework-header</code> flag; <br></li><li>  Previously, the loss of the <code>framework</code> keyword when declaring a module for a framework did not interfere with the compilation, but silently led to an incorrect result.  New diagnostics- <code>-Wincomplete-framework-module-declaration</code> and a new fix will prompt you to add the required key.  This warning is triggered automatically by passing the <code>‚Äîfmodules</code> <code>clang</code> flag. <br></li></ul><br></blockquote><br>  First of all: how to turn them on?  Go to the <i>Build Settings</i> menu for your project, select the <i>Apple Clang - Custom Compiler Flags</i> option and set the required flag in the <i>Other C Flags</i> item. <br><br><img src="https://habrastorage.org/webt/i-/x2/sf/i-x2sfph0eovrw19ebbzs4cpyce.png"><br><br>  I tried building an old Objective-C application and found many problems with private headers in the open framework headers: <br><br><img src="https://habrastorage.org/webt/i-/x2/sf/i-x2sfph0eovrw19ebbzs4cpyce.png"><br><br>  Also, there were problems with import quotes inside the framework: <br><br><img src="https://habrastorage.org/webt/ut/d2/nr/utd2nrsy3zh2r_wrxi01mwsnoo8.png"><br><br>  I advise you, too, to conduct a similar diagnosis, or at least make a note for the future.  Once these problems can cause a lot of trouble. <br><br><h3>  Assembly system </h3><br>  There is also a nice update in the code assembly system. <br><blockquote>  The search for implicit dependencies now works in the ‚Äúother linker flags‚Äù section of related frameworks and libraries marked <code>-framework, -weak_framework, -reexport_framework, -lazy_framework, -weak-l, -reexport-l, -lazy-l –∏–ª–∏ ‚Äîl.</code> </blockquote><br>  This innovation is also very intriguing.  In essence, it means that you can now define implicit dependencies with the <code>.xcconfig</code> or even <code>xcodebuild</code> , avoiding the Link / Embed stages in Xcode itself. <br><br><h3>  Debugging </h3><br>  Debugger innovations: <br><blockquote>  <code>UIStackView</code> properties <code>UIStackView</code> now displayed in the visual debugger inspector.  The visual debugger has a more compact three-dimensional view. </blockquote><br><br><img src="https://habrastorage.org/webt/vz/qh/ir/vzqhirrk_uovikmjfsfn8vb_xt8.png"><br><br><blockquote>  Now, if an error occurs due to insufficient memory, Xcode can automatically create a graph of memory usage.  You can enable the creation of graphs in the diagnostics window in the schematic execution settings <br><br>  When approaching the limit of memory usage in iOS and watchOS Xcode displays the limit in the memory usage report. </blockquote><br><br><img src="https://habrastorage.org/webt/j8/rf/fq/j8rffqox3q4bamxpa_uurzu2np8.png"><br><br>  See the red line?  When it is reached, Watchdog will send a notification to <code>applicationDidReceiveMemoryWarning</code> .  I thought that the update would be more useful, but for now it's just a little plus. <br><br><h3>  LLDB debugger </h3><br>  New buns appeared in LLDB: <br><blockquote><ul><li>  Now you can use $ 0, $ 1, and other abbreviations when calculating expressions inside closures. <br></li><li>  LLDB now has a new alias, <code>v</code> for the frame variable command, which serves to output variables in the current frame stack.  Since it does not use the expression evaluation tool, <code>v</code> can be much faster than <code>p</code> or <code>po</code> , and therefore preferable. <br></li></ul><br></blockquote><br>  I did not find an increase in performance, but in some cases <code>v</code> provides the best output ‚Äî but it is not a direct replacement for <code>po</code> and only works with the current frame stack with certain restrictions.  Examples: <br><br><img src="https://habrastorage.org/webt/bo/8b/bi/bo8bbigjksjdmb3bpeod_nmbvqs.png"><br><br><h3>  Playgrounds </h3><br>  My favorite section!  Let's start with the bugs: <br><blockquote>  Playgrounds may not start </blockquote><br>  Unfortunately, there was no other news about the Playgrounds in the new beta. <br><br><h3>  Simulator </h3><br>  A couple of words about the simulator: <br><blockquote>  Siri does not work in watchOS and iOS simulators. <br><br>  Pasteboard synchronization between macOS and simulated iOS devices has become more reliable. </blockquote><br><br>  I hope this is true. <br><br><blockquote>  The request to access the microphone on all simulated devices will not be repeated. </blockquote><br><br>  This is good news because, due to this problem, many people had difficulty with CI and build agents.  Now you can build a crutch, or at least supplement your guides on working with assembly agents, including the ‚ÄúRun the simulator once‚Äù option. <br><br><h3>  Testing </h3><br><blockquote><ul><li>  <code>xccov</code> supports combining several code coverage reports (and associated archives) into one general report and archive.  The resulting report may contain inaccuracies, since there may be changes in the source files between the time the reports are created.  If there are no changes, the report will be correct. <br></li><li>  Now <code>xccov</code> reflects the difference between Xcode's different code coverage reports, which can be used to calculate changes in coverage that have occurred.  For example, to highlight the difference between <code>before.xccovreport</code> and <code>after.xccovreport</code> , call the <code>xccov</code> command as follows: <code>xccov diff --json before.xccovreport after.xccovreport</code> . <br></li><li>  Static libraries and framework targates now appear in the coverage report as top-level records ‚Äî coverage metrics are collected across all targets that include a static library or framework.  It also solves the problem when the source files of the static library or the framework framework are included in the report, even if the target itself is removed from the code coverage in the schema. <br></li></ul><br></blockquote><br>  Great news for continuous integration, especially the demonstration of difference.  Tell your release engineers or those who deal with such things. <br><br>  However, there are several limitations regarding the parallelization of tests: <br><br><ul><li>  writing on clones does not work when parallelization is enabled; <br></li><li>  project profiling from Xcode behaves incorrectly with the parallelization of tests enabled. <br></li></ul><br><br>  The rest is pleased with the correction of some bugs: <br><blockquote>  If testing fails due to a crash test runner on startup, Xcode will try to generate a detailed message describing the error.  This error can be studied in the test log, and if you are using <code>xcodebuild</code> , it will appear in <code>stdout</code> .  It is also contained in the structured logs of the resulting package. </blockquote><br>  We often have similar problems - and we are wondering what happened.  Sometimes it's in the wrong layout, sometimes in system overload.  Now the reliability of the application will increase. <br><blockquote>  In the departure reports collected during testing, important sections such as the reason for departure or description are no longer lost. </blockquote><br>  Here, without comment, continuous delight. <br>  The latest news, useful to many developers: now Xcode supports <a href="https://support.apple.com/en-gb/guide/mac-help/about-content-caching-on-mac-mchl9388ba1b/mac">macOS content caching service</a> .  This means that you can create a caching server on the local network, which saves time and money when downloading new and old versions of Xcode on the local network. <br><br><h3>  Problems </h3><br>  In this beta, I encountered several problems.  Basically, they dealt with tools from third-party developers.  For example, <code>carthage</code> gives the error "No available simulators for iOS were found." <br><br>  I checked the available simulator, and it seems to be the fault of the beta.  In addition, download of other runtimes from Xcode is not available - the list of available simulators is empty: <br><br><pre> <code class="plaintext hljs">$ xcrun simctl list devices --json | grep -A16 12.1   "com.apple.CoreSimulator.SimRuntime.iOS-12-1" : [     {       "availability" : "(unavailable, runtime profile not found)",       "state" : "Shutdown",       "isAvailable" : false,       "name" : "iPhone 5s",       "udid" : "DDD36346-A76F-42E8-80F4-6F11E1EE4BEB",       "availabilityError" : "runtime profile not found"     },     {       "availability" : "(unavailable, runtime profile not found)",       "state" : "Shutdown",       "isAvailable" : false,       "name" : "iPhone 6",       "udid" : "21794717-BC89-45E4-9F57-8CF9D14A87D1",       "availabilityError" : "runtime profile not found"     }, --</code> </pre> <br>  But this is just a beta, and the list of changes is huge.  Stock up on patience.  Carthage is already studying the situation, all the guesses are set out in this <a href="https://github.com/Carthage/Carthage/issues/2691">bug</a> . <br><br><h1>  iOS 12.2 beta </h1><br>  Well well.  Apple seems to be busy polishing technical debt and imposing security patches, so no serious news, but there are two problems: <br><blockquote><ul><li>  chances are that you will not be able to authenticate to the Wallet after choosing a card; <br></li><li>  chances are that you will not be able to purchase a prepaid plan using a mobile network. <br></li></ul><br></blockquote><br>  And Apple News is now available in Canada. <br><br>  Do not switch. <br><br><h1>  macOS Mojave 10.14.4 beta </h1><br>  The only update here is a possible issue with Safari 12.1 after upgrading from Safari 10.1.2. <br><blockquote>  After upgrading to Safari 12.1 from Safari 10.1.2, web pages may not display correctly.  (47335741) </blockquote><br>  Workaround: enter the command <code>defaults delete com.apple.Safari</code> in the terminal.  Please note that you lose all past Safari settings. <br><br><h1>  Finally </h1><br>  The article came out much more voluminous than I expected.  All my findings you will find above.  And if in short - Swift 5 has come! <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/437814/">https://habr.com/ru/post/437814/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>