<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of Minor Violations Java code on the Duerank.com platform (part 1)</title>
  <meta name="description" content="Introduction 
 What do we know about errors in the code of applications written in Java? Well, we probably know that they meet there. And how often do...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Analysis of Minor Violations Java code on the Duerank.com platform (part 1)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/b0/ia/ky/b0iakyehtumovq4msaukb_i0s6s.png"><br><br><h3>  Introduction </h3><br>  What do we know about errors in the code of applications written in Java?  Well, we probably know that they meet there.  And how often do they meet?  How many different things does a developer make in his code?  By bugs we mean not only bugs, but also the presence of various code smell, vulnerabilities, violations.  Can this all be measured?  Is it possible to determine the quality of the repository code, the developers and the product as a whole on the basis of these measurements?  Is it possible in this way to compare the quality of the code of different developers and choose a stronger partner?  Is it possible to get a salary increase by showing an increase in the quality of your code and a decrease in the level of your technical debt?  The task of the team is precisely to answer all these questions in the affirmative. <br><br>  In this paper, we will look at Minor Violations in Java code that can potentially affect developer productivity like: <br><br><ul><li>  failure to use code convention; </li><li>  The finalizer does nothing other than calling the finalizer of the superclass; </li><li>  too long lines; </li><li>  switch must have at least 3 options, etc. </li></ul><br><h3>  Beginning of work </h3><br>  Our research is based on an analysis of the quality indicators of source code written in Java and obtained from the open source GitHub repositories.  The results of the study were compiled into one large csv file, and the analysis of the obtained data was carried out using the already de facto standard stack: scipy, numpy, pandas, matplotlib. <br><a name="habracut"></a><br>  Standard import of required tools: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> statsmodels.api <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sm</code> </pre> <br>  We read the data from the csv-file, discard all the lines that contain incomplete data, select for further analysis all data related to the Java language and display some preliminary statistics to find out what the data is: <br><br><pre> <code class="python hljs">df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'ScanGitHub.csv'</span></span>) df = df.dropna() df_Java = df[df[<span class="hljs-string"><span class="hljs-string">'Repository Language'</span></span>] == <span class="hljs-string"><span class="hljs-string">'Java'</span></span>] print(np.sum(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>])) df_Java[[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>]].describe()</code> </pre><br>  As a result, we obtained that there are 276,015,051 lines of code in the 60,959 scanned repositories.  On average, one repository contains 4528 lines of code and 150 Minor Violations: <br><br><img src="https://habrastorage.org/webt/op/ir/wa/opirwaxwlozfds4gpxae8af5by8.png"><br><br>  Interestingly, 50% of all repositories scanned by us are quite small - the number of lines of code is 711, and the number of Minor Violations is 22. <br><br>  But these figures are quite uninformative, as well as the average temperature in the ward.  Further study needed. <br><br>  Let's see how repositories are distributed by the number of lines of code: <br><br><pre> <code class="python hljs">f, ax = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>) ax.hist(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>], color=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, bins=<span class="hljs-number"><span class="hljs-number">100</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, rwidth=<span class="hljs-number"><span class="hljs-number">0.85</span></span>, label=<span class="hljs-string"><span class="hljs-string">'SLOC distribution'</span></span>) ax.grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">'SLOC'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'# of repositories'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>].describe()</code> </pre><br><img src="https://habrastorage.org/webt/l6/fc/gk/l6fcgkksp5fr4ktloyovcvzx4ne.png"><br><br>  Those who expected to see a normal distribution here, I think, were disappointed.  But that his here can not be, we suggested the previous sign!  How can this result be explained?  A very large number of projects has a relatively very small number of lines of code, since mostly individual projects and small open-source collaborations are laid out in open access on GitHub. <br><br>  To reduce the scale along the axes, different techniques are used, but in this case it will be convenient to log the number of lines of code.  Let's see what happens: <br><br><img src="https://habrastorage.org/webt/ee/ws/kq/eewskqdvdrohvvv-6uozl0m8pto.png"><br><br>  Indeed, after logarithm, our distribution is more like a normal one.  There is a small anomaly in the region of 2-3 (which corresponds to ~ 7-20 lines of code), apparently, with a large number of HelloWorld projects. <br><br>  Now we study the distribution of Minor Violations. <br><br><img src="https://habrastorage.org/webt/cf/35/z8/cf35z8eh2clfqyraut2nl9fiq0k.png"><br><br>  Something similar to what happened when the number of lines of code in the repository was distributed?  Indeed, it would be naive to believe that Minor Violations would be distributed differently, assuming that the average number of Minor Violations per line of code is a constant value. <br><br>  Let's do the logarithm trick again: <br><br><img src="https://habrastorage.org/webt/vu/ue/wu/vuuewu4mpcfhetbavwgb2zdremy.png"><br><br>  And again we get the distortion of the distribution in the region of small Minor Violations values, corresponding to small values ‚Äã‚Äãof the number of lines of code. <br><br>  We filter the data by the number of lines of code and see what happens (why we filter by the number of lines of code&gt; 1000 will be clear below): <br><br><pre> <code class="python hljs">sample = df_Java[(df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>]&gt;<span class="hljs-number"><span class="hljs-number">1000</span></span>)][<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>] ax.hist(np.log(sample), color=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, bins=<span class="hljs-number"><span class="hljs-number">25</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, rwidth=<span class="hljs-number"><span class="hljs-number">0.85</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Minor Violations distribution\nSLOC &gt; 1000'</span></span>) ax.grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">'log of Minor Violations'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'# of repositories'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/8u/z3/ct/8uz3ct9svjqblnma5mwk9xnqgui.png"><br><br>  Here, another thing!  As can be seen from the graph, our hypothesis about the distortion of the distribution of data corresponding to the repositories with a small (up to 1000) number of lines of code, was confirmed. <br><br><h3>  Finding the relationship between SLOC and Minor Violations </h3><br>  We now proceed to the study of the correlation between the number of lines of code and Minor Violations and try to answer the sacred question: what happens to the quality of the code if its volume increases. <br><br><pre> <code class="python hljs">ax.scatter(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>], df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>], c=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.30</span></span>, edgecolors=<span class="hljs-string"><span class="hljs-string">'none'</span></span>, marker=<span class="hljs-string"><span class="hljs-string">'.'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Java'</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">'SLOC'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  And-and-and-and ... This is probably not what we expected to see again! <br><br><img src="https://habrastorage.org/webt/ns/-h/jp/ns-hjpz6bgxjkulj9vjjijdvytc.png"><br><br>  Most of the data is in the range of 0-500000 lines of code and 0-2000 Minor Violations.  Increase this area and see what is there. <br><br><pre> <code class="python hljs">ax.scatter(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>], df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>], c=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.30</span></span>, edgecolors=<span class="hljs-string"><span class="hljs-string">'none'</span></span>, marker=<span class="hljs-string"><span class="hljs-string">'.'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Java'</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">'SLOC'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ax.set_xlim(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50000</span></span>) ax.set_ylim(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/oa/ch/fn/oachfnymb-fzo2adfalymdb0tso.png"><br><br>  It is difficult to say if there is any correlation between the number of lines of code and the number of Minor Violations in the repository.  In order to reveal this correlation, it is necessary to linearize this dependence, to carry out feature engineering. <br><br>  To successfully carry out feature engineering, first of all, it is necessary to investigate changes in the shape of the distribution of the number of lines of code as Minor Violations increases, as well as changes in the form of the distribution of Minor Violations as the number of lines of repository code increases. <br><br>  Consider how the form of the distribution of Minor Violations changes with increasing number of lines of code in the repository: <br><br><pre> <code class="python hljs">f, ax = plt.subplots(nrows=<span class="hljs-number"><span class="hljs-number">5</span></span>, ncols=<span class="hljs-number"><span class="hljs-number">2</span></span>) f.set_figwidth(<span class="hljs-number"><span class="hljs-number">10</span></span>) f.set_figheight(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>): low_lim = <span class="hljs-number"><span class="hljs-number">5000</span></span> * i - <span class="hljs-number"><span class="hljs-number">1000</span></span> up_lim = <span class="hljs-number"><span class="hljs-number">5000</span></span> * i + <span class="hljs-number"><span class="hljs-number">1000</span></span> _df_Java = df_Java[(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>] &gt; low_lim) &amp; (df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>] &lt; up_lim)] ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].hist(_df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>], color=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, bins=<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, rwidth=<span class="hljs-number"><span class="hljs-number">0.85</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Minor Violations distribution\n({} &lt; SLOC &lt; {})'</span></span>.format(<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> low_lim &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> low_lim, up_lim)) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].set_xlabel(<span class="hljs-string"><span class="hljs-string">'# of Minor Violations'</span></span>) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].set_ylabel(<span class="hljs-string"><span class="hljs-string">'# of repositories'</span></span>) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) f.savefig(<span class="hljs-string"><span class="hljs-string">'fig.png'</span></span>)</code> </pre> <br>  In this case, we see that all distributions are not normal and are similar to exponential, lognormal, gamma distribution, or the like.  From the graphs it can be seen that the higher the number of rows in the repository, the more sparse the data become, that is, repositories with a large number of lines of code are less common.  That is consistent with the data obtained by us earlier. <br><br><img src="https://habrastorage.org/webt/hi/il/kd/hiilkdtt-sgphw84ndhg6kk8obs.png"><br><br>  Similarly, we investigate changes in the distribution structure of lines of code as the number of Minor Violations increases: <br><br><pre> <code class="python hljs">f, ax = plt.subplots(nrows=<span class="hljs-number"><span class="hljs-number">5</span></span>, ncols=<span class="hljs-number"><span class="hljs-number">2</span></span>) f.set_figwidth(<span class="hljs-number"><span class="hljs-number">10</span></span>) f.set_figheight(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>): low_lim = <span class="hljs-number"><span class="hljs-number">500</span></span> * i - <span class="hljs-number"><span class="hljs-number">100</span></span> up_lim = <span class="hljs-number"><span class="hljs-number">500</span></span> * i + <span class="hljs-number"><span class="hljs-number">100</span></span> _df_Java = df_Java[(df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>] &gt; low_lim) &amp; (df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>] &lt; up_lim)] ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].hist(_df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>], color=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, bins=<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i &lt; <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, rwidth=<span class="hljs-number"><span class="hljs-number">0.85</span></span>, label=<span class="hljs-string"><span class="hljs-string">'SLOC distribution\n({} &lt; Minor Violations &lt; {})'</span></span>.format(<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> low_lim &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> low_lim, up_lim)) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].set_xlabel(<span class="hljs-string"><span class="hljs-string">'# of SLOC'</span></span>) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].set_ylabel(<span class="hljs-string"><span class="hljs-string">'# of repositories'</span></span>) ax[i//<span class="hljs-number"><span class="hljs-number">2</span></span>][i%<span class="hljs-number"><span class="hljs-number">2</span></span>].legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) f.savefig(<span class="hljs-string"><span class="hljs-string">'fig.png'</span></span>)</code> </pre><br><img src="https://habrastorage.org/webt/lw/po/v2/lwpov2jrrqjkseuknizcruj-vl0.png"><br><br>  From the graphs it can be seen that the distribution of the number of lines of code in the repository differs from the normal one and is very similar to what we saw in the case of the Minor Violation distribution. <br>  To successfully linearize the data, it is necessary to more accurately determine the type of distribution of our data.  To do this, use the two-sided Kolmogorov-Smirnov test.  Here is an example of how this is done for Minor Violations in the case when 14000 &lt;SLOC &lt;16000: <br><br><pre> <code class="python hljs">low_lim = <span class="hljs-number"><span class="hljs-number">14000</span></span> up_lim = <span class="hljs-number"><span class="hljs-number">16000</span></span> sample = df_Java[(df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>] &gt; low_lim) &amp; (df_Java[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>] &lt; up_lim)][<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>] res = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cdf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cdfs: parameters = eval(<span class="hljs-string"><span class="hljs-string">"stats."</span></span>+cdf+<span class="hljs-string"><span class="hljs-string">".fit(sample)"</span></span>) D, p = scipy.stats.kstest(sample, cdf, args=parameters) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> p &gt; <span class="hljs-number"><span class="hljs-number">0.05</span></span>: res.append({<span class="hljs-string"><span class="hljs-string">'stat'</span></span>:cdf, <span class="hljs-string"><span class="hljs-string">'p'</span></span>:p, <span class="hljs-string"><span class="hljs-string">'D'</span></span>:D}) res = sorted(res, key=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> k: k[<span class="hljs-string"><span class="hljs-string">'p'</span></span>], reverse=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> res: print(i) {<span class="hljs-string"><span class="hljs-string">'stat'</span></span>: <span class="hljs-string"><span class="hljs-string">'johnsonsb'</span></span>, <span class="hljs-string"><span class="hljs-string">'p'</span></span>: <span class="hljs-number"><span class="hljs-number">0.6921277394819424</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>: <span class="hljs-number"><span class="hljs-number">0.03522119052695105</span></span>} {<span class="hljs-string"><span class="hljs-string">'stat'</span></span>: <span class="hljs-string"><span class="hljs-string">'exponweib'</span></span>, <span class="hljs-string"><span class="hljs-string">'p'</span></span>: <span class="hljs-number"><span class="hljs-number">0.6661261317167249</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>: <span class="hljs-number"><span class="hljs-number">0.03630428488021764</span></span>} {<span class="hljs-string"><span class="hljs-string">'stat'</span></span>: <span class="hljs-string"><span class="hljs-string">'invgauss'</span></span>, <span class="hljs-string"><span class="hljs-string">'p'</span></span>: <span class="hljs-number"><span class="hljs-number">0.6152804218017391</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>: <span class="hljs-number"><span class="hljs-number">0.037606319965134194</span></span>} {<span class="hljs-string"><span class="hljs-string">'stat'</span></span>: <span class="hljs-string"><span class="hljs-string">'johnsonsu'</span></span>, <span class="hljs-string"><span class="hljs-string">'p'</span></span>: <span class="hljs-number"><span class="hljs-number">0.5647176954088229</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>: <span class="hljs-number"><span class="hljs-number">0.03896411311280057</span></span>} {<span class="hljs-string"><span class="hljs-string">'stat'</span></span>: <span class="hljs-string"><span class="hljs-string">'gengamma'</span></span>, <span class="hljs-string"><span class="hljs-string">'p'</span></span>: <span class="hljs-number"><span class="hljs-number">0.5472142592213745</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>: <span class="hljs-number"><span class="hljs-number">0.039451029797039294</span></span>} {<span class="hljs-string"><span class="hljs-string">'stat'</span></span>: <span class="hljs-string"><span class="hljs-string">'f'</span></span>, <span class="hljs-string"><span class="hljs-string">'p'</span></span>: <span class="hljs-number"><span class="hljs-number">0.4677860605493356</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>: <span class="hljs-number"><span class="hljs-number">0.04179264343902089</span></span>}</code> </pre><br>  Having done such actions for various groups of Minor Violations, we saw that it was Johnson's SU-distribution that was most often the one with the highest p-value sum.  Since Johnson's SU-distribution is basically exponential in nature, the logarithm method already used here is a logical way to linearize our data. <br><br><pre> <code class="python hljs">fig, ax = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>) sample = df_Java[df_Java[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>] ax.scatter(np.log(sample[<span class="hljs-string"><span class="hljs-string">'Lines Of Code'</span></span>]), np.log(sample[<span class="hljs-string"><span class="hljs-string">'Minor Violations'</span></span>]), c=<span class="hljs-string"><span class="hljs-string">'#00ab6c'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.30</span></span>, edgecolors=<span class="hljs-string"><span class="hljs-string">'none'</span></span>, marker=<span class="hljs-string"><span class="hljs-string">'.'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Linearization of $MV = f(SLOC)$'</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">'log of SLOC'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'log of Minor Violations'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.grid(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/wi/zf/sm/wizfsmmvdhwufhmtewgzkjrpqnm.png"><br><br>  That's so much better!  In logarithmic coordinates, a linear relationship between the number of lines of code and Minor Violations clearly appears: that is, there is a correlation between them!  And this means that you can build a code quality model, the argument of which is the number of lines of the source code of the repository / project / developer / company, etc. <br>  We study the structure of the distribution of Minor Violations, but in logarithmic coordinates.  This will help us understand the density distribution of the number of vulnerabilities from the logarithm of the number of lines of code: <br><br><img src="https://habrastorage.org/webt/7d/vk/jo/7dvkjoc5v7lig-iwitesn-jkuce.png"><br><br>  As can be seen from the obtained distribution graphs, the density structure of Minor Violations differs as the size of the repository grows.  Thus, in the case of a small number of lines of code (4 &lt;log (SLOC) &lt;6), a significant amount of repositories has the number of Minor Violation equal to 0 (~ 1900 repositories), and the distribution structure differs from the symmetrical dome-shaped one.  This is due to the fact that there is a restriction on the left, that is, a restriction on the minimum number of lines of code in the repository (obviously, it must be&gt; = 0) on the one hand, as well as a large number of repositories with a small number of lines of code. <br><br>  The distribution structure of the Minor Violation acquires a symmetrical, regular dome-shaped form only from values ‚Äã‚Äãof the number of lines of code in the repository from ~ 1000 (exp (7) ‚âà 1096), therefore from that moment the distribution structure of the Minor Violation ceases to ‚Äúfeel‚Äù the influence of the restriction to the left. <br><br>  Thus, we decided on the range of variation of the argument, and also carried out feature engineering, having obtained the linearization of data in logarithmic coordinates: <br><br><img src="https://habrastorage.org/webt/by/hr/ze/byhrzefcrm95c3_vlna_crasic0.png"><br><br>  Using a linear regression, we obtained a model describing the correlation between the number of lines of code and the number of Minor Violation.  The statistical characteristics of the resulting model are as follows: <br><br>  R2 = 0.516, Fstats = 27510 <br>  And the model itself has the form: <br>  log (MV) = -2.570 + 0.878 log (SLOC), <br>  where MV is the number of Minor Violation, SLOC is the number of lines of code in the repository. <br><br><h3>  Answers to some questions </h3><br>  Why is such a low R2 value obtained?  Because the data have a fairly large variance of the logarithm of Minor Violation for the selected logarithm of the SLOC.  This immediately seemed to us a disadvantage, but then, after reflection, it became clear that this was not a disadvantage, but, on the contrary, an advantage, since it reveals all the data in its diversity.  All this is a good basis for further improvement of the model, as well as the construction of a scale for assessing the quality of the source code, which will make it possible to compare repositories with different amounts of code. <br><br>  How can we interpret the meaning of the line we have built?  This straight line can be interpreted as a certain boundary between the code with a higher quality parameter Minor Violation and a code lower quality. <br><br>  Where is the better code?  A better code is under the straight line shown on the graph.  Thus, although being some basis for further improvement, our model can already be used as a simple ruler for assessing the quality of source code written in Java. <br><br><h3>  Conclusion </h3><br>  The distribution structure of Minor Violation in repositories with source code written in Java has a non-linear nature, and its study opens up the possibility of developing an evaluation system and, accordingly, ranking the quality of the code.  The code quality assessment system developed in our company allows developers and companies to track the ‚Äúhealth‚Äù of the code of their product, as well as to quickly manage its quality. <br><br>  The simplest quality model of the source code developed by us in this work serves as a good base line for its further improvement. <br><br><h3>  PS </h3><br>  In the near future, we are planning to study the quality of the source code for other programming languages ‚Äã‚Äãand quality metrics, as well as the answer to the most sacramental question of all programmers of all times and peoples: which programming language is better.  So stay with us! <br><br>  <b>Posted by:</b> <a href="https://www.linkedin.com/in/yevhen-krasnokutsky-50a053149/">Yevhen Krasnokutsky</a> </div><p>Source: <a href="https://habr.com/ru/post/439996/">https://habr.com/ru/post/439996/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>