<div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/f6/tg/tk/f6tgtkhi__miuivkcydwhvnkdtc.jpeg"><br><br>  Everybody needs Bitrix-parrots, and more.  I work as an administrator in a hosting company and constantly encounter such requests.  Let's get this over with once and for all - in this article you will find the answer to how iron affects the performance of CMS Bitrix (real and “parrot”).  We will conduct tests and select several server configurations. <br><a name="habracut"></a><br>  <b>Objectives of the study:</b> <br><br><ul><li>  Identify the relationship between the characteristics of "iron" and performance indicators Bitrix (parrots), as well as the actual speed of query execution. </li><li>  Determine the dynamics of performance changes from changing the server's hardware configuration. </li><li>  Choose options for server configurations. </li></ul><br>  <b>Testing conditions:</b> <br><br><ul><li>  CMS "1C-Bitrix: Site Management" version 18.0.4, edition "Standard" in the utf-8 encoding. </li><li>  Debian 9.5 OS from netinstall image. </li><li>  nginx + php-fpm </li><li>  MariaDB 10.1 </li><li>  php 7.0 </li><li>  The settings have been made to correctly pass the “system check”, pstate is disabled, acpi-cpufreq is working in the performance mode. </li><li>  Measurement of the speed of query execution is performed by the utility ab. </li></ul><br><h3>  So, what to feed the parrots? </h3><br>  <b>Technique</b> <br><br>  To identify the dependence of the Bitrix indicators on the performance of the processor and RAM, we use the following configuration: <br><br>  Processor: Intel Core i7-3770K CPU @ 3.50GHz <br>  Memory: Samsung 1600 MHz DDR3 (M378B5273DH0-CH9) <br>  SSD: OCZ-VERTEX4 128Gb MLC <br>  HDD: WD5000AAVS-00ZTB0 <br><br>  This configuration allows you to change the frequency of the processor in a wide range, which means you do not need to replace the CPU many times.  To change the frequency, use the frequency-set utility.  The intel_pstate driver does not control the frequency, so it is disabled. <br><br>  Measurements are carried out in increments of 400 Hz.  In addition to performance indicators Bitrix, measure how many requests the main page can perform the server in one second.  To measure performance when using an HDD disk, a replica of a previously tuned system was created on the HDD and indicators were collected at the maximum frequency. <br><br><h3>  Results: we feed parrots with frequency and speed of requests with cores </h3><br>  These are the graphics I have turned out: <br><br><img src="https://habrastorage.org/webt/bf/fr/gi/bffrgifz8cr6hzlis-xczctj84k.png"><br><br><img src="https://habrastorage.org/webt/9x/_y/bx/9x_ybxjcre1c63bphmlb_trwq5g.png"><br><br><img src="https://habrastorage.org/webt/xi/ou/ep/xiouepgmavrhxc1xwn-bem7v2hg.png"><br><br><img src="https://habrastorage.org/webt/7h/nn/qj/7hnnqj4fymi4clyz104gzzwsvbg.png"><br><br><img src="https://habrastorage.org/webt/z2/za/-5/z2za-5qfbl--wv5l8qtj6pufy4a.png"><br><br>  Under the link <a href="https://1dedic.ru/docs/bitrix_performance.pdf">pdf with all the data in graphs and tables</a> .  Plus, additional data about the dependence of file system and database indicators on the number of cores and processor frequency. <br><br>  According to the data obtained, the following <b>conclusions</b> can be <b>drawn</b> : <br><br><ul><li>  <b>The number of parrots</b> increases with the frequency of the processor and does not depend on the performance of the disk.  With an increase in the number of processor cores, this indicator decreases. </li><li>  <b>The speed of query execution</b> depends on the processor frequency and the number of cores.  We consider this indicator as the most important, since  site performance with a high number of visitors depends on it. </li><li>  <b>The File System metric</b> does not depend on disk performance.  A slight increase in the indicator on the graph - the error.  The rate increases with frequency. </li><li>  The disk performance depends on the <b>“MySQL Database (Write)”</b> , <b>“MySQL Database (Change)”</b> metrics and the <b>speed of http requests</b> . </li><li>  The indicator <b>"MySQL Database (read)"</b> stops increasing after two cores.  The presence of more than two cores is not reflected in the performance test Bitrix. </li><li>  The frequency of the RAM does not affect <b>performance</b> .  We carried out tests, however, there was no change in metrics with changing frequency. </li></ul><br><h3>  We select iron </h3><br>  Considering the data obtained, we will assemble several servers and check their performance.  To confirm or disprove the resulting theory, I took three low-cost configurations with different frequency and number of cores.  And a few more servers, where more kernels. <br><br><ul><li>  E3-1270v6 </li><li>  E5-2620v4 </li><li>  E5-1650v4 </li><li>  E5-2640v4 </li><li>  2xE5-2699 </li></ul><br>  For these servers, the frequency will be set automatically (intel_pstate enabled in performance mode), the table shows the maximum frequency according to the processor specifications. <br><br>  <b>What are we looking for?</b> <br><br><ul><li>  Server for big parrots. </li><li>  Server for a high rate of execution of site requests. </li><li>  Balance between parrots and real performance. </li><li>  Server for faster query execution, for a more loaded project </li><li>  Server for even faster execution of requests, for a high-load project </li></ul><br>  The theory is confirmed ↓ <br><br><img src="https://habrastorage.org/webt/i6/g0/4q/i6g04qnknst2vuknva0ft5ofdwm.jpeg"><br><br><img src="https://habrastorage.org/webt/xk/ba/04/xkba04gfv-ar2zxtlzy4lx0q2rw.png"><br><br>  Performance indicators correspond to the previously identified patterns.  The higher the frequency, the higher the score shows Bitrix.  And if you need a server capable of servicing a large number of visitors, you should choose more cores with the highest base frequency possible. <br><br>  Used in the configuration article with <a href="https://1dedic.ru/">1dedic.ru</a> .  Servers on E5-2640v4 and 2xE5-2699v4 can be <b>ordered at a 10% discount for 2 months</b> - <a href="https://1dedic.ru/contacts">contact the sales department</a> with the code phrase "We need a server for Bitrix, for real performance."  If you pay for the year minus another 10%. </div>