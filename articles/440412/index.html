<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zimbra Collaboration Suite and MS Exchange on the same domain</title>
  <meta name="description" content="Despite the fact that the migration process from MS Exchange to Zimbra with the help of the ZCS Migration Wizard is quite simple and very fast, it wil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Zimbra Collaboration Suite and MS Exchange on the same domain</h1><div class="post__text post__text-html js-mediator-article">  Despite the fact that the migration process from MS Exchange to Zimbra with the help of the ZCS Migration Wizard is quite simple and very fast, it will not be suitable for every enterprise.  Not every company can afford to rush into the pool with its head, suddenly replacing one of the main working tools for another.  Due to various factors, be it a high number of employees or their low technical literacy, many companies are gradually switching from Exchange to Zimbra.  In this regard, IT managers of such enterprises need to support the work of two e-mail systems on the same domain at once, and now we will tell how to achieve this using the example of an enterprise migrating from Exchange to Zimbra. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e98/93d/7d9/e9893d7d9f995c2a24dce02df7fa5d51.png" alt="image"><a name="habracut"></a><br><br>  The initial conditions are fairly typical for Russian enterprises: access to e-mail and collaboration tools is provided by MS Exchange and Active Directory running on separate servers.  As part of cost reduction, it was decided to migrate to the Zimbra Collaboration Suite with the additions of the Zextras Suite.  Such a transition allows the company to significantly reduce the costs associated with licensing and maintaining the mail server.  A one-time transition to a new server obviously created serious risks for the continuity of business processes, in connection with which a decision was taken on a phased transition, in which both mail systems were to function on the same domain name, and the first users to completely switch on the use of Zimbra, were employees of the IT department of the enterprise. <br><br>  Immediately after installing Zimbra, Active Directory was connected to it as external LDAP and GAL, and auto-tuning of users was enabled according to instructions from our previous article.  Now a new user on the Zimbra server is created automatically when you try to log in with login and password from AD.  MS Exchange, working on the domain mail.company.ru, it was decided to leave the main.  It was decided to make Zimbra a secondary mail system and place it on zimbra.company.ru.  With this configuration, it was necessary to: <br><br><ul><li>  Letters from the outside came to Exchange users </li><li>  Letters from the outside came to Zimbra users </li><li>  Exchange users could send emails to other Exchange users. </li><li>  Exchange users could send emails to Zimbra users </li><li>  Exchange users could send letters to the external Internet </li><li>  Zimbra users could send emails to other Zimbra users. </li><li>  Zimbra users could send email to Exchange users </li><li>  Zimbra users could send letters to the external Internet </li></ul><br>  In other words, the IT department was required to ensure the full functioning of both mail systems in order to gradually transfer users from one mail system to another. <br><br>  This task is solved by properly configuring both MS Exchange and Zimbra Collaboration Suite.  So, in MS Exchange you need to configure connectors for sending and receiving e-mail.  The fact is that exactly Exchange will be the primary mail system, which means it will be the one to route emails. <br><br>  The connector for sending mail is configured in the Exchange Administration Center, where you first need to select the <b>Mail flow</b> item and then <b>Send connectors</b> .  There, using the <b>Add</b> button, you need to start creating a new connector.  There, in the <b>Network settings</b> section, set the <b>‚ÄúForward mail through intermediate nodes‚Äù</b> option and specify the ip-address of your Zimbra server.  In the <b>Address space</b> field, you must specify the local subdomain on which Zimbra works (in our case, this is zimbra.company.ru).  The final step is to specify the address of the Exchange server in the <b>Source Server</b> field. <br><br>  Connector to receive mail is configured in a similar way.  In the <b>Remote network settings</b> field, you must specify the address of the Zimbra MTA server, and then in the settings of the already created connector, you must set the <b>Authentication mechanism</b> - <b>External protection</b> .  In addition, in the <b>Permission groups</b> field, checkbox <b>Anonymous users</b> and <b>Exchange servers</b> . <br><br>  After all the connectors are configured, it's time to associate Zimbra users with accounts in AD.  This is done using the following command in PowerShell: <b>Enable-MailUser -Identity 'admin@company.ru' -Alias ‚Äã‚Äã'admin' -ExternalEmailAddress 'SMTP: admin@zimbra.company.ru' -PrimarySMTPAddress 'admin@zimbra.company.ru'</b> .  A similar account binding must be made for each user migrating from Exchange to Zimbra.  Mailbox contents and other account data were transferred from Exchange to Zimbra using the ZCS Migration Wizard. <br><br>  After all the settings on the Exchange side have been completed, you should proceed to the settings on the Zimbra side.  It is assumed that the Zimbra MTA will accept all emails that are addressed to accounts hosted on the Zimbra server, but redirect to the main mail server those emails that are addressed to accounts hosted on MS Exchange.  To do this, you need to enter three commands: <br><br><blockquote>  zmprov md company.ru zimbraMailCatchAllAddress <a href="https://habr.com/ru/users/company/" class="user_link">company</a> .ru <br>  zmprov md company.ru zimbraMailCatchAllForwardingAddress <a href="https://habr.com/ru/users/company/" class="user_link">company</a> .ru <br>  zmprov md company.ru zimbraMailTransport smtp: mail.company.ru: 25 </blockquote><br>  After that, we just have to disable DNS detection and redirect all mail from Zimbra through the main mail system.  This can be achieved by entering the commands: <br><br><blockquote>  zmprov mcf zimbraMtaRelayHost mail.company.ru:25 <br>  zmprov mcf zimbraMtaDnsLookupsEnabled FALSE </blockquote><br>  After entering these commands, it is important not to forget to restart Postfix using the postfix stop and postfix start commands for the changes to take effect.  Now you just have to create a binding for each new account on the Zimbra server, that it could receive mail from the Exchange server.  This is done with the help of a command like <b>zmprov aaa admin@company.ru admin@zimbra.company.ru</b> <br><br>  After both email servers were set up for peaceful coexistence, the IT department of the company needed only to gradually transfer accounts from Exchange to Zimbra.  Due to the fact that Zimbra and Exchange business calendars are incompatible with each other, migration to the new mail system was done at once by entire departments, because the situation in which some department employees work in one calendar, and some in another, creates significant risks for business.  That is why, for moral preparation of employees for migration, a small memo and training video was released on where in Zimbra are the functions most in demand by the employees of the enterprise. <br><br>  After the migration was successfully completed, the server with MS Exchange was disconnected, it became necessary for the enterprise to make the Zimbra Collaboration Suite the only mail system.  In order to accomplish this, it was enough for only five teams: <br><br><blockquote>  zmprov md domain.com zimbraMailCatchAllAddress <br>  zmprov md domain.com zimbraMailCatchAllForwardingAddress <br>  zmprov md domain.com zimbraMailTransport smtp: mail.company.ru: 25 <br>  zmprov mcf zimbraMtaRelayHost <br>  zmprov mcf zimbraMtaDnsLookupsEnabled TRUE </blockquote><br>  After restarting Postfix, all incoming messages will be sent directly to Zimbra, and outgoing mail will also be sent from Zimbra.  At the same time, thanks to the zimlet of Zextras Mobile, email and calendars are available to employees both on mobile devices and in their usual MS Outlook. </div><p>Source: <a href="https://habr.com/ru/post/440412/">https://habr.com/ru/post/440412/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>