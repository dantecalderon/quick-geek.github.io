<div class="post__text post__text-html js-mediator-article">  <i>Fear your desires, they can be fulfilled.</i> <br>  Popular wisdom. <br><br>  <i>One couple wished to get married and find eternal happiness.</i>  <i>I blew up their car at the church right after the wedding.</i> <br>  One Wish Grant, movie Route 60. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/880/d74/b29/880d74b2944ff10e50b5a6430d4e034b.jpg" alt="image"><br><br>  Another philosophical note about management, and in this case quality, consists of three parts: a very abstract, moderately abstract, concrete and separate conclusion.  Contains criticism of the existing practice of applying linters. <br><a name="habracut"></a><br><h3>  A very abstract part about quality </h3><br>  First, I want to talk about quality, or rather, about quality management of anything, about a product in the broadest sense, a product as a result of human activity, whether it is creating a new (writing code or a picture, designing a spaceship), cutting off the excess (sculpture , milling, selection of good fruits), or transformation (transportation, freezing, packaging, making gasoline and plastic from gas). <br><br>  A good product has some signs that it is of high quality.  Different products have different signs.  For example, good fruit smells good, looks good, tastes good. <br><br>  Now I will give a hyperbolized example, and later I will go directly to the code. <br><br>  Imagine that we have a fruit shop and there is a problem, our fruit has become worse for sale, and a competitor has a queue straight.  We do research and find out that visitors do not like the smell near our stalls.  And the smell from the competitor's shops is like.  Oh, we found a problem, the index of satisfaction with the smell!  Let's decide it, there is aromamarketing, just put the automatic installation near the shelves and get a wonderful smell of apple orchard.  Made.  And the customer satisfaction odor index naturally smelled upwards.  Only now buyers are even less. <br><br>  If you look seriously, the original problem could be completely different: <br><br><ol><li>  Our competitors sell equally high-quality fruits, but they made aromamarketing before us and attracted visitors with the smell. </li><li>  Our fruits are good, but competitor fruits are really better than ours (varieties, storage, whatever) </li><li>  Our fruits are rotten.  They just rot and stink. </li><li>  Fruited fruits from last year that stand behind the window, and we hope that we can still sell them.  And they stink from there. </li><li>  The competitor has more range </li><li>  The competitor has more beautifully laid out his fruit, in general, the same as ours. </li><li>  It's stupid cheaper there </li><li>  There the seller is beautiful, but we have a woman, Manya, who is a substitute ... </li></ol><br>  It is obvious that only in the first case will help us aromamarketing.  In some, he can help, but at the same time he can disguise the real problem, and in the third one either will not take action or cause even more disgust.  And oh, how often the problem is that the fruit is rotten. <br><br>  In fact, when such a problem arises, it is necessary to comprehensively analyze the causes and take a case-specific solution in each particular case. <br><br><h4>  Even more hyperbolized </h4><br>  You have green tomatoes, and you know that only red tomatoes are sold.  No need to paint tomatoes.  It is good that <a href="https://habr.com/ru/post/434762/">maturation</a> can be <a href="https://habr.com/ru/post/434762/">accelerated with ethylene</a> .  And it will be a full ripening, not painting.  If it was impossible to accelerate, then it would be necessary to throw out these tomatoes and get new, already good ones. <br><br>  In other words, if you are not satisfied with the quality of the resulting product, then there are problems in the chain of its production and you need to analyze and change the process, and not to paint at the output. <br><br>  Well, you understand.  If something smells bad, perfume will not help. <br><br><h3>  Moderately abstract part about code quality </h3><br>  Among the properties of good code, we find (without sorting by importance): <br><br><ul><li>  consistency of style </li><li>  readability </li><li>  performance, </li><li>  extensibility </li><li>  transparency of architecture and patterns. </li></ul><br>  This is achieved primarily with the help of self-discipline and skill level of developers, as well as, when there are many developers, with the help of the code style agreement and architecture agreements (MVC, MVVM, ECS, thousands of them).  <b>The quality code appeared much earlier than the linters, any agreements and architectural patterns.</b> <br>  Most of the rules of the linters are purely cosmetic and solve the problem of increasing the readability of the code through the uniform use of small and local practices.  The length of the lines is there, the names of the variables, const wherever there is no modification, sometimes even restrictions are imposed on the cyclomatic complexity of functions.  This is not about specific rules, but about the fact that these rules are in general cosmetic, they help the code to <b>look</b> better.  The key word here is <b>look</b> . <br><br>  <b><i>When an indicator begins to be used as a target, it loses its value as a tool.</i></b> <br>  Free interpretation <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BD_%25D0%2593%25D1%2583%25D0%25B4%25D1%2585%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0">of Goodhart's law</a> . <br><br>  Now let's draw an analogy with tomatoes.  Ours are not mature enough.  The automatic linter will tell us: “Look, you need to see the wrong color here and here.”  What will the programmer do?  Very often painted.  And therein lies the main idea of ​​my criticism of the linter.  Now I will give a specific example, and then draw a conclusion. <br><br><h3>  Concrete </h3><br>  PixiJS February 2, 2018 (a year ago). <br><br>  <a href="https://github.com/pixijs/pixi.js/pull/4658">A pool of requests arrives</a> .  The point is that previously a constant number of points was used to draw a curve, which is obviously not optimal.  It is proposed to use a clever algorithm to estimate the length of the curve.  The algorithm is not rocket science, but definitely not obvious, published in 2013 and cited <a href="http://malczak.linuxpl.com/blog/quadratic-bezier-curve-length/">with reference to the article of its author</a> (there are problems with https).  The happiness that he was generally preserved on a personal page. <br><br>  It contains C code (16 lines): <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(v* p0, v* p1, v* p2)</span></span></span><span class="hljs-function"> </span></span>{ va,b; ax = p0-&gt;x - <span class="hljs-number"><span class="hljs-number">2</span></span>*p1-&gt;x + p2-&gt;x; ay = p0-&gt;y - <span class="hljs-number"><span class="hljs-number">2</span></span>*p1-&gt;y + p2-&gt;y; bx = <span class="hljs-number"><span class="hljs-number">2</span></span>*p1-&gt;x - <span class="hljs-number"><span class="hljs-number">2</span></span>*p0-&gt;x; by = <span class="hljs-number"><span class="hljs-number">2</span></span>*p1-&gt;y - <span class="hljs-number"><span class="hljs-number">2</span></span>*p0-&gt;y; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> A = <span class="hljs-number"><span class="hljs-number">4</span></span>*(ax*ax + ay*ay); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> B = <span class="hljs-number"><span class="hljs-number">4</span></span>*(ax*bx + ay*by); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> C = bx*bx + by*by; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Sabc = <span class="hljs-number"><span class="hljs-number">2</span></span>*<span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(A+B+C); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> A_2 = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(A); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> A_32 = <span class="hljs-number"><span class="hljs-number">2</span></span>*A*A_2; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> C_2 = <span class="hljs-number"><span class="hljs-number">2</span></span>*<span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(C); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> BA = B/A_2; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( A_32*Sabc + A_2*B*(Sabc-C_2) + (<span class="hljs-number"><span class="hljs-number">4</span></span>*C*AB*B)*<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>( (<span class="hljs-number"><span class="hljs-number">2</span></span>*A_2+BA+Sabc)/(BA+C_2) ) )/(<span class="hljs-number"><span class="hljs-number">4</span></span>*A_32); };</code> </pre> <br>  And the following code (JS) was sent to the request pool: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Calculate length of quadratic curve * @see {@link http://www.malczak.linuxpl.com/blog/quadratic-bezier-curve-length/} * for the detailed explanation of math behind this. * * @private * @param {number} fromX - x-coordinate of curve start point * @param {number} fromY - y-coordinate of curve start point * @param {number} cpX - x-coordinate of curve control point * @param {number} cpY - y-coordinate of curve control point * @param {number} toX - x-coordinate of curve end point * @param {number} toY - y-coordinate of curve end point * @return {number} Length of quadratic curve */</span></span> _quadraticCurveLength(fromX, fromY, cpX, cpY, toX, toY) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ax = fromX - ((<span class="hljs-number"><span class="hljs-number">2.0</span></span> * cpX) + toX); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ay = fromY - ((<span class="hljs-number"><span class="hljs-number">2.0</span></span> * cpY) + toY); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bx = <span class="hljs-number"><span class="hljs-number">2.0</span></span> * ((cpX - <span class="hljs-number"><span class="hljs-number">2.0</span></span>) * fromX); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> by = <span class="hljs-number"><span class="hljs-number">2.0</span></span> * ((cpY - <span class="hljs-number"><span class="hljs-number">2.0</span></span>) * fromY); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">4.0</span></span> * ((ax * ax) + (ay * ay)); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-number"><span class="hljs-number">4.0</span></span> * ((ax * bx) + (ay * by)); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c = (bx * bx) + (by * by); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> s = <span class="hljs-number"><span class="hljs-number">2.0</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(a + b + c); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a2 = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(a); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a32 = <span class="hljs-number"><span class="hljs-number">2.0</span></span> * a * a2; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c2 = <span class="hljs-number"><span class="hljs-number">2.0</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(c); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ba = b / a2; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (a32 * s) + (a2 * b * (s - c2)) + ( ((<span class="hljs-number"><span class="hljs-number">4.0</span></span> * c * a) - (b * b)) * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.log(((<span class="hljs-number"><span class="hljs-number">2.0</span></span> * a2) + ba + s) / (ba + c2)) ) ) / (<span class="hljs-number"><span class="hljs-number">4.0</span></span> * a32); }</code> </pre> <br>  The code is designed in full accordance with the settings of the linter.  There are descriptions of all parameters, a link to the original algorithm, a bunch of const, in accordance with the no-mixed-operators linter requirement: 1 are placed in parentheses.  Even for performance, api is made not with an object, but with separate parameters, so it is really usually better in JS. <br>  There is one problem.  This code does complete garbage.  (An attempt to calculate in Russian the expression fucked up, which is fully used in Western publications to express the degree of the problem and seems to be appropriate). <br><br><div class="spoiler">  <b class="spoiler_title">That's what the linter said when he looked at this code without brackets.</b> <div class="spoiler_text"> <code>c:\rep\pixi\pixi.js\src\core\graphics\Graphics.js <br> 258:26 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 258:32 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 259:26 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 259:32 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 260:24 warning Unexpected mix of '*' and '-' no-mixed-operators <br> 260:30 warning Unexpected mix of '*' and '-' no-mixed-operators <br> 260:30 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 260:36 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 261:24 warning Unexpected mix of '*' and '-' no-mixed-operators <br> 261:30 warning Unexpected mix of '*' and '-' no-mixed-operators <br> 261:30 warning Unexpected mix of '-' and '*' no-mixed-operators <br> 261:36 warning Unexpected mix of '-' and '*' no-mixed-operators</code> <br> </div></div><br>  A huge length is returned, and many points are allocated to it, it’s good that there was a restriction from above, and according to it it worked.  Previously, this mode was disabled by default, but then turned on for everyone (because of another bug, by the way).  <a href="https://github.com/pixijs/pixi.js/pull/5442">Fix already by the way</a> .  I did not contact the author of the commit and did not ask him why he decided to put the brackets, but I feel that he launched the linter, the configuration file of which is already in PixiJS.  This linter told him, your code is bad, because there are not enough brackets in it, add brackets.  The option "no-mixed-operators" says that you have no right to write <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">2</span></span>*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">2</span></span>*<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  because it can lead to poor readability.  Someone created this option, then someone included it in the project, which suggests that many people consider it useful. <br><br><h3>  Conclusion </h3><br>  I do not want to say that the linters are evil, but I consider them to be such an application.  We (in the sense of humanity) were able to automate the detection of only a small part of the signs of good code, mainly cosmetics like the placed brackets.  Linters are good as tools for analyzing code quality, but as soon as we put the requirements of the linter in the framework of the mandatory requirements, we get this same requirements.  We do not acquire anything except compliance with the requirements.  It’s like putting a camera on an envelope with tomatoes and sending it in for painting all that are not red enough.  While we did not give the developer a tool for assessing the quality of the appearance of the code, he could send bad code, and we could see it.  <b>Now the bad code will be better disguised.</b>  <b>It will mimic a good one, because all the external signs of a good code are on it.</b>  <b>And we will lose the linter as an assessment tool, because the whole code corresponds.</b>  We had an assessment tool, but now it is not there, but the code with parentheses, though not there sometimes, but these are details.  Total linter <b>I think a cool tool, but only if compliance with the requirements does not become the goal</b> . <br><br>  And yes, here we can say that there are no tests, that you do not need copy-paste code, that it is stackOverflow development, that you don’t insert code that you don’t understand.  This is all yes.  And this is a sign of bad code.  But linter helped make it look visually similar to everything else in the project.  But a linter will never check if you understood what you wrote. <br><br>  In other words, I think that the correct use of a linter is to regularly launch it on a project with a lead and an assessment of how and what goes.  Well, the rules of the type more brackets to God brackets, in principle, I consider harmful.  When we see that someone commits a code of poor quality, then it is worth understanding why he does it and solve this problem at a deeper level.  Naturally formatting the code with your hands is not necessary, I in every possible way welcome autoformers, but as long as they don’t touch the semantic part of the code in any way.  If we use a linter to force a person to bring the code to the standards, then we will essentially color the green tomato red.  And it will be even harder to understand that it is actually green.  What to do in open projects with a bunch of different people, the question is more complicated, but even here you can think what to do. <br><br>  It should be said that my attitude towards the linter was formed long ago, more than three years ago, but I could not find a suitable example in practice when the linter played a cruel joke.  And so I found him.  The fact that I’ve been looking for him for so long says that the problem is not so big, or how difficult it is to notice the negative effect, but I think this note will be useful.  Remember, a linter is a tool, and as any tool it can be used to harm and to the good, and as with any tool you can sometimes cut yourself. </div>