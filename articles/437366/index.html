<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to hack a factory: radio control systems as a weak link in modern production</title>
  <meta name="description" content="Trend Micro released a study that examined the vulnerabilities of the radio remote control system for industrial equipment and how easily attackers co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>How to hack a factory: radio control systems as a weak link in modern production</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/rn/-o/-e/rn-o-ee3r4fl3ry41hlqffdu5to.jpeg"><br><br>  <i><i>Trend Micro released a study that examined the vulnerabilities of the radio remote control system for industrial equipment and how easily attackers could use them to attack industrial facilities.</i></i> <i><br></i> <br>  Recently, we (Trend Micro specialists) published the results of another study, which this time concerns remote radio control systems used for working with industrial equipment.  In the course of the study, we tested equipment from seven major vendors to find vulnerabilities in its protection systems, and ways that criminals can take advantage of, wanting to take control of this equipment.  And found, which is typical, and vulnerabilities, and ways.  They can potentially be used to sabotage production, theft, and even blackmail. <br><a name="habracut"></a><br><h3>  Protection VS Attack: Vulnerability Analysis </h3><br>  For our research we used equipment samples from seven of the most popular global manufacturers of radio control systems, including Saga, Circuit Design, Juuko, Autec, Hetronic, Elca and Telecrane.  Saga and Juuko equipment was researched in the laboratory to better study the protocols used, and the hacking of the control systems of the other five vendors was carried out directly in the field.  The search for vulnerabilities was conducted in five main areas: recording / playing commands of the remote control, substitution of commands from the remote control, initiation of emergency shutdown of equipment, replacement of remote control connected to the system and reprogramming of equipment. <br><br><img src="https://habrastorage.org/webt/04/lu/ro/04luro-fhdvbugdxzisrz9xycdy.jpeg"><br>  <i>Results of research.</i>  <i>The status N / A means that the device in principle does not support the tested functions (for example, the function of emergency shutdown).</i> <br><br>  The studies also revealed the main weaknesses in the data transmission protocols and software used, including the absence of a changing code (ie, any once intercepted data packet can be used in the future), the complete absence or weak cryptographic data protection (transmitted between the receiver and transmitter the command sequence can be easily deciphered), and the lack of software protection methods (the software for flashing transmitters and receivers is in no way protected from being used by attackers in their  x goals). <br><br>  At the same time, it is worth noting that developing ‚Äúpatches‚Äù for all three problems is extremely simple, but they can be implemented quickly and efficiently only for software that supports the addition of an access control system.  In other cases, the obstacle will be a huge amount of used equipment, the lack of convenient access to the necessary components and the fact that part of it is so outdated that it does not support the necessary functions at the hardware level, for example, encryption. <br><br><img src="https://habrastorage.org/webt/pu/jx/lf/pujxlfvnpbpngf6g8xefu3a7kna.jpeg"><br>  <i>Examples of equipment used in the research</i> <br><br><h3>  Record / play commands </h3><br>  To test the system for this vulnerability, we recorded the "traces" of the "Start" command, clicking on various buttons on the remote and the device's emergency shutdown commands.  Reproducing them then, they immediately confirmed three important facts: <br><br><ol><li>  there are no defensive mechanisms in the system, such as a changing code, since the signals recorded earlier were perceived by the receivers as original; </li><li>  an attacker may well enable a disabled device using these signals; </li><li>  the command to initiate an emergency shutdown is encoded in such a way that it can easily be used as a separate type of attack. </li></ol><br>  During the attacks, various SDR devices were used, including Ettus USRP N210, BladeRF x115, and HackRF.  As a result, we came to the conclusion that practically any device of this type of sufficient power, equipped with a transmitting antenna, is suitable for such attacks.  Ettus USRP N210 was used in conjunction with GNU Radio, and special scripts were written for the BladeRF x115. <br><br><img src="https://habrastorage.org/webt/gj/jb/ad/gjjbaddih0drc5pmix1k1icgqwa.png"><br>  <i>GNU Radio scripts and diagram written to record and play commands</i> <br><br>  In all tests that were conducted both in the laboratory and in the field, the command recording / reproduction scheme worked without additional settings or modifications, which confirms the simplicity of such attacks and the almost complete insecurity of the equipment used. <br><br><h3>  Command substitution </h3><br>  To use this type of attack, it is necessary to decipher the protocols used by remote control systems, both at the software level and at the transmitter hardware level.  As for the attack using recording / replaying, they wrote down the main commands that are used to control devices, but this time the goal was to record all possible combinations of button presses, including short and long presses. <br><br><img src="https://habrastorage.org/webt/un/m9/se/unm9sejppbe8kxpmhe2rcmz0udc.png"><br>  <i>Diagnostic analyzer connected to a radio transmitter to decrypt data</i> <br><br>  This was necessary in order to begin to understand the demodulation schemes used in various remote controls.  For the same purpose, we studied all the available documentation and used the Universal Radio Hacker application to study the form of radio signals.  After that, we developed scripts to conduct an attack, and working with Juuko devices even led to the creation of a special hardware module for hacking, which we called RFQuack. <br><br><h3>  Trigger Disable </h3><br>  In fact, initiation of an emergency shutdown is a logical continuation of the first two types of attacks.  For its implementation, the remote control used by hackers constantly sends packets to the equipment that are responsible for the restart or emergency shutdown commands.  Moreover, even with the original remote control, which other teams give to the equipment at that moment, these packages were still processed during the tests and led to the device shutting down / rebooting.  This method can easily be used to sabotage or extortion, completely paralyzing the work of individual pieces of equipment or its mass shutdown. <br><br><h3>  Substitution remote control </h3><br>  In both tested devices (Saga and Juuko), to test this vector of attack, it was first necessary to activate the pairing function, which is disabled by default.  After that, it was necessary to turn on the receiver and press on certain buttons on the remote control.  We intercepted the signals transmitted by the pairing process using BladeRF and replayed them, after which the receiver stopped receiving commands from the original remote control, taking the new signal source as the main one. <br><br>  At the same time, the protocol itself used in the pairing process is not protected from hacking in any way and is not much different from the usual commands transmitted from the remote control to the receiver.  Moreover, due to the vulnerability of the data transfer protocol for pairing, a similar method worked even with Juuko devices, although in them you need to press a special button on the equipment to complete the pairing.  Subsequently, with the help of this method, attackers will be able to initiate mass DoS attacks on equipment and sabotage its operation within the whole plant or automated dock / warehouse. <br><br><h3>  Reprogramming </h3><br>  To check this attack vector, a copy of the firmware was used and, if necessary, a special dongle was used.  Samples Juuko and Saga thus managed to reprogram in the laboratory, and for the equipment Telecrane the possibility of reprogramming was confirmed at a theoretical level, based on the technical documentation of the device. <br><br><img src="https://habrastorage.org/webt/nu/sf/pv/nusfpvp4av8re4ptf2xd-ozh_hi.png"><br>  <i>Software interface for flashing Saga devices</i> <br><br>  In all three cases, it was found that the software for working with firmware devices lacks user authentication mechanisms and protection against third-party interference.  In addition, the software is only designed to work with Windows (and, in some cases, with outdated Windows XP), which remains the most popular OS for distributing malware. <br><br>  In the case of Saga equipment, attackers can also quite easily access BSL passwords and parameters that are recorded in the device‚Äôs flash memory and, accordingly, modify the firmware, extract its files for further study, implement their own malicious code for delayed activation and even initiate a complete erasure of information from memory to hide the traces of their activities.  The only condition for the successful use of this vector of attack is access to a computer, which is used for flashing systems of remote control equipment. <br><br><h3>  findings </h3><br>  The main conclusion that can be drawn from the report ( <a href="https://documents.trendmicro.com/assets/white_papers/wp-a-security-analysis-of-radio-remote-controllers.pdf">A Security Analysis of Radio Remote Controllers for Industrial Applications</a> ) is that the so-called protection systems of this equipment against malicious attacks do not withstand any criticism, and in some devices are not provided at all.  We believe that the main reasons for the current situation are the long life of this equipment (the life cycle of some of the studied samples ended many years ago), the high cost of replacing it, the complexity of updating the software and the introduction of any new security systems. <br><br>  Industrial systems for remote control of equipment in terms of their level of protection from external influence are far behind such systems in the consumer segment and without major modernization and revision of the manufacturers' approach to this issue, they remain a weak link in the safety of industrial facilities.  As the results of the study showed, taking advantage of existing vulnerabilities is quite simple, so you need to develop a systematic approach to addressing them, including regular release of software updates and firmware, transition of industrial equipment to generally accepted radio standards (Bluetooth Low Energy and 5G), using hardware encryption, and developing unique mechanisms to protect against unauthorized access to the hardware of receivers and transmitters, in order to complicate the task for attackers who want to understand  I'm in their device and use to create my own "tools." </div><p>Source: <a href="https://habr.com/ru/post/437366/">https://habr.com/ru/post/437366/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>