<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Telephone directory of the organization - print version</title>
  <meta name="description" content="I envy my English-speaking colleagues, they don‚Äôt have to reinvent the wheel, they‚Äôre all in the same layout, and nobody calls the other person by the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Telephone directory of the organization - print version</h1><div class="post__text post__text-html js-mediator-article">  I envy my English-speaking colleagues, they don‚Äôt have to reinvent the wheel, they‚Äôre all in the same layout, and nobody calls the other person by their first name, which is very important in our official letters. <br><a name="habracut"></a><br>  Here is a simple task - you need an up-to-date telephone directory of the organization that can be printed out, which contains the full name in Russian and the displayed name in English (as in the postal address book) and has the main contact numbers.  But rarely in any organization you will find a normal solution. <br><br>  Everyone is familiar with the situation when an employee of the reception desk sends by mail a crookedly filled Word file at every personnel change or change by a cell phone employee?  I think many smiled ... <br><br>  <b>I share the solution how to connect the Active Directory directory to SQL Reporting Server.</b> <br><br>  If you have order in AD, skip this step, for the rest I give an example of filling in user fields in AD. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e1b/882/947/e1b8829470159c18a903162f4a5dfdd7.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ca/bd1/0b7/3cabd10b7ea20402cebd1e9de068f95a.png" alt="image"></div><br>  <b>Advantages of such a filling</b> : you can search for a person in other reference books in Russian. <br>  <b>Cons</b> : by the last name in Latin users will not be found. <br><br>  Alternatively, you can use additional attributes of AD for example: middleName or Display-Name-Printable to store the full name or middle name in Russian. <br><br>  <a href="https://www.microsoft.com/ru-RU/download/details.aspx%3Fid%3D53613">Download and run Report Builder</a> <br><br>  Choose Matrix Wizard -&gt; Create a dataset <br>  New Connection Name - AD <br>  Connection Type - OLE DB <br>  In the Credentials tab, select the current user authority <br>  Click the "Build" button <br>  Ole DB Provider choose: OLE DB Provider for Microsoft Directory Services <br><br>  In the server name we fill in any available domain controller, it should turn out like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bb/dc3/559/6bbdc355902d2ce4b7fb9ed24a0c4066.png" alt="image"><br><br>  Next, we make the connection string: <br><br><pre><code class="plaintext hljs">SELECT givenName, SN, telephoneNumber,department, displayName,title, mail, mobile FROM 'LDAP://OU=Users,OU=HOLDING,DC=domain,DC=kz'WHERE objectCategory='user'</code> </pre> <br>  <b>Change your LDAP path to the OU where your users are located</b> <br><br>  Test the connection: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e0/c7c/f67/8e0c7cf67b458473b2998199e2e172c1.png" alt="image"><br><br>  Next, drag all the required fields into the ‚Äúvalues‚Äù of the report: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/336/e6f/1ca/336e6f1ca48146d80d8304d3f07c17fa.png" alt="image"><br><br>  Everything.  Next, format the report as you like.  I, for example, grouped the report by department and adjusted it to A4 size. <br><br>  You can sort and filter data in the query by adding the operator: ORDER BY column1, column2, ... ASC | DESC;  or in the Tablix property <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b6/876/d45/9b6876d4581eae53aaaec491e208e33d.png" alt="image"><br><br>  It remains only to place the report on the Reporting Server and publish it, adding to the end of the URL <br>  keys? rs: embed = true <br><br>  Here is my report: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/424/bbe/e8c/424bbee8cda062cf94831b4be8f62091.png" alt="image"><br><br>  <a href="">Download it here.</a> <br><br>  <b>The advantages of this solution:</b> <br><br>  The reference book can be placed on the SQL Reporting Server, it is now completely free, it can be <a href="https://www.microsoft.com/ru-RU/download/details.aspx%3Fid%3D55252">downloaded separately</a> with the <a href="https://docs.microsoft.com/en-us/sql/reporting-services/reporting-services-features-supported-by-the-editions-of-sql-server-2016%3Fview%3Dsql-server-2017">Express version</a> , or you can place the rdl report on any aspx village on the intranet. <br><br>  Additionally, you get information about AD users and the correctness of filling departments.  Everything is relevant and beautiful, the main thing is to move the dismissed users in time to any other OU. <br><br>  By the way, the user's department number is specified for the correct building of the hierarchy, if you need strict sorting by posts, you can use any additional attribute AD. <br><br>  Fields can be dynamically combined, for example, ‚ÄúFirst Name‚Äù and ‚ÄúLast Name‚Äù in the ‚ÄúFull Name‚Äù field, and quickly customized the reference book for corporate colors. <br><br>  Best regards, Sergei </div><p>Source: <a href="https://habr.com/ru/post/439012/">https://habr.com/ru/post/439012/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>