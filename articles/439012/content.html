<div class="post__text post__text-html js-mediator-article">  I envy my English-speaking colleagues, they don’t have to reinvent the wheel, they’re all in the same layout, and nobody calls the other person by their first name, which is very important in our official letters. <br><a name="habracut"></a><br>  Here is a simple task - you need an up-to-date telephone directory of the organization that can be printed out, which contains the full name in Russian and the displayed name in English (as in the postal address book) and has the main contact numbers.  But rarely in any organization you will find a normal solution. <br><br>  Everyone is familiar with the situation when an employee of the reception desk sends by mail a crookedly filled Word file at every personnel change or change by a cell phone employee?  I think many smiled ... <br><br>  <b>I share the solution how to connect the Active Directory directory to SQL Reporting Server.</b> <br><br>  If you have order in AD, skip this step, for the rest I give an example of filling in user fields in AD. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e1b/882/947/e1b8829470159c18a903162f4a5dfdd7.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ca/bd1/0b7/3cabd10b7ea20402cebd1e9de068f95a.png" alt="image"></div><br>  <b>Advantages of such a filling</b> : you can search for a person in other reference books in Russian. <br>  <b>Cons</b> : by the last name in Latin users will not be found. <br><br>  Alternatively, you can use additional attributes of AD for example: middleName or Display-Name-Printable to store the full name or middle name in Russian. <br><br>  <a href="https://www.microsoft.com/ru-RU/download/details.aspx%3Fid%3D53613">Download and run Report Builder</a> <br><br>  Choose Matrix Wizard -&gt; Create a dataset <br>  New Connection Name - AD <br>  Connection Type - OLE DB <br>  In the Credentials tab, select the current user authority <br>  Click the "Build" button <br>  Ole DB Provider choose: OLE DB Provider for Microsoft Directory Services <br><br>  In the server name we fill in any available domain controller, it should turn out like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bb/dc3/559/6bbdc355902d2ce4b7fb9ed24a0c4066.png" alt="image"><br><br>  Next, we make the connection string: <br><br><pre><code class="plaintext hljs">SELECT givenName, SN, telephoneNumber,department, displayName,title, mail, mobile FROM 'LDAP://OU=Users,OU=HOLDING,DC=domain,DC=kz'WHERE objectCategory='user'</code> </pre> <br>  <b>Change your LDAP path to the OU where your users are located</b> <br><br>  Test the connection: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e0/c7c/f67/8e0c7cf67b458473b2998199e2e172c1.png" alt="image"><br><br>  Next, drag all the required fields into the “values” of the report: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/336/e6f/1ca/336e6f1ca48146d80d8304d3f07c17fa.png" alt="image"><br><br>  Everything.  Next, format the report as you like.  I, for example, grouped the report by department and adjusted it to A4 size. <br><br>  You can sort and filter data in the query by adding the operator: ORDER BY column1, column2, ... ASC | DESC;  or in the Tablix property <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b6/876/d45/9b6876d4581eae53aaaec491e208e33d.png" alt="image"><br><br>  It remains only to place the report on the Reporting Server and publish it, adding to the end of the URL <br>  keys? rs: embed = true <br><br>  Here is my report: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/424/bbe/e8c/424bbee8cda062cf94831b4be8f62091.png" alt="image"><br><br>  <a href="">Download it here.</a> <br><br>  <b>The advantages of this solution:</b> <br><br>  The reference book can be placed on the SQL Reporting Server, it is now completely free, it can be <a href="https://www.microsoft.com/ru-RU/download/details.aspx%3Fid%3D55252">downloaded separately</a> with the <a href="https://docs.microsoft.com/en-us/sql/reporting-services/reporting-services-features-supported-by-the-editions-of-sql-server-2016%3Fview%3Dsql-server-2017">Express version</a> , or you can place the rdl report on any aspx village on the intranet. <br><br>  Additionally, you get information about AD users and the correctness of filling departments.  Everything is relevant and beautiful, the main thing is to move the dismissed users in time to any other OU. <br><br>  By the way, the user's department number is specified for the correct building of the hierarchy, if you need strict sorting by posts, you can use any additional attribute AD. <br><br>  Fields can be dynamically combined, for example, “First Name” and “Last Name” in the “Full Name” field, and quickly customized the reference book for corporate colors. <br><br>  Best regards, Sergei </div>