<div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  Hello dear readers, in today's article I would like to talk about the settings and configuration of gaming applications created in the Unity3d environment. <br><br>  By tradition, I'll start with prehistory.  During my work in the gaming industry, I developed various projects, with varying complexity, and visited both the game design camp and the programmer camp (where I am today).  It's no secret that any application requires a large number of different configuration data and settings.  In the classic, relatively Unity3d form, such settings are made in the visible part of the inspector, where some numbers are entered, etc.  I think that talking about the convenience of this approach is not worth it, even if we exclude the fact that during the setup, the scene in which the <b>MonoBehaviour</b> class is located is blocked for changes by other developers.  Therefore, after a series of all sorts of ordeals in the past, I decided to write something simple and effective that will make life easier for everyone and simplify work with such data, and I want to share it with you. <br><br>  <b>Note</b> : <i>All the code described below applies to Unity version 2018.3+ and uses the Roslyn compiler (C # 7+ language version).</i> <br><a name="habracut"></a><br><h2>  Internal settings </h2><br>  To begin, consider the internal settings of the project, which include various constants, links, external SDK identifiers, keys, etc.  things including global and local gameplay settings.  In general, all such data can be divided into four types: <br><br><ul><li>  String </li><li>  Int </li><li>  Float </li><li>  Bool </li></ul><br>  All other data can be easily stored in them, and taking into account the string, you can store anything using JSON serialization.  Let's use <b>ScriptableObject</b> as a basis, which is suitable for solving this task like no one else. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Setting</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> ParameterTypeEnum { Float, Int, String, Bool } [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ParameterData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name =&gt; _name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ParameterTypeEnum ParameterType =&gt; _parameterType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> DefaultValue =&gt; _defaultValue; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _name; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ParameterTypeEnum _parameterType; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _defaultValue; } [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> ParameterData[] Parameters; }</code> </pre> <br>  So, in the database, we have an array of values ​​that represent: <br><br><ul><li>  Parameter name </li><li>  Parameter type </li><li>  Parameter Values ​​as Strings </li></ul><br>  <b>Note</b> : <i>why strings?</i>  <i>It seemed to me more convenient than storing 4 variables of different types.</i> <br><br><div class="spoiler">  <b class="spoiler_title">For use in the code, we will add auxiliary methods and a dictionary that will store the converted values ​​in boxed form.</b> <div class="spoiler_text"><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">protected</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">readonly</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">IDictionary</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">string</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">object</span></span>&gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">settingParameters</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Dictionary</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">string</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">object</span></span>&gt;(); <span class="hljs-selector-attr"><span class="hljs-selector-attr">[NonSerialized]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">protected</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bool</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">initialized</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">private</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OnEnable</span></span>() { #if UNITY_EDITOR if (EditorApplication.isPlayingOrWillChangePlaymode) { Initialization(); } <span class="hljs-selector-id"><span class="hljs-selector-id">#else</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Initialization</span></span>(); <span class="hljs-selector-id"><span class="hljs-selector-id">#endif</span></span> } <span class="hljs-selector-tag"><span class="hljs-selector-tag">public</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">virtual</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">T</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">GetParameterValue</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">T</span></span>&gt;(<span class="hljs-selector-tag"><span class="hljs-selector-tag">string</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">name</span></span>) { if (settingParameters.ContainsKey(name)) { var parameterValue = (T)settingParameters[name]; return parameterValue; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">else</span></span> { Debug.Log("[Setting]: name not found [{0}]"<span class="hljs-selector-class"><span class="hljs-selector-class">.Fmt</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">name</span></span>)); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">default</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">protected</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">virtual</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Initialization</span></span>() { if (initialized || Parameters == null) return; for (var i = 0; i &lt; Parameters.Length; i++) { var parameter = Parameters[i]; object parameterValue = null; switch (parameter.ParameterType) { case <span class="hljs-attribute"><span class="hljs-attribute">ParameterTypeEnum.Float</span></span>: { if (!float.<span class="hljs-built_in"><span class="hljs-built_in">TryParse</span></span>(parameter.DefaultValue, out float value)) { value = default; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">parameterValue</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">GetValue</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">parameter</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">value</span></span>); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ParameterTypeEnum</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Int</span></span>: { if (!int.TryParse(parameter.DefaultValue, out int value)) { value = default; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">parameterValue</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">GetValue</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">parameter</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">value</span></span>); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ParameterTypeEnum</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.String</span></span>: { parameterValue = GetValue(parameter.Name, parameter.DefaultValue); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ParameterTypeEnum</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Bool</span></span>: { if (!bool.TryParse(parameter.DefaultValue, out bool value)) { value = default; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">parameterValue</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">GetValue</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">parameter</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">value</span></span>); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">settingParameters</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Add</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">parameter</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">parameterValue</span></span>); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">initialized</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">true</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">protected</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">virtual</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">object</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">GetValue</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">T</span></span>&gt;(<span class="hljs-selector-tag"><span class="hljs-selector-tag">string</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">paramName</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">T</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">defaultValue</span></span>) { return defaultValue; }</code> </pre><br></div></div><br>  Initialization is done in <b>OnEnable</b> .  Why not in <b>awake</b> ?  This method is not called for instances stored as an asset (it is called at the time of <b>CreateInstance</b> , which we do not need).  At the moment of launching the application for assets, <b>ScriptableObject</b> is first called <b>OnDisable</b> (only in the editor), then <b>OnEnable</b> .  Also, in order to avoid initialization in the editor each time you recompile and open a project, you need to add precompilation directives and insert at the beginning of the file: <br><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> UNITY_EDITOR using UnityEditor; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br>  We need the <b>GetValue</b> method further, and for internal settings, it simply returns the default value. <br><br>  The <b>GetParameterValue</b> method <b>is</b> our main method for accessing parameters.  It is worth considering here that despite the unboxing of values, the parameters stored in <b>Setting</b> are in some kind of constant, so you should take them when initializing the scenes.  Do not call the method in <b>Update</b> . <br><br>  Usage example: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyLogic</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Setting _localSetting; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _localStrValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _localIntValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _localFloatValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _localBoolValue; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _localStrValue = _localSetting.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyStr"</span></span>); _localIntValue = _localSetting.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyInt"</span></span>); _localFloatValue = _localSetting.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyFloat"</span></span>); _localBoolValue = _localSetting.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyBool"</span></span>); } }</code> </pre><br>  We wrote the foundation and now we need an editor, because the main goal for us was exactly the convenience for those who work with these settings. <br><br>  To add a menu item in order to be able to create an asset, you can use the attribute: <br><br><pre> <code class="cs hljs">CreateAssetMenu(fileName = <span class="hljs-string"><span class="hljs-string">"New Setting"</span></span>, menuName = <span class="hljs-string"><span class="hljs-string">"Setting"</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Now we will write a custom inspector, which will allow to display data on the asset and launch an external editor.</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">CustomEditor(typeof(Setting), true)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingCustomInspector</span></span> : <span class="hljs-title"><span class="hljs-title">Editor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIStyle _paramsStyle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIStyle _paramInfoStyle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _parameterInfo = <span class="hljs-string"><span class="hljs-string">"&lt;color=white&gt;Name&lt;/color&gt;&lt;color=grey&gt; = &lt;/color&gt;&lt;color=yellow&gt;{0}&lt;/color&gt; &lt;color=white&gt;Type&lt;/color&gt;&lt;color=grey&gt; = &lt;/color&gt;&lt;color=yellow&gt;{1}&lt;/color&gt; &lt;color=white&gt;Defualt Value&lt;/color&gt;&lt;color=grey&gt; = &lt;/color&gt;&lt;color=yellow&gt;{2}&lt;/color&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnInspectorGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button(<span class="hljs-string"><span class="hljs-string">"Edit Setting"</span></span>)) { SettingEditorWindow.Show(serializedObject.targetObject <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Setting); } EditorGUILayout.LabelField(<span class="hljs-string"><span class="hljs-string">"Parameters:"</span></span>, _parametersStyle, GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramsProp = serializedObject.FindProperty(<span class="hljs-string"><span class="hljs-string">"Parameters"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; paramsProp.arraySize; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramProp = paramsProp.GetArrayElementAtIndex(i); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramNameProp = paramProp.FindPropertyRelative(<span class="hljs-string"><span class="hljs-string">"_name"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramTypeProp = paramProp.FindPropertyRelative(<span class="hljs-string"><span class="hljs-string">"_parameterType"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramDefaultValueProp = paramProp.FindPropertyRelative(<span class="hljs-string"><span class="hljs-string">"_defaultValue"</span></span>); EditorGUILayout.BeginHorizontal(); EditorGUILayout.LabelField(_paramInfo.Fmt( paramNameProp.stringValue, paramTypeProp.enumDisplayNames[paramTypeProp.enumValueIndex], paramDefaultValueProp.stringValue), _paramInfoStyle); EditorGUILayout.EndHorizontal(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareGUIStyle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_parametersStyle == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _paramsStyle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GUIStyle(GUI.skin.label); _paramsStyle.fontStyle = FontStyle.Bold; _paramsStyle.fontSize = <span class="hljs-number"><span class="hljs-number">12</span></span>; _paramsStyle.normal.textColor = Color.green; _paramInfoStyle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GUIStyle(GUI.skin.label); _paramInfoStyle.richText = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } }</code> </pre><br></div></div><br>  This is how it will look like: <br><br><img src="https://habrastorage.org/webt/jl/ol/8d/jlol8dt8uslasjuultnenljn0dm.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Now we need an editor of the parameters themselves and their values, for this we use a custom window.</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingEditorWindow</span></span> : <span class="hljs-title"><span class="hljs-title">EditorWindow</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Setting SelectedAsset; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _currentSelectedAsset = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; _assetNames = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;SerializedObject&gt; _settingSerializationObjects = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;SerializedObject&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;T&gt; _assets = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;T&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; _editedNames = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;();; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIContent _editNameIconContent; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIStyle _headerStyle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIStyle _parametersStyle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIStyle _parameterHeaderStyle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GUIStyle _nameStyle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector2 _scrollInspectorPosition = Vector2.zero; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector2 _scrollAssetsPosition = Vector2.zero; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _SELECTED_ASSET_STR = <span class="hljs-string"><span class="hljs-string">"SettingSelected"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Show</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Setting asset</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> instance = GetWindow&lt;Setting&gt;(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); instance.title = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GUIContent(<span class="hljs-string"><span class="hljs-string">"Settings Editor"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty); instance.SelectedAsset = asset; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> assetGuids = AssetDatabase.FindAssets(<span class="hljs-string"><span class="hljs-string">"t:{0}"</span></span>.Fmt(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Setting).Name)); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> guid <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> assetGuids) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = AssetDatabase.GUIDToAssetPath(guid); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> asset = AssetDatabase.LoadAssetAtPath&lt;T&gt;(path); _assetNames.Add(path.Replace(<span class="hljs-string"><span class="hljs-string">"Assets/"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).Replace(<span class="hljs-string"><span class="hljs-string">".asset"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)); _assets.Add(asset); _settingSerializationObjects.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerializedObject(asset)); } _currentSelectedAsset = PlayerPrefs.GetInt(_SELECTED_ASSET_STR, <span class="hljs-number"><span class="hljs-number">-1</span></span>); _editNameIconContent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GUIContent(EditorGUIUtility.IconContent(<span class="hljs-string"><span class="hljs-string">"editicon.sml"</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDisable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { PlayerPrefs.SetInt(_SELECTED_ASSET_STR, _currentSelectedAsset); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareGUIStyle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_headerStyle == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _headerStyle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GUIStyle(GUI.skin.box); _headerStyle.fontStyle = FontStyle.Bold; _headerStyle.fontSize = <span class="hljs-number"><span class="hljs-number">14</span></span>; _headerStyle.normal.textColor = Color.white; _headerStyle.alignment = TextAnchor.MiddleCenter; _parametersStyle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GUIStyle(GUI.skin.label); _parametersStyle.fontStyle = FontStyle.Bold; _parametersStyle.fontSize = <span class="hljs-number"><span class="hljs-number">12</span></span>; _parametersStyle.normal.textColor = Color.green; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { PrepareGUIStyle(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (SelectedAsset != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _currentSelectedAsset = _assets.IndexOf(SelectedAsset); SelectedAsset = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } EditorGUILayout.BeginHorizontal(); EditorGUILayout.BeginVertical(GUI.skin.box, GUILayout.MinWidth(<span class="hljs-number"><span class="hljs-number">350f</span></span>), GUILayout.ExpandHeight(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); _scrollAssetsPosition = EditorGUILayout.BeginScrollView(_scrollAssetsPosition, GUIStyle.none, GUI.skin.verticalScrollbar); _currentSelectedAsset = GUILayout.SelectionGrid(_currentSelectedAsset, _assetNames.ToArray(), <span class="hljs-number"><span class="hljs-number">1</span></span>); EditorGUILayout.EndScrollView(); EditorGUILayout.EndVertical(); EditorGUILayout.BeginVertical(GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> assetSerializedObject = (_currentSelectedAsset &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) ? _settingSerializationObjects[_currentSelectedAsset] : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; EditorGUILayout.Space(); EditorGUILayout.LabelField((_currentSelectedAsset &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) ? _assetNames[_currentSelectedAsset] : <span class="hljs-string"><span class="hljs-string">"Select Asset..."</span></span>, _headerStyle, GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); EditorGUILayout.Space(); _scrollInspectorPosition = EditorGUILayout.BeginScrollView(_scrollInspectorPosition, GUIStyle.none, GUI.skin.verticalScrollbar); Draw(assetSerializedObject); EditorGUILayout.EndScrollView(); EditorGUILayout.EndVertical(); EditorGUILayout.EndHorizontal(); assetSerializedObject?.ApplyModifiedProperties(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Draw</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SerializedObject assetSerializationObject</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (assetSerializationObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; EditorGUILayout.BeginHorizontal(); EditorGUILayout.LabelField(<span class="hljs-string"><span class="hljs-string">"Parameters:"</span></span>, _parametersStyle, GUILayout.Width(<span class="hljs-number"><span class="hljs-number">20f</span></span>), GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parametersProperty = assetSerializationObject.FindProperty(<span class="hljs-string"><span class="hljs-string">"Parameters"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button(<span class="hljs-string"><span class="hljs-string">"Add"</span></span>, GUILayout.MaxWidth(<span class="hljs-number"><span class="hljs-number">40f</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (parametersProperty != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { parametersProperty.InsertArrayElementAtIndex(parametersProperty.arraySize); } } EditorGUILayout.EndHorizontal(); EditorGUILayout.Space(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (parametersProperty != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; parametersProperty.arraySize; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameterProperty = parametersProperty.GetArrayElementAtIndex(i); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameterNameProperty = parameterProperty.FindPropertyRelative(<span class="hljs-string"><span class="hljs-string">"_name"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameterTypeProperty = parameterProperty.FindPropertyRelative(<span class="hljs-string"><span class="hljs-string">"_parameterType"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameterDefaultValueProperty = parameterProperty.FindPropertyRelative(<span class="hljs-string"><span class="hljs-string">"_defaultValue"</span></span>); EditorGUILayout.BeginHorizontal(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button(_editNameIconContent, GUILayout.MaxWidth(<span class="hljs-number"><span class="hljs-number">25f</span></span>), GUILayout.MaxHeight(<span class="hljs-number"><span class="hljs-number">18f</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_editedNames.Contains(i)) { _editedNames.Remove(i); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _editedNames.Add(i); } } EditorGUILayout.LabelField(<span class="hljs-string"><span class="hljs-string">"Name"</span></span>, _parameterHeaderStyle, GUILayout.MaxWidth(<span class="hljs-number"><span class="hljs-number">40f</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_editedNames.Contains(i)) { parameterNameProperty.stringValue = EditorGUILayout.TextField(parameterNameProperty.stringValue, GUILayout.Width(<span class="hljs-number"><span class="hljs-number">175f</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ev = Event.current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ev.type == EventType.MouseDown || ev.type == EventType.Ignore || (ev.type == EventType.KeyDown &amp;&amp; ev.keyCode == KeyCode.Return)) { _editedNames.Remove(i); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { EditorGUILayout.LabelField(parameterNameProperty.stringValue, _nameStyle, GUILayout.Width(<span class="hljs-number"><span class="hljs-number">175f</span></span>)); } EditorGUILayout.LabelField(<span class="hljs-string"><span class="hljs-string">"Type"</span></span>, _parameterHeaderStyle, GUILayout.MaxWidth(<span class="hljs-number"><span class="hljs-number">40f</span></span>)); parameterTypeProperty.enumValueIndex = EditorGUILayout.Popup(parameterTypeProperty.enumValueIndex, parameterTypeProperty.enumDisplayNames, GUILayout.Width(<span class="hljs-number"><span class="hljs-number">75f</span></span>)); GUILayout.Space(<span class="hljs-number"><span class="hljs-number">20f</span></span>); EditorGUILayout.LabelField(<span class="hljs-string"><span class="hljs-string">"DefaultValue"</span></span>, _parameterHeaderStyle, GUILayout.Width(<span class="hljs-number"><span class="hljs-number">85f</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (parameterTypeProperty.enumValueIndex) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>.TryParse(parameterDefaultValueProperty.stringValue, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = EditorGUILayout.FloatField(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); parameterDefaultValueProperty.stringValue = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.ToString(); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.TryParse(parameterDefaultValueProperty.stringValue, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = EditorGUILayout.IntField(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); parameterDefaultValueProperty.stringValue = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.ToString(); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: parameterDefaultValueProperty.stringValue = EditorGUILayout.TextField(parameterDefaultValueProperty.stringValue, GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>.TryParse(parameterDefaultValueProperty.stringValue, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = EditorGUILayout.Toggle(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, GUILayout.ExpandWidth(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); parameterDefaultValueProperty.stringValue = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.ToString(); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button(<span class="hljs-string"><span class="hljs-string">"-"</span></span>, GUILayout.MaxWidth(<span class="hljs-number"><span class="hljs-number">25f</span></span>), GUILayout.MaxHeight(<span class="hljs-number"><span class="hljs-number">18f</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_editedNames.Contains(i)) { _editedNames.Remove(i); } parametersProperty.DeleteArrayElementAtIndex(i); } EditorGUILayout.EndHorizontal(); } } } }</code> </pre><br></div></div><br>  I will not explain the code much, as a whole everything is simple.  I note only that the editor allows you to edit by choice all assets of the type <b>Setting</b> .  To do this, when you open the window, we find them in the project using the <b>AssetDatabase.FindAssets</b> method <b>("t: {0}". Fmt (typeof (Setting). Name))</b> .  As well as editing the name of the parameter is done through the button in order to prevent its accidental change. <br><br>  Here is the editor: <br><br><img src="https://habrastorage.org/webt/x1/5a/d1/x15ad1d3gw0jeza8lzcwfybpyn0.png" alt="image"><br><br>  We have considered the settings used inside the application, now consider a more specific case. <br><br><h2>  External settings </h2><br>  Imagine a situation that in an already running game, we suddenly needed to change certain values ​​in order to correct the gameplay.  In a primitive version, we change this in the build, accumulate such changes, do an update and send it to stores, then wait for confirmation, etc.  But how about those who do not update the application?  And what if changes need to be made urgently?  To solve this problem, there is a mechanism such as <b>Remote Settings</b> .  This is not a new invention and is used in many third-party SDKs for analytics, etc., for example, this is in <b>Firebase</b> , in <b>GameAnalytics</b> , and also in <b>Unity Analytics</b> .  It is the last we will use. <br><br>  <b>Note</b> : <i>in general, there is no difference between all these systems, they are similar and use the same principles.</i> <br><br>  Let us dwell in more detail on what <b>Remote Settings is</b> in <b>Unity Analytics</b> and what it can do. <br><br>  In order for this functionality to be available in the project, you need to enable analytics in the project on the <b>Services</b> tab. <br><br><img src="https://habrastorage.org/webt/ki/eb/pf/kiebpfcyu4b2f53c35qzoxipd2e.png" alt="image"><br><br>  After this, you need to log into your Unity3d account and find your project there and follow the link to the analytics section, where in the menu on the left we select the item <b>Remote Settings</b> . <br><br><img src="https://habrastorage.org/webt/nj/m_/ww/njm_wwk4dwtmfut-1wdy9gugnp0.png" alt="image"><br><br>  All settings are divided into those that are used in development mode and those that will be used in an already released application. <br><br><img src="https://habrastorage.org/webt/7t/hf/ts/7thftsk8qatbs2cbhy_z6ek1alq.png" alt="image"><br><br>  To add a parameter, select the corresponding item and enter the name, type and value of the parameter. <br><br><img src="https://habrastorage.org/webt/jo/il/im/joilimonh5653fmucnogp5lck7m.png" alt="image"><br><br>  After we have added all the necessary parameters, we need support in the code to work with them. <br><br>  <b>Note</b> : The <i>Sync button synchronizes the settings with the application.</i>  <i>This process does not happen instantly, but at the moment when the parameters in the application are updated, the corresponding events will be triggered, we will talk about them later</i> . <br><br>  To work with <b>Remote Settings</b> do not require any additional SDK, it is enough to enable analytics, as I wrote above. <br><br><div class="spoiler">  <b class="spoiler_title">Let's write a class to work with remote settings, for this we use the Setting class described above as the base.</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RemoteSetting</span></span> : <span class="hljs-title"><span class="hljs-title">Setting</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IList&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetUpdatedParameter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> updatedParameters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; Parameters.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameter = Parameters[i]; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (parameter.ParameterType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ParameterTypeEnum.Float: { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentValue = Get&lt;<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt;(parameter.Name); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newValue = RemoteSettings.GetFloat(parameter.Name, currentValue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentValue != newValue) { settingParameters[parameter.Name] = newValue; updatedParameters.Add(parameter.Name); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ParameterTypeEnum.Int: { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentValue = Get&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(parameter.Name); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newValue = RemoteSettings.GetInt(parameter.Name, currentValue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentValue != newValue) { settingParameters[parameter.Name] = newValue; updatedParameters.Add(parameter.Name); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ParameterTypeEnum.String: { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentValue = Get&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(parameter.Name); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newValue = RemoteSettings.GetString(parameter.Name, currentValue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Compare(currentValue, newValue, System.StringComparison.Ordinal) != <span class="hljs-number"><span class="hljs-number">0</span></span>) { settingParameters[parameter.Name] = newValue; updatedParameters.Add(parameter.Name); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ParameterTypeEnum.Bool: { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentValue = Get&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(parameter.Name); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newValue = RemoteSettings.GetBool(parameter.Name, currentValue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentValue != newValue) { settingParameters[parameter.Name] = newValue; updatedParameters.Add(parameter.Name); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> updatedParameters; } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> GetValue&lt;T&gt;(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> paramName, T defaultValue) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(defaultValue) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> RemoteSettings.GetFloat(paramName, f); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> RemoteSettings.GetInt(paramName, i); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> s: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> RemoteSettings.GetString(paramName, s); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> b: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> RemoteSettings.GetBool(paramName, b); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; } } }</code> </pre><br></div></div><br>  As you can see, we redefined the <b>GetValue</b> method and added a new method that allows us to get a list of changed parameters, we will need it later. <br><br>  Above, we wrote an example of using <b>Setting</b> in code, it is quite simple, but does not take into account the presence of remote settings, so to unify access to all settings in a single key, we will write a manager who will help with this. <br><br><div class="spoiler">  <b class="spoiler_title">Settings Manager Code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsManager</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviourSingleton</span></span>&lt;<span class="hljs-title"><span class="hljs-title">SettingsManager</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Setting <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> index] =&gt; GetSetting(index); [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Setting[] _settings; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, Setting&gt; _settingsByName = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, Setting&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForceUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { RemoteSettings.ForceUpdate(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> setting <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _settings) { _settingsByName.Add(setting.name, setting); } RemoteSettings.BeforeFetchFromServer += OnRemoteSettingBeforeUpdate; RemoteSettings.Updated += OnRemoteSettingsUpdated; RemoteSettings.Completed += OnRemoteSettingCompleted; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Setting </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetSetting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_settingsByName.ContainsKey(name)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _settingsByName[name]; }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Debug.LogWarningFormat(<span class="hljs-string"><span class="hljs-string">"[SettingManager]: setting name [{0}] not found"</span></span>, name); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRemoteSettingBeforeUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { RemoteSettingBeforeUpdate.Call(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRemoteSettingsUpdated</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> setting <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _settingsByName.Values) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (setting <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> RemoteSetting) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> updatedParameter = remoteSetting.GetUpdatedParameter(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameterName <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> updatedParameter) { RemoteSettingUpdated.Call(parameterName); } } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRemoteSettingCompleted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> wasUpdatedFromServer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> settingsChanged, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> serverResponse</span></span></span><span class="hljs-function">)</span></span> { RemoteSettingsCompleted.Call(wasUpdatedFromServer, settingsChanged, serverResponse); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDestroy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { RemoteSettings.BeforeFetchFromServer -= OnRemoteSettingBeforeUpdate; RemoteSettings.Updated -= OnRemoteSettingsUpdated; RemoteSettings.Completed -= OnRemoteSettingCompleted; } }</code> </pre><br></div></div><br>  The manager is represented as a siglet that lives only in the scene.  This is done for ease of reference to it and in order to be able to easily manage the set of parameters in each scene (exclude parameters that are not required by logic). <br><br>  As you can see, <b>RemoteSettings</b> has three events: <br><br><ol><li>  An event that is triggered before parameter values ​​are retrieved from a remote server. </li><li>  Parameter update event (called just by the Sync button, which we wrote about earlier), as well as in case of forced update of parameters via the ForceUpdate function </li><li>  Event triggered when remote settings are retrieved from the server.  It also gives the server response code, in case of any error. </li></ol><br>  <b>Note</b> : the <i>code uses an event system built on data types, more details are written about it in <a href="https://habr.com/ru/post/282524/">my other article</a> .</i> <br><br>  <b>Note</b> : <i>you need to understand how RemoteSettings works.</i>  <i>At the start, if you have access to the Internet, it automatically downloads data about the parameters and caches it, so the next time you start, if the Internet is not available, the data will be taken from the cache.</i>  <i>An exception is the situation when the application is initially started with network access turned off, in this case, the function of getting the parameter value will return the default value.</i>  <i>In our case, these are the ones that we enter in the editor.</i> <br><br>  Now let's change the example of using the settings from the code taking into account the above. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyLogic</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> INGAME_PARAMETERS = <span class="hljs-string"><span class="hljs-string">"IngamgeParameters"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> REMOTE_RAPAMETERS = <span class="hljs-string"><span class="hljs-string">"RemoteParamteters"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _localStrValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _localIntValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _localFloatValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _localBoolValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _remoteStrValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _remoteIntValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _remoteFloatValue; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _remoteBoolValue; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingameParametes = SettingsManager.Instance[INGAME_PARAMETERS]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> remoteParametes = SettingsManager.Instance[REMOTE_RAPAMETERS]; _localStrValue = ingameParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyStr"</span></span>); _localIntValue = ingameParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyInt"</span></span>); _localFloatValue = ingameParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyFloat"</span></span>); _localBoolValue = ingameParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyBool"</span></span>); _remoteStrValue = remoteParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyStr"</span></span>); _remoteIntValue = remoteParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyInt"</span></span>); _remoteFloatValue = remoteParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyFloat"</span></span>); _remoteBoolValue = remoteParametes.GetParameterValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"MyBool"</span></span>); } }</code> </pre><br>  As you can see, from the code, there is no difference in the work between the internal settings and the external ones; however, if necessary, if the logic requires it, you can subscribe to manager events related to remote settings. <br><br>  <b>Note</b> : <i>if you only need remote settings, you can download a <a href="https://assetstore.unity.com/packages/add-ons/services/analytics/unity-analytics-remote-settings-89317">special plugin from AssetStore</a> , it allows you to work with them immediately.</i> <br><br><h2>  Conclusion </h2><br>  In this article I tried to show how you can easily configure an application written in Unity3d using both internal settings and remote ones.  I use a similar approach in my projects, and it proves its effectiveness.  We even managed, using remote settings, to implement our <b>A / B testing system</b> .  In addition, the settings are commonly used to store various constants associated with the SDK, with server things, as well as with setting up the gameplay, etc.  A game designer can pre-create a set of parameters and describe how, and for what, and where they are used, while he can customize the gameplay without blocking the scene.  And due to the fact that we used <b>ScriptableObject</b> and store such parameters as assets, they can be loaded via <b>AssetBundle</b> , which further expands our capabilities. <br><br>  <b>Links listed in the article</b> : <br><br>  <a href="https://habr.com/ru/post/282524/">habr.com/en/post/282524</a> <br>  <a href="https://assetstore.unity.com/packages/add-ons/services/analytics/unity-analytics-remote-settings-89317">assetstore.unity.com/packages/add-ons/services/analytics/unity-analytics-remote-settings-89317</a> </div>