<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we monitored Black Hat Europe 2018</title>
  <meta name="description" content="Half a year ago, I already wrote on Habr√© a note where I shared our experience in monitoring various IT and security conferences, in which Cisco is in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>How we monitored Black Hat Europe 2018</h1><div class="post__text post__text-html js-mediator-article">  Half a year ago, I already <a href="https://habr.com/ru/company/cisco/blog/416901/">wrote</a> on Habr√© a note where I shared our experience in monitoring various IT and security conferences, in which Cisco is invited to work for SOC and NOC (Black Hat, Mobile World Congress, RSAC, etc.).  Today I would like to share the experience of participating in the network monitoring center, which served the last European Black Hat, in which we have been helping the NOC for the second year.  Together with RSA, Palo Alto, Gigamon and Rukus, we provided protection for the conference and training infrastructure.  Cisco has taken on the task of monitoring and investigating DNS incidents (using <a href="https://umbrella.cisco.com/">Cisco Umbrella</a> and <a href="https://learn-umbrella.cisco.com/threat-intelligence/investigate-from-opendns">Cisco Umbrella Investigate</a> ), as well as automated malware analysis and Threat Intelligence using <a href="https://www.cisco.com/c/en/us/products/security/threat-grid/index.html">Cisco Threat Grid</a> . <br><br><img src="https://habrastorage.org/webt/rn/l4/b3/rnl4b3417fi4ftvg5uftvb9amjy.jpeg" alt="Presentation of Black Hat NOC Results"><a name="habracut"></a><br><br>  Ensuring the cybersecurity of conferences such as Black Hat is more than a difficult task, since the appearance of malicious files in traffic or attempts to access malicious domains is not something out of the ordinary.  On the contrary, within the framework of various trainings, this is a completely normal event, which cannot be blocked, thereby disrupting the learning process and causing dissatisfaction with both the participants who paid their money and the instructors.  The same is true for sponsors, who often demonstrate how their decisions work as part of their events, briefings and press conferences, which also requires attention and intelligibility from the NOC team. <br><br><h3>  Obfuscated Malware </h3><br>  The monitoring of the network on Black Hat was the responsibility of the RSA NetWitness solution, which was inspected, among other things, of files transmitted over various network protocols, including with various violations.  For example, on the first day of one of the trainings, the download of the file table.png was recorded.  NetWitness discovered that despite the extension inherent in images, the file header began with MZ, which could indicate that the file being transferred is actually executable.  The file was transferred to Cisco Threat Grid for dynamic analysis. <br><br><img src="https://habrastorage.org/webt/6m/1b/cg/6m1bcgiosjkmrdnjyf-8yh8hd9o.png" alt="image"><br><br>  A few minutes after downloading, the file table.png was recognized as a Trickbot Trojan. <br><br><img src="https://habrastorage.org/webt/yf/4g/qh/yf4gqh2hxhghmf5whdcj-ps1ngy.png" alt="image"><br><br>  Detection occurred on a number of behavioral indicators, including the work with memory.  It is enough to change just one bit in order to change the hash of the file, but it is rather difficult to rewrite the code for working with memory in order to become imperceptible to the malware analysis system.  Exactly the same address space was used by Trickbot, which allowed us to make a conclusion about this malware. <br><br><img src="https://habrastorage.org/webt/vq/yx/tj/vqyxtj6k54q5dbedyqbd5lrwxb8.png" alt="image"><br><br>  Trickbot is not a new trojan;  It appeared at the end of 2016, but is still found on the Internet.  The NOC team identified the MAC address of the laptop from which the Trickbot was downloaded, disguised as a .png file.  We checked all the activity that was going on from this Macbook - it turned out that it took only a few minutes to try to connect to hundreds of DGA-domains, download dozens of various malicious programs, etc.  In the course of the investigation, it was found out that the MacBook was used as part of one of the trainings;  therefore, the NOC team did not block this activity, while making efforts so that nothing dangerous would fall outside the limits of this training on the computers of other Black Hat Europe participants. <br><br><h3>  Intelligent proxy </h3><br>  As the function expands in our solutions, we test them in the framework of conferences where we are invited to participate in SOC / NOC.  This time, on the very first day, we turned on the Intellgent Proxy feature in Cisco Umbrella, which allows you to proxy Web traffic by tracking threats, content and applications transmitted as part of a Web interaction. <br><br>  In the morning of the first day we recorded the alarm associated with access to the macautofixer. <br><br><img src="https://habrastorage.org/webt/w5/ia/mb/w5iambmapvfq1oo-fy3bv7qryng.png" alt="image"><br><br>  The NOC team launched an investigation, including the analysis of ITU logs, the reconstruction of network packets and the identification of the machine that initiated the request.  Judging by the data of Cisco Umbrella Investigate, this is a rather popular malicious resource - about 20 thousand requests are recorded daily to it: <br><br><img src="https://habrastorage.org/webt/x9/2-/bz/x92-bzxpvmuo-pucg7mqiyt3o1m.png" alt="image"><br><br>  mainly from the USA: <br><br><img src="https://habrastorage.org/webt/lw/mt/2p/lwmt2p6ruytv6bk9htn700zyfvs.png" alt="image"><br><br>  It turned out that one of the computers of the conference organizers was infected.  The BlackHat policy allows access to malicious resources until it is identified that this is an external attack on Black Hat resources, as recorded in this case.  The domain has been locked by Cisco Umbrella for this and all future Black Hat conferences. <br><br><img src="https://habrastorage.org/webt/m7/jj/ad/m7jjad_dedfypgmb2zvkcfeu9ng.png" alt="image"><br><br>  On the second day, several Wi-Fi network users were infected with the Simba malware, which was trying to connect to fairly old command servers: <br><br><ul><li>  www [.] gadyniw [.] com / hbt.php? rewrite = login.php </li><li>  purycap [.] com / login.php </li><li>  gadyniw [.] com / hbt.php? rewrite = login.php </li><li>  ww1 [.] ysyfyj [.] com / login.php </li></ul><br>  Domain gadyniw [.] Com was identified by Cisco Threat Grid as malicious and blocked.  The investigation revealed that this malware was used as part of one of the trainings, in which participants had unpatched computers.  We advised the instructor to remind infected participants not to connect with their laptops to the public Wi-Fi segment. <br><br><img src="https://habrastorage.org/webt/8b/mx/ua/8bmxuahinvwlrmo69pqzcrw-lpc.png" alt="image"><br><br><h3>  Phishing attack </h3><br>  In the course of Black Hat, its organizers, the UBM company, encountered a massive phishing attack via e-mail, which is still the most massive method of attacking organizations. <br><br><img src="https://habrastorage.org/webt/wm/l-/8i/wml-8iohurqflcjyrilevlv8bl0.png" alt="image"><br><br>  We conducted a CLICK HERE reference study using the Glovebox function in the Threat Grid, which allows you to interact with the virtual machine without the risk of infection.  In two browsers, the link returned an error, as if the page needed did not exist. <br><br><img src="https://habrastorage.org/webt/uf/vd/q2/ufvdq2ltmgvnopdipchrcforyco.png" alt="image"><br><br>  However, in the report we recorded about 100 open network connections, about 100 artifacts loaded on the disk, including JavaScript, as well as about 170 registry changes. <br><br><img src="https://habrastorage.org/webt/ct/jn/nl/ctjnnls-cgdprlmq2lyw9yuisps.png" alt="image"><br><br>  We have added this domain to the blacklist for all Black Hat conferences. <br><br><img src="https://habrastorage.org/webt/wr/gb/wo/wrgbwoqucha_ty1n5ixs5o7jyna.png" alt="image"><br><br><h3>  DNS activity </h3><br>  In 2017, we recorded about 5.8 million DNS requests at Black Hat Europe conferences.  A year later, in 2018, we recorded 7.6 million requests, of which about 4,000 were associated with malicious activity, command servers or phishing. <br><br><img src="https://habrastorage.org/webt/fc/u7/qz/fcu7qzvzdirowdpc9odvv8vbkem.png" alt="image"><br><br>  New on European Black Hat was the notification of users whose credentials for e-mail were transmitted in the clear.  Fortunately, compared with previous conferences this time, only 14 users sent their mail in unprotected mode.  This was the first conference at which we did not observe financial or banking documents transmitted in open form. <br><br>  The NOC team also recorded a large number of references to mining resources.  For the first time, we began to record such attempts a year ago in Europe, followed by a big surge on the Asian Black Hat. <br><br><img src="https://habrastorage.org/webt/ml/-8/hh/ml-8hhobbxkfesdc5lucalver3k.png" alt="image"><br><br>  Users with cryptomines were warned by the Black Hat NOC team.  If they used mining consciously, then there is no problem.  If it was about infection, the users were offered help in treating the computer. <br><br><img src="https://habrastorage.org/webt/xy/ul/05/xyul05rxe0rrhcfxpfhckfnqr70.png" alt="image"><br><br>  Also, the new Cisco Umbrella feature, which was tested on European Black Hat, was App Discovery, which allows you to identify the applications used (now there are more than 2000) and assess their risk to the enterprise. <br><br><img src="https://habrastorage.org/webt/wh/d0/bj/whd0bjpx3ou4xg-xg8i8luw1wp8.png" alt="image"><br><br>  It is clear that the policy of Black Hat is different from a normal company, in which anonymizers and VPN services that may violate corporate security policies may be prohibited.  At the conference on information security, the use of such applications is quite normal and, therefore, they were not blocked.  But it was interesting to look at the most popular solutions of this class. <br><br><img src="https://habrastorage.org/webt/fo/rx/bf/forxbfouqsuha8ri_xsdsrabim8.png" alt="image"><br><br>  The next stop for the Cisco Security team will be the RSA conference, which will be held this March in San Francisco, where we will again be responsible for the work of RSA SOC.  If suddenly you plan to visit this exhibition, then we invite you on an excursion to the security monitoring center of one of the largest world events on information security, which annually is visited by tens of thousands of people.  If you are in RSAC days in San Francisco and want to visit the exhibition, but do not have a ticket for it, then Cisco will give you a promotional code for a free <a href="https://www.rsaconference.com/events/us19/register">pass</a> to the exhibition - X8SCISCOP. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/276/7c6/97f/2767c697f769ade062338fa6527aaa8d.jpg" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/436786/">https://habr.com/ru/post/436786/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>