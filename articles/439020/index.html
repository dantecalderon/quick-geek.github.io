<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ticket to Ride. Europe - arithmetic, part two</title>
  <meta name="description" content="Still continuing to learn the basics of mathematics and mechanics in the game. This article is the second in the series ( Link to the first part ), it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Ticket to Ride. Europe - arithmetic, part two</h1><div class="post__text post__text-html js-mediator-article">  <i>Still continuing to learn the basics of mathematics and mechanics in the game.</i>  <i>This article is the second in the series ( <a href="https://habr.com/ru/post/436642/">Link to the first part</a> ), it continues the analysis of the hauls, an attempt to sort them according to needs, the study of various ways to build routes.</i>  <i>If we draw analogies with mathematics, these are just the basics, arithmetic.</i>  <i>Algebra and higher mathematics in the spirit of ‚Äútaking wagons or building a stage?‚Äù, ‚ÄúWhat is better to build now ‚Äî stage or station?‚Äù And ‚Äúusing one route by several routes‚Äù while in the planning stage, I hope, hands and brains will reach them.</i> <i><br><br></i>  <i>By default, there are arguments in the post, 2-3 players relevant for the game (only one path is used on ‚Äúdouble-track‚Äù runs)</i> <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Brief information about the first part</b> <div class="spoiler_text">  In the first article, with the help of python and Excel, an attempt was made to understand which cars it would be more profitable to use for the construction of "gray" hauls, how to quickly build one route or another. <br><br>  From the previous developments, only the table ‚Äúnumber of moves for the construction of the leg N‚Äù will be used: <br><br><img src="https://habrastorage.org/webt/m2/mm/03/m2mm03gqaebvl27n0-1bpl5lqyu.png" alt="The number of moves for the construction of the stage"></div></div><br><h2>  Search for the most "profitable" way </h2><br>  As the practice of the game and comments from respected participants show, the shortest path between the two cities is not always the most profitable ( <i>to be extremely honest, it is almost never</i> ).  Let's try to find a way where the ratio of "points earned / spent moves" would be the maximum. <br><br><div class="spoiler">  <b class="spoiler_title">Description of the path finding algorithm</b> <div class="spoiler_text">  1. For each of the 46 route cards, a search is made for all possible ‚Äútracks‚Äù from the starting point to the destination.  For the ‚Äúroutes‚Äù of the routes we introduce two restrictions: <br><br><ul><li>  The length (the number of wagons spent) does not exceed 45 (the maximum possible cars). </li><li>  Each city can be used only once (loops are not considered). </li></ul><br>  All this is implemented with the help of the standard search "in depth". <br>  2. Of all the possible "tracks" is chosen the one for which the ratio <br><br>  <b><i>(Points for the runs + Points for the routes) / (Number of moves spent)</i></b> <br><br>  is the greatest. </div></div><br>  The algorithm turned out to be rather slow, for each card of the route it ‚Äúwool‚Äù all possible options for about one and a half minutes, while consuming 3 gigabytes of RAM. <br><br><img src="https://habrastorage.org/webt/yx/ri/xg/yxrixgethtpmqhodr4fjgszejec.png"><br>  <i>The most "profitable" routes and routes for them</i> <br><br>  The results of the execution of the algorithm sometimes gave completely "illogical" in human opinion results.  For example, the route "London-Berlin" (7 points), the computer proposes to build in this way: " <i>London-Dieppe-Paris-Marseille-Rome-Palermo-Smyrna-Constantinople-Bucharest-Budapest-Kiev-Warsaw-Berlin</i> " (average 101 move; 81 points for constructed legs). <br><br><img src="https://habrastorage.org/webt/dm/bf/bn/dmbfbn9ilm60jgrvfnooddkypow.png"><br>  <i>As my grandfather, a front-line soldier, said: ‚ÄúFrom Kiev through Penza, to Zhytomyr‚Äù</i> <br><br>  After the list of the most "profitable" routes is formed, you can proceed to the next stages of calculation. <br><br><h2>  Search for the busiest cities </h2><br>  As in the previous time, for each city, the number of routes in which it participates was calculated (as the final station and as an intermediate one).  "Workload" was considered as the difference between the ways from the city / to the city and the number of routes. <br><br><img src="https://habrastorage.org/webt/h8/pu/hr/h8puhrwnzws-mpgeg4qdnpazbca.png"><br>  <i>The busiest cities</i> <br><br><img src="https://habrastorage.org/webt/lz/0e/zs/lz0ezsd5mxqqfd5xqy9ccdqoej8.png"><br>  <i>The most "free" cities</i> <br><br>  When calculating the workload of cities, only the number of hauls approaching the city was taken into account, the number of tracks in the haul (one or two) was ignored.  Accordingly, the numbers are more or less relevant for the game together or three of us.  Well and ... the tables in themselves do not carry any useful information, unless they help to choose from which city to begin construction with other things being equal.  Much more important information on the stage. <br><br><h2>  Most loaded hauls </h2><br>  Like last time, the most ‚Äúprofitable tracks‚Äù were analyzed, the use of spans in them was calculated, regardless of the direction of movement (that is, movements like ‚ÄúLondon-Edinburgh‚Äù and ‚ÄúEdinburgh-London‚Äù are considered as movements according to the same same distilled). <br><br><img src="https://habrastorage.org/webt/xy/fz/d4/xyfzd4y-9uo9cm-5lr3rlqzvrkg.png"><br>  <i>The busiest hauls, they need to occupy first</i> <br><br><img src="https://habrastorage.org/webt/hl/bs/hm/hlbshmvwzitzv67nsksd_tx1klq.png"><br>  <i>Transit that was not used for the construction of routes</i> <br><br>  In the comments to the last entry, <a href="https://habr.com/ru/users/pproger/" class="user_link">pproger</a> and <a href="https://habr.com/ru/users/g000phy/" class="user_link">g000phy</a> wrote that in order to win the game, use 8 and 6 wagon lengths.  As expected, the 6-carriages ‚ÄúKiev-Budapest‚Äù and ‚ÄúPalermo-Smyrna‚Äù, as well as access roads to them, are at the top of the ‚Äúbusiest‚Äù table.  Unexpectedly, but Stockholm-Petrograd was at the bottom of the Top-10 rating.  Apparently, it affects its remoteness from the main routes and a large number of cars that should be spent on construction. <br><br><img src="https://habrastorage.org/webt/ko/g_/jv/kog_jvffbvpx8xvn6lfxvz03mqu.png"><br>  <i>Heat map.</i>  <i>The farther from the green, the more loaded this stage / city.</i>  <i>White marked unused paths.</i> <br><br><h2>  Overdrive top priority </h2><br>  In the comments to the previous entry, <a href="https://habr.com/ru/users/woozle/" class="user_link">woozle</a> wrote about the key hauls, the lack of which would lead to an increased consumption of cars and moves (a striking example is the ‚ÄúKharkov-Rostov‚Äù <a href="https://habr.com/ru/users/woozle/" class="user_link">stage</a> for the eastern segment). <br><br>  On the process of finding these hauls would like to ask for advice from a respected community. <br><br>  I see the search algorithm as follows: <br><br><ul><li>  The number of moves required for the construction of each route is summed up (a certain standard is obtained). </li><li>  Each route is alternately excluded from the matrix of paths.  Again, the amount of moves spent on each route is considered. </li><li>  The ‚Äúimportance‚Äù of each span is considered as the difference between the spent moves for the removed span and the standard. </li></ul><br>  Currently, there are two options of the ‚Äúroute‚Äù for each route: <br><br><ol><li>  <b>The route from point A to point B in the least number of moves</b> .  The algorithm is described in the previous article, the result of the importance calculation is given below: <br><br><img src="https://habrastorage.org/webt/vz/3z/o8/vz3zo8-kkwdf5uqgkrh4fylpblw.png"><br>  ‚ÄúEdinburgh-London‚Äù is not listed (if one player builds the cars on this route, the second one will set up the station or remain with an incomplete route).  The importance of the ‚ÄúCopenhagen-Essen‚Äù, ‚ÄúStockholm-Copenhagen‚Äù and ‚ÄúKharkiv-Rostov‚Äù hauls is also obvious, but the others on the list raise doubts ... <br></li><li>  <b>The route from point A to point B with the highest ratio "the number of points received / the number of moves spent</b> . <b>"</b>  For this case, critical runs were not considered for two reasons.  First, long (90 spans * 46 routes * 1.5 minutes per count).  Secondly, the laid "routes" of routes give such "rounds" that for the most part are unlikely to be used in a real game. </li></ol><br>  Actually, the search for "key" hauls abuts against a set of primary data (a list of logically constructed routes).  These ‚Äúlogical routes‚Äù are not at hand, there are no ideas - how to find them.  I would appreciate thoughts and suggestions. <br><br>  <i>Continuation (station, the longest way) follows ...</i> </div><p>Source: <a href="https://habr.com/ru/post/439020/">https://habr.com/ru/post/439020/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>