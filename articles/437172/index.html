<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IBM MQ and JMeter: First Contact</title>
  <meta name="description" content="Hi, Habr! 

 This is a prequel of my previous publication and at the same time a remake of the article Automated testing of services using the MQ prot...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>IBM MQ and JMeter: First Contact</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br>  This is a prequel of my <a href="https://habr.com/ru/post/413481/">previous publication</a> and at the same time a remake of the article <a href="https://habr.com/ru/post/248453/">Automated testing of services using the MQ protocol using JMeter</a> . <br><br>  This time, I‚Äôll talk about my experience of reconciling JMeter and IBM MQ for happy testing applications on IBM WAS.  Faced such a task, she did not easily give in.  I want to help save time for all interested. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m1/zs/v3/m1zsv39inuqwaivywvuyolm7svy.jpeg"></div><a name="habracut"></a><br><h4>  Introduction </h4><br>  About the project: data bus, multiple xml messages, three exchange areas (queues, databases, file system), web services with their own message processing logic.  As the project progressed, testing by hand became increasingly difficult.  Apache JMeter was called to help - powerful and open source, with a large user community and user-friendly interface.  The ease of customization of the "out of the box" version allows you to cover any cases, and the promise of the lead developer to help <i>if that</i> (did help) finally approved the choice. <br><br><h4>  Preparing the initial context </h4><br>  To interact with the queue manager, you need an initial context.  It is of several types, <a href="https://developer.ibm.com/answers/questions/260267/where-are-the-jndi-administrative-objects-for-mq/">here</a> you can read more. <br>  To create it is convenient to use MQ Explorer: <br><br><img src="https://habrastorage.org/webt/fd/8n/vz/fd8nvzjfzfegb7s-llhpym7jkje.png"><br>  <sup>Figure 1: Adding an initial context</sup> <br><br>  Select the context file type and the directory for storing the <b>.bindings</b> file, which will contain the description of JNDI objects: <br><br><img src="https://habrastorage.org/webt/hw/vj/dz/hwvjdzq1tz7uirpst3kx1mw1ovk.png"><br>  <sup>Figure 2: Select the type of initial context</sup> <br><br>  Then you can start creating these objects.  And start with the connection factory: <br><br><img src="https://habrastorage.org/webt/ps/te/si/pstesiexhf6j0wtsyg79o8y1fdg.png"><br>  <sup>Figure 3: Creating a connection factory</sup> <br><br>  Choose a friendly name ... <br><br><img src="https://habrastorage.org/webt/ac/d8/4p/acd84pxqwx4uu4unovfz1uubil8.png"><br>  <sup>Figure 4: Choosing the name of the connection factory</sup> <br><br>  ... and type <b>Queue Connection Factory</b> : <br><br><img src="https://habrastorage.org/webt/41/tl/lv/41tllv7t62nxpz6ovv694ckmeg4.png"><br>  <sup>Figure 5: Selecting the connection factory type</sup> <br><br>  Protocol - <b>MQ Client</b> to communicate with MQ remotely: <br><br><img src="https://habrastorage.org/webt/lf/hh/ue/lfhhuelb3jr90e1oux90syfsnvm.png"><br>  <sup>Figure 6: Selecting the connection factory protocol</sup> <br><br>  In the next step, you can select an existing factory and copy further settings from it.  Click <b>Next</b> , if there is none: <br><br><img src="https://habrastorage.org/webt/4b/w7/qc/4bw7qcrzsbpneieurkfajwprwm8.png"><br>  <sup>Figure 7: Choosing settings for an existing connection factory</sup> <br><br>  In the parameter selection window, just set three.  On the <b>Connection</b> tab, specify the name of the queue manager and stand ip with its location (leave port <b>1414</b> ): <br><br><img src="https://habrastorage.org/webt/q8/dy/_8/q8dy_8pnmrfqfzp0zyqkpg8o4lk.png"><br>  <sup>Figure 8: Configuring the connection factory settings</sup> <br><br>  And on the <b>Channels</b> tab - the channel for the connection.  Click <b>Finish</b> to complete: <br><br><img src="https://habrastorage.org/webt/j0/w_/ha/j0w_harmdbn-cp5llaeg-rn73pa.png"><br>  <sup>Figure 9: Completing the connection factory</sup> <br><br>  Now create a connection to the queue: <br><br><img src="https://habrastorage.org/webt/-r/w1/b7/-rw1b7zu5n-xv4xu_ou94xuqyy8.png"><br>  <sup>Figure 10: Creating a target</sup> <br><br>  Choose a friendly name (I prefer to specify the real name of the queue) and type <b>Queue</b> : <br><br><img src="https://habrastorage.org/webt/3o/3k/x8/3o3kx8mvfv4lwsgyyclxs_zfj14.png"><br>  <sup>Figure 11: Selecting the name and type of target</sup> <br><br>  Similar to <i>Figure 7,</i> you can copy settings from an existing queue.  Also click <b>Next</b> if it is the first: <br><br><img src="https://habrastorage.org/webt/ay/pf/zq/aypfzqpohkfqpg7-_fkigm5vmom.png"><br>  <sup>Figure 12: Selecting Present Target Settings</sup> <br><br>  In the settings window, just select the name of the manager and the desired queue, click <b>Finish</b> .  After that, repeat the required number of times until all the queues necessary for interacting with JMeter are created: <br><br><img src="https://habrastorage.org/webt/cg/yv/qx/cgyvqxujvofhsa2ko9j2zhwlk-q.png"><br>  <sup>Figure 13: Completing the creation of the target object</sup> <br><br><h4>  JMeter preparation </h4><br>  Preparing JMeter is to add the libraries necessary to interact with MQ.  They are located in% wmq_home% / java / lib.  Copy them to% jmeter_home% / lib / ext before running JMeter. <br><br><ul><li>  com.ibm.mq.commonservices.jar </li><li>  com.ibm.mq.headers.jar </li><li>  com.ibm.mq.jar </li><li>  com.ibm.mq.jmqi.jar </li><li>  com.ibm.mq.pcf.jar </li><li>  com.ibm.mqjms.jar </li><li>  dhbcore.jar </li><li>  fscontext.jar </li><li>  jms.jar </li><li>  jta.jar </li><li>  providerutil.jar </li></ul><br><br>  An alternative list suggested by <a href="https://habr.com/ru/users/polarnik/" class="user_link">polarnik</a> in a <a href="https://habr.com/ru/post/437172/">comment</a> with a slight nuance: javax.jms-api-2.0.jar instead of jms.jar. <br>  With jms.jar, the error NoClassDEfFoundError occurs, the solution of which is found <a href="https://stackoverflow.com/questions/46931561/upgrade-of-java-8-and-mq-noclassdeffounderror">here</a> . <br><br><ul><li>  com.ibm.mq.allclient.jar </li><li>  fscontext.jar </li><li>  javax.jms-api-2.0.jar </li><li>  providerutil.jar </li></ul><br><br>  Both library lists work successfully with JMeter 5.0 and IBM MQ 8.0.0.4. <br><br><h4>  Setting up a test plan </h4><br>  The necessary and sufficient set of JMeter elements is as follows: <br><br><img src="https://habrastorage.org/webt/le/yn/ii/leyniisl_c_7j4tuhrrrzkcvlmu.png"><br>  <sup>Figure 14: Test Plan</sup> <br><br>  In the sample test plan, there are five variables.  Despite the small number of them, I recommend having separate configuration elements for different types of variables.  As the test grows, this will greatly simplify navigation.  In this case, there are two lists.  The first one contains the parameters for connecting to MQ (see <i>Figure 2</i> and <i>Figure 4</i> ): <br><br><img src="https://habrastorage.org/webt/5c/7m/hs/5c7mhsdg58uwbrw3cs5zngxik1u.png"><br>  <sup>Figure 15: MQ Connection Settings</sup> <br><br>  The second is the names of targets that refer to queues: <br><br><img src="https://habrastorage.org/webt/co/aw/gb/coawgbuyeg3zu7k1kkwflc9yvwk.png"><br>  <sup>Figure 16: Parameterized Queue Names</sup> <br><br>  It remains to configure JMS Publisher to load the test message into the outgoing queue: <br><br><img src="https://habrastorage.org/webt/0i/k5/ls/0ik5lshjbfihp1qm20tpfl0oc2o.png"><br>  <sup>Figure 17: Configuring JMS Publisher</sup> <br><br>  And JMS Subscriber to read the message from the incoming queue: <br><br><img src="https://habrastorage.org/webt/az/z0/4i/azz04iww1sfoxupraa10iwlcxas.png"><br>  <sup>Figure 18: Configuring JMS Subscriber</sup> <br><br>  If everything is done correctly, the result of the execution in the listner will be filled with bright and cheerful green colors. <br><br><h4>  Conclusion </h4><br>  Intentionally lowered the issues of routing and administration, it is quite intimate and extensive topics for individual publications. <br><br>  In addition, there is a solid portion of the nuances in working with queues, databases and files, which I would also like to talk about separately and thoroughly. <br><br>  Take care of your time.  And thank you for your attention. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gw/-l/bs/gw-lbsso67kzbcmb8oibvw-pn1u.png" alt="image" width="400"></div></div><p>Source: <a href="https://habr.com/ru/post/437172/">https://habr.com/ru/post/437172/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>