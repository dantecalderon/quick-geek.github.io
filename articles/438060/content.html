<div class="post__text post__text-html js-mediator-article"><h2>  What are we talking about </h2><br>  The appearance on Habré of the <a href="https://habr.com/ru/post/255661/">post about Majvik's filter</a> was in its own way a symbolic event.  Apparently, the universal enthusiasm for drones has revived interest in the problem of estimating the orientation of a body from inertial measurements.  At the same time, traditional methods based on the Kalman filter have ceased to satisfy the public, either because of the high requirements for computing resources that are unacceptable for drones, or because of the complex and non-intuitive adjustment of parameters. <br><br>  The post was accompanied by a very compact and efficient implementation of the C filter. However, judging by the comments, the physical meaning of this code, as well as the whole article, remained vague for someone.  Well, let's face it honestly: the Madjwick filter is the most sophisticated of a group of filters based on very simple and elegant principles.  I will consider these principles in my post.  Code will not be here.  My post is not a story about a specific implementation of an orientation estimation algorithm, but rather an invitation to invent my own variations on a given topic, which can be very much. <br><br><img src="https://habrastorage.org/webt/lp/cl/le/lpclleof90lpwd-hoqa4kl5btpi.png" alt="image"><br><a name="habracut"></a><br><h2>  Orientation view </h2><br>  Recall the basics.  To estimate the orientation of a body in space, one must first choose some parameters that, in aggregate, uniquely determine this orientation, i.e.  essentially the orientation of the associated coordinate system <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.573ex" height="1.817ex" viewBox="0 -520.7 1538.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-79" x="572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-7A" x="1070" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> xyz </script>  relatively conditionally stationary system - for example, the NED (North, East, Down) geographic system.  Then you need to make kinematic equations, ie  express the rate of change of these parameters through the angular velocity from the gyroscopes.  Finally, vector measurements from accelerometers, magnetometers, etc. need to be included in the calculation.  Here are the most commonly used ways of representing orientation: <br><br>  <b><a href="https://en.wikipedia.org/wiki/Euler_angles">Euler angles</a></b> - roll (roll, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mtext" id="MJXp-Span-6">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.891ex" height="2.419ex" viewBox="0 -780.1 1675.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-69" x="1330" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ phi </script>  ), pitch (pitch, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ theta </script>  ) course (heading, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mtext" id="MJXp-Span-18">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.643ex" height="2.298ex" viewBox="0 -728.2 1568.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-73" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-69" x="1223" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ psi </script>  ).  This is the most obvious and most concise set of orientation parameters: the number of parameters is exactly equal to the number of rotational degrees of freedom.  For these angles, one can write <i>the Euler kinematic equations</i> .  They are very fond of theoretical mechanics, but in navigation problems they are of little use.  First, knowledge of angles does not allow direct transformation of the components of a vector from a bound to a geographic coordinate system or vice versa.  Secondly, with a pitch of ± 90 degrees, the kinematic equations degenerate, the list and course become uncertain. <br><br>  <b><a href="https://en.wikipedia.org/wiki/Rotation_matrix">Rotation Matrix</a></b> - Matrix <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mtext" id="MJXp-Span-23">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.072ex" height="2.419ex" viewBox="0 -780.1 4336.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-43" x="3576" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> \ mathbf {C} </script>  3 × 3, by which you need to multiply any vector in the associated coordinate system to get the same vector in the geographic system: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-32"><span class="MJXp-mtext" id="MJXp-Span-33">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mrow" id="MJXp-Span-41" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-43" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;">b </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56"><font style="vertical-align: inherit;">C</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;">b </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mrow" id="MJXp-Span-65" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;">r </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;">x </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;">y </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;">z</font></span></span></span></font><span class="MJXp-mtext" id="MJXp-Span-48">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mrow" id="MJXp-Span-65" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;"></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.945ex" height="2.66ex" viewBox="0 -780.1 16768.1 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><g transform="translate(3576,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-45" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-44" x="1653" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-3D" x="6159" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="7466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="8344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="8874" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="9235" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="9812" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="10241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-43" x="10792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="11802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="12681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="13210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="13572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="14148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="14578" y="0"></use><g transform="translate(15128,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-79" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-7A" x="1069" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ mathbf {r} _ {NED} = \ mathbf {C} \ mathbf {r} _ {xyz} </script>  .  The matrix is ​​always orthogonal, i.e. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mtext" id="MJXp-Span-72">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mrow" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86"><font style="vertical-align: inherit;">h </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87"><font style="vertical-align: inherit;">b </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mrow" id="MJXp-Span-90" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91"><font style="vertical-align: inherit;">C </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-92" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93"><font style="vertical-align: inherit;">T</font></span></span></span></font><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mrow" id="MJXp-Span-90" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-92" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93"><font style="vertical-align: inherit;"></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.663ex" height="2.901ex" viewBox="0 -987.6 10618.8 1249" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-43" x="3576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-3D" x="4614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="5920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="6799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="7328" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="7690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="8266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="8696" y="0"></use><g transform="translate(9246,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-54" x="1094" y="612"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> \ mathbf {C} = \ mathbf {C} ^ {T} </script>  .  The kinematic equation for it is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">t</span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mtext" id="MJXp-Span-100">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">f</span><span class="MJXp-mrow" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">C</span></span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-110">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">f</span><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">C</span></span><span class="MJXp-mtext" id="MJXp-Span-119">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">f</span><span class="MJXp-mrow" id="MJXp-Span-126"><span class="MJXp-mtext" id="MJXp-Span-127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.135ex" height="2.419ex" viewBox="0 -780.1 18572.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6F" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1259" y="0"></use><g transform="translate(1620,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-43" x="3576" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-3D" x="6234" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="7541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="8419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="8949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="9310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="9887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="10316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-43" x="10867" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="11877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="12756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="13285" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="13647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="14223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="14653" y="0"></use><g transform="translate(15203,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-4F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-65" x="1892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-67" x="2358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="2839" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8"> \ dot {\ mathbf {C}} = \ mathbf {C} \ mathbf {\ Omega} </script>  . <br>  Here <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mtext" id="MJXp-Span-134">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">f</span><span class="MJXp-mrow" id="MJXp-Span-141"><span class="MJXp-mtext" id="MJXp-Span-142">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.129ex" height="2.419ex" viewBox="0 -780.1 6944.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><g transform="translate(3576,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-4F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-65" x="1892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-67" x="2358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="2839" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-9"> \ mathbf {\ Omega} </script>  - the matrix of the components of the angular velocity measured by gyroscopes in the associated coordinate system: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-148"><span class="noError" id="MJXp-Span-149" style="display: inline-block;">\&nbsp;mathbf&nbsp;{\&nbsp;Omega}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{bmatrix}&nbsp;0&nbsp;&amp;&nbsp;-&nbsp;\&nbsp;omega_&nbsp;{z}&nbsp;&amp;&nbsp;\&nbsp;omega_&nbsp;{y}&nbsp;\\&nbsp;\&nbsp;omega_&nbsp;{z}&nbsp;&amp;&nbsp;0&nbsp;&amp;&nbsp;-&nbsp;\&nbsp;omega_&nbsp;{x}&nbsp;\\&nbsp;-&nbsp;\&nbsp;omega_&nbsp;{y&nbsp;}&nbsp;&amp;&nbsp;\&nbsp;omega_&nbsp;{x}&nbsp;&amp;&nbsp;0&nbsp;\\&nbsp;\&nbsp;end&nbsp;{bmatrix}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">\&nbsp;mathbf&nbsp;{\&nbsp;Omega}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{bmatrix}&nbsp;0&nbsp;&amp;&nbsp;-&nbsp;\&nbsp;omega_&nbsp;{z}&nbsp;&amp;&nbsp;\&nbsp;omega_&nbsp;{y}&nbsp;\\&nbsp;\&nbsp;omega_&nbsp;{z}&nbsp;&amp;&nbsp;0&nbsp;&amp;&nbsp;-&nbsp;\&nbsp;omega_&nbsp;{x}&nbsp;\\&nbsp;-&nbsp;\&nbsp;omega_&nbsp;{y&nbsp;}&nbsp;&amp;&nbsp;\&nbsp;omega_&nbsp;{x}&nbsp;&amp;&nbsp;0&nbsp;\\&nbsp;\&nbsp;end&nbsp;{bmatrix}</span></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \ mathbf {\ Omega} = \ begin {bmatrix} 0 & - \ omega_ {z} & \ omega_ {y} \\ \ omega_ {z} & 0 & - \ omega_ {x} \\ - \ omega_ {y } & \ omega_ {x} & 0 \\ \ end {bmatrix} </script></p><br>  The rotation matrix is ​​a little less obvious than the Euler angles, but unlike them it allows you to directly transform vectors and does not lose its meaning at any angular position.  From a computational point of view, its main drawback is redundancy: for the sake of three degrees of freedom, nine parameters are entered at once, and all of them need to be updated according to the kinematic equation.  The task can be slightly simplified by using the orthogonality of the matrix. <br><br>  <b><a href="https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation">Turn quaternion</a></b> is a radical, but very non-intuitive remedy against redundancy and degeneration.  This is a four component object. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">f</span><span class="MJXp-mrow" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">q</span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-164">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-169">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">f</span><span class="MJXp-mrow" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">i</span></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-182" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-183">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-184">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">f</span><span class="MJXp-mrow" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">j</span></span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-196" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-197">3</span></span></span><span class="MJXp-mtext" id="MJXp-Span-198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">f</span><span class="MJXp-mrow" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="57.248ex" height="2.419ex" viewBox="0 -780.1 24648.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="3576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-3D" x="4314" y="0"></use><g transform="translate(5370,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-30" x="631" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2B" x="6493" y="0"></use><g transform="translate(7493,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-31" x="631" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="8644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="9522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="10052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="10413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="10990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="11419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-69" x="11970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2B" x="12538" y="0"></use><g transform="translate(13538,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-32" x="631" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="14689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="15567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="16097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="16458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="17035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="17464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6A" x="18015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2B" x="18649" y="0"></use><g transform="translate(19650,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-33" x="631" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="20801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="21679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="22209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="22570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="23147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="23576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6B" x="24127" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> \ mathbf {q} = q_ {0} + q_ {1} \ mathbf {i} + q_ {2} \ mathbf {j} + q_ {3} \ mathbf {k} </script>  - not a number, not a vector and not a matrix.  Quaternion can be viewed from two angles.  First, as the formal amount of a scalar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-msubsup" id="MJXp-Span-208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-210" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-211">0</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.091ex" height="1.817ex" viewBox="0 -520.7 900.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-30" x="631" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> q_ {0} </script>  and vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-216">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-217">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">f</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">i</span></span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-229" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-230">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-231">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">f</span><span class="MJXp-mrow" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">j</span></span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-243" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-244">3</span></span></span><span class="MJXp-mtext" id="MJXp-Span-245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">f</span><span class="MJXp-mrow" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.843ex" height="2.419ex" viewBox="0 -780.1 17154.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-31" x="631" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="1150" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="2028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="2558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="3496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-69" x="4476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2B" x="5044" y="0"></use><g transform="translate(6044,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-32" x="631" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="7195" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="8073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="8603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="8964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="9541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="9970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6A" x="10521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2B" x="11155" y="0"></use><g transform="translate(12156,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-33" x="631" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="13307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="14185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="14715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="15076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="15653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="16082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6B" x="16633" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> q_ {1} \ mathbf {i} + q_ {2} \ mathbf {j} + q_ {3} \ mathbf {k} </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mtext" id="MJXp-Span-255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">f</span><span class="MJXp-mrow" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">i</span></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">f</span><span class="MJXp-mrow" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">j</span></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">f</span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.956ex" height="2.419ex" viewBox="0 -780.1 12897.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-69" x="3576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2C" x="3921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="5495" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="6024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="6386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="6962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="7392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6A" x="7942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2C" x="8355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="9050" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="9928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="10458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="10819" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="11396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="11825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6B" x="12376" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> \ mathbf {i}, \ mathbf {j}, \ mathbf {k} </script>  - single axis vectors (which, of course, sounds absurd).  Secondly, as a generalization of complex numbers, where now not one, but three <i>different</i> imaginary units are used. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-284"><span class="MJXp-mtext" id="MJXp-Span-285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">f</span><span class="MJXp-mrow" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">i</span></span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-295">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">f</span><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">j</span></span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-305">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">f</span><span class="MJXp-mrow" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.956ex" height="2.419ex" viewBox="0 -780.1 12897.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-69" x="3576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2C" x="3921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="5495" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="6024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="6386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="6962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="7392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6A" x="7942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMAIN-2C" x="8355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6D" x="9050" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-61" x="9928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-74" x="10458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-68" x="10819" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-62" x="11396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-66" x="11825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/438060/&amp;xid=17259,15700023,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhKujZ4QnysrCB3faArrGonzfJWtA#MJMATHI-6B" x="12376" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> \ mathbf {i}, \ mathbf {j}, \ mathbf {k} </script>  (which sounds no less absurd).  How is quaternion related to rotation?  Through the Euler theorem: a body can always be transferred from one given orientation to another with one final turn at some angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mtext" id="MJXp-Span-315">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> \ alpha </script>  around some axis with a guide vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-mtext" id="MJXp-Span-322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">f</span><span class="MJXp-mrow" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">u</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ mathbf {u} </script>  .  This angle and axis can be combined into a quaternion: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-331"><span class="MJXp-mtext" id="MJXp-Span-332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">f</span><span class="MJXp-mrow" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">q</span></span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">m</span><span class="MJXp-mrow" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">s</span></span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-354">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">a</span><span class="MJXp-mrow" id="MJXp-Span-360"><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-362">2</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">f</span><span class="MJXp-mrow" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">u</span></span><span class="MJXp-mtext" id="MJXp-Span-374">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">m</span><span class="MJXp-mrow" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">n</span></span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-386">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">a</span><span class="MJXp-mrow" id="MJXp-Span-392"><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-394">2</span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> \ mathbf {q} = \ mathrm {cos} (\ alpha / 2) + \ mathbf {u} \ mathrm {sin} (\ alpha / 2) </script>  .  Like the matrix, a quaternion can be used to directly transform any vector from one coordinate system to another: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-396"><span class="MJXp-mtext" id="MJXp-Span-397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">f</span><span class="MJXp-msubsup" id="MJXp-Span-404"><span class="MJXp-mrow" id="MJXp-Span-405" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">r</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-407" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">D</span></span></span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">f</span><span class="MJXp-mrow" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">q</span></span><span class="MJXp-mtext" id="MJXp-Span-421">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">f</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mrow" id="MJXp-Span-429" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">r</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-431" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">z</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-435"><span class="MJXp-mrow" id="MJXp-Span-436" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">f</span><span class="MJXp-mrow" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">q</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-446" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-447">−</span><span class="MJXp-mn" id="MJXp-Span-448">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ mathbf {r} _ {NED} = \ mathbf {q} \ mathbf {r} _ {xyz} {\ mathbf {q}} ^ {- 1} </script>  .  As you can see, the quaternionic representation of the orientation also suffers from redundancy, but much less than the matrix: the extra parameter is only one.  A detailed review of quaternions was already <a href="https://habr.com/ru/post/426863/">on Habré</a> .  They talked about geometry and 3D graphics.  We are also interested in kinematics, since the rate of change of the quaternion must be related to the measured angular velocity.  The corresponding kinematic equation is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-449"><span class="MJXp-mtext" id="MJXp-Span-450">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">t</span><span class="MJXp-mrow" id="MJXp-Span-454"><span class="MJXp-mtext" id="MJXp-Span-455">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">f</span><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">q</span></span></span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-465">1</span><span class="MJXp-mrow" id="MJXp-Span-466"><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-468">2</span><span class="MJXp-mtext" id="MJXp-Span-469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">f</span><span class="MJXp-mrow" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">q</span></span><span class="MJXp-mtext" id="MJXp-Span-478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">f</span><span class="MJXp-mrow" id="MJXp-Span-485"><span class="MJXp-mtext" id="MJXp-Span-486">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> \ dot {\ mathbf {q}} = 1/2 \ mathbf {q} \ mathbf {\ omega} </script>  where is the vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mtext" id="MJXp-Span-493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">f</span><span class="MJXp-mrow" id="MJXp-Span-500"><span class="MJXp-mtext" id="MJXp-Span-501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ mathbf {\ omega} </script>  also considered a quaternion with zero scalar part. <br><br><h2>  Filter schemes </h2><br>  The most naive approach to calculating an orientation is to arm yourself with a kinematic equation and update any set of parameters we like in accordance with it.  For example, if we selected a rotation matrix, then we can write a cycle with something like <code>C += С * Omega * dt</code> .  The result will disappoint.  Gyroscopes, especially MEMS, have large and unstable zero offsets — as a result, even at complete rest, the computed orientation will have an unlimited accumulating error (drift).  All the tricks invented by Mahoney, Majwick, and many others, not excluding me, were aimed at compensating for this drift by involving measurements from accelerometers, magnetometers, GNSS receivers, lags, etc.  Thus was born the whole family of orientation filters, based on a simple basic principle. <br><blockquote>  <b>The basic principle.</b>  To compensate for the orientation drift, add an additional control angular velocity to the angular velocity measured by the gyros, based on the vector measurements of other sensors.  The vector of control angular velocity must strive to combine the directions of the measured vectors with their known true directions. </blockquote>  Here a completely different approach is concluded than in the construction of the corrective addendum of the Kalman filter.  The main difference is that the controlling angular velocity is <i>not a term, but a factor</i> at the estimated value (matrix or quaternion).  From here important advantages follow: <br><br><ul><li>  The rating filter can be built for the orientation itself, and not for small deviations of the orientation from that given by the gyroscopes.  In this case, the estimated values ​​will automatically satisfy all the requirements imposed by the task: the matrix will be orthogonal, the quaternion will be normalized. </li><li>  The physical meaning of the control angular velocity is much clearer than the corrective term in the Kalman filter.  All manipulations are done with vectors and matrices in the usual three-dimensional physical space, and not in the abstract multi-dimensional state space.  This greatly simplifies the refinement and configuration of the filter, and as a bonus, it allows you to get rid of large-dimension matrices and heavy matrix libraries. </li></ul><br>  Now let's see how this idea is implemented in specific variants of filters. <br><br>  <b>Filter Mahoney.</b>  All the furious mathematics of the <a href="https://hal.archives-ouvertes.fr/hal-00488376/file/2007_Mahony.etal_TAC-06-396_v3.pdf">original article by Mahoney is</a> written to justify simple equations (32).  Rewrite them in our notation.  If we ignore the estimation of gyro zero offsets, then two key equations will remain - the actual kinematic equation for the rotation matrix (with the controlling angular velocity in the form of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mtext" id="MJXp-Span-508">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">f</span><span class="MJXp-msup" id="MJXp-Span-515"><span class="MJXp-mrow" id="MJXp-Span-516" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-517">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">a</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-523" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ mathbf {\ Omega} '</script>  ) and the law of formation of this very speed as a vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-524"><span class="MJXp-mtext" id="MJXp-Span-525">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">f</span><span class="MJXp-msup" id="MJXp-Span-532"><span class="MJXp-mrow" id="MJXp-Span-533" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-534">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">a</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-540" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ mathbf {\ omega} '</script>  .  Suppose, for simplicity, that there are no accelerations or magnetic pickups, and thanks to this, we can measure acceleration due to gravity. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-543">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">t</span><span class="MJXp-msubsup" id="MJXp-Span-547"><span class="MJXp-mrow" id="MJXp-Span-548" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-549">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">f</span><span class="MJXp-mrow" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-558" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">z</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> - \ hat {\ mathbf {g}} _ {xyz} </script>  from accelerometers and magnetic field strength of the Earth <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mtext" id="MJXp-Span-563">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">t</span><span class="MJXp-msubsup" id="MJXp-Span-567"><span class="MJXp-mrow" id="MJXp-Span-568" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-569">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">f</span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">m</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-578" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">z</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ hat {\ mathbf {m}} _ {xyz} </script>  from magnetometers.  Both vectors are measured by sensors in a connected coordinate system, and in a geographic system, their position is obviously known: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-584">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">f</span><span class="MJXp-msubsup" id="MJXp-Span-591"><span class="MJXp-mrow" id="MJXp-Span-592" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">g</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-594" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">D</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> - \ mathbf {g} _ {NED} </script>  pointing up <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mtext" id="MJXp-Span-599">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">f</span><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mrow" id="MJXp-Span-607" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">m</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-609" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">D</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ mathbf {m} _ {NED} </script>  - to magnetic north.  Then the Mahoney filter equation will look like this: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-613"><span class="MJXp-mtext" id="MJXp-Span-614">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">t</span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mtext" id="MJXp-Span-619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">f</span><span class="MJXp-mrow" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">C</span></span></span><span class="MJXp-mo" id="MJXp-Span-628" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-629">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">f</span><span class="MJXp-mrow" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">C</span></span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-639">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">f</span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mtext" id="MJXp-Span-647">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">a</span></span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-654">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">f</span><span class="MJXp-msup" id="MJXp-Span-661"><span class="MJXp-mrow" id="MJXp-Span-662" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-663">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">a</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-669" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-671" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">f</span><span class="MJXp-mrow" id="MJXp-Span-679"><span class="MJXp-mtext" id="MJXp-Span-680">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">g</span><span class="MJXp-msup" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-687" style="vertical-align: 0.5em;">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-691" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">g</span></span></span><span class="MJXp-mtext" id="MJXp-Span-693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">t</span><span class="MJXp-msubsup" id="MJXp-Span-697"><span class="MJXp-mrow" id="MJXp-Span-698" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-699">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">f</span><span class="MJXp-mrow" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-708" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">z</span></span></span><span class="MJXp-mtext" id="MJXp-Span-712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">s</span><span class="MJXp-mtext" id="MJXp-Span-718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">f</span><span class="MJXp-msubsup" id="MJXp-Span-725"><span class="MJXp-mrow" id="MJXp-Span-726" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">C</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-728" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">T</span></span></span><span class="MJXp-mtext" id="MJXp-Span-730">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">f</span><span class="MJXp-msubsup" id="MJXp-Span-737"><span class="MJXp-mrow" id="MJXp-Span-738" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">g</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-740" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">D</span></span></span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-747" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">m</span></span></span><span class="MJXp-mtext" id="MJXp-Span-749">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">t</span><span class="MJXp-msubsup" id="MJXp-Span-753"><span class="MJXp-mrow" id="MJXp-Span-754" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-755">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">f</span><span class="MJXp-mrow" id="MJXp-Span-762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">m</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-764" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">z</span></span></span><span class="MJXp-mtext" id="MJXp-Span-768">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">s</span><span class="MJXp-mtext" id="MJXp-Span-774">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">f</span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mrow" id="MJXp-Span-782" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">C</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-784" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">T</span></span></span><span class="MJXp-mtext" id="MJXp-Span-786">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">f</span><span class="MJXp-msubsup" id="MJXp-Span-793"><span class="MJXp-mrow" id="MJXp-Span-794" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">m</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-796" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">D</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> \ dot {\ mathbf {C}} = \ mathbf {C} (\ mathbf {\ Omega} + \ mathbf {\ Omega} ') \\ \ mathbf {\ omega'} = k_ {g} \ hat {\ mathbf {g}} _ {xyz} \ times \ mathbf {C} ^ {T} \ mathbf {g} _ {NED} + k_ {m} \ hat {\ mathbf {m}} _ {xyz} \ times \ mathbf {C} ^ {T} \ mathbf {m} _ {NED} </script></p>  Let's look closely at the second equation.  The first item on the right is a vector product.  The first factor in it is the measured acceleration of gravity, the second is the true one.  Since the factors must be in the same coordinate system, the second factor is converted to the connected system by multiplying by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-800"><span class="MJXp-mtext" id="MJXp-Span-801">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">f</span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mrow" id="MJXp-Span-809" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">C</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-811" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">T</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ mathbf {C} ^ {T} </script>  .  The angular velocity, constructed as a vector product, is perpendicular to the plane of the multiplier vectors.  It allows you to rotate the calculated position of the associated coordinate system until the multiplier vectors match in direction - then the vector product will be reset and the rotation will stop.  Coefficient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-813"><span class="MJXp-msubsup" id="MJXp-Span-814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-816" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">g</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> k_ {g} </script>  sets the stiffness of such feedback.  The second term performs a similar operation with a magnetic vector.  In fact, the Mahoney filter embodies a well-known thesis: the knowledge of two non-collinear vectors in two different coordinate systems allows you to uniquely restore the mutual orientation of these systems.  If there are more than two vectors, this will provide useful measurement redundancy.  If the vector is only one, then one rotational degree of freedom (motion around this vector) cannot be fixed.  For example, if only a vector is given <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-820">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">f</span><span class="MJXp-mrow" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> - \ mathbf {g} </script>  then you can adjust the drift of roll and pitch, but not the course. <br><br>  Of course, in the Mahoney filter it is not necessary to use the rotation matrix.  There are non-canonical quaternion variants. <br><br>  <b>Virtual gyro platform.</b>  In the Mahoney filter, we attached a control angular velocity. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-mtext" id="MJXp-Span-830">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">f</span><span class="MJXp-mrow" id="MJXp-Span-837"><span class="MJXp-mtext" id="MJXp-Span-838">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">g</span><span class="MJXp-msup" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-845" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> \ mathbf {\ omega '} </script>  to related coordinate system.  But you can attach it to the design position of the geographical coordinate system.  The kinematic equation will then take the form <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-846"><span class="MJXp-mtext" id="MJXp-Span-847">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">t</span><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-mtext" id="MJXp-Span-852">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">f</span><span class="MJXp-mrow" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">C</span></span></span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-862">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">f</span><span class="MJXp-mrow" id="MJXp-Span-869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">C</span></span><span class="MJXp-mtext" id="MJXp-Span-871">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">f</span><span class="MJXp-mrow" id="MJXp-Span-878"><span class="MJXp-mtext" id="MJXp-Span-879">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">a</span></span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-886">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">f</span><span class="MJXp-msup" id="MJXp-Span-893"><span class="MJXp-mrow" id="MJXp-Span-894" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-895">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">a</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-901" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mtext" id="MJXp-Span-902">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">f</span><span class="MJXp-mrow" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">C</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> \ dot {\ mathbf {C}} = \ mathbf {C} \ mathbf {\ Omega} - \ mathbf {\ Omega} '\ mathbf {C} </script></p>  It turns out that this approach opens the way to very fruitful physical analogies.  Suffice it to recall what the gyroscopic technique began with - curshers and inertial navigation systems based on a gyrostabilized platform in a gimbal. <br><br><img src="https://habrastorage.org/webt/fj/ka/hj/fjkahji9nc7fcrtisbvn_1af3ag.jpeg" alt="image"><br>  <i><a href="http://www.theairlinepilots.com/">www.theairlinepilots.com</a></i> <br><br>  The task of the platform there was the materialization of the geographical coordinate system.  The orientation of the carrier was measured relative to this platform by angle sensors on the suspension frames.  If the gyroscopes drifted, then the platform drifted after them, and errors accumulated in the readings of the angle sensors.  To eliminate these errors, feedback was introduced from accelerometers installed on the platform.  For example, the deviation of the platform from the horizon around the northern axis was perceived by the accelerometer of the eastern axis.  This signal allowed to set the control angular velocity <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-911"><span class="MJXp-mtext" id="MJXp-Span-912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">f</span><span class="MJXp-mrow" id="MJXp-Span-919"><span class="MJXp-mtext" id="MJXp-Span-920">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">g</span><span class="MJXp-msup" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-927" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> \ mathbf {\ omega '} </script>  returning the platform to the horizon. <br><br>  We can use the same visual concepts in our task.  The written kinematic equation must then be read as follows: the rate of change in orientation is the difference between two rotational movements — the absolute movement of the carrier (the first term) and the absolute movement of the virtual gyroplatform (the second term).  The analogy can be extended to the law of formation of the control angular velocity.  Vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-928"><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-930">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">t</span><span class="MJXp-msubsup" id="MJXp-Span-934"><span class="MJXp-mrow" id="MJXp-Span-935" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">f</span><span class="MJXp-mrow" id="MJXp-Span-943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-945" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">D</span></span></span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-951">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">f</span><span class="MJXp-mrow" id="MJXp-Span-958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">C</span></span><span class="MJXp-mtext" id="MJXp-Span-960">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">t</span><span class="MJXp-msubsup" id="MJXp-Span-964"><span class="MJXp-mrow" id="MJXp-Span-965" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">f</span><span class="MJXp-mrow" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-975" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">z</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> - \ hat {\ mathbf {g}} _ {NED} = - \ mathbf {C} \ hat {\ mathbf {g}} _ {xyz} </script>  personifies the testimony of accelerometers, supposedly standing on a gyro platform.  Then for physical reasons you can write: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-979"><span class="MJXp-mtext" id="MJXp-Span-980">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">g</span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-989">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">N</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">g</span><span class="MJXp-msubsup" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-995" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">g</span></span></span><span class="MJXp-mtext" id="MJXp-Span-997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">t</span><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mrow" id="MJXp-Span-1002" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">g</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1004" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">E</span></span></span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1007" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1008">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">g</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1017">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">E</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">g</span><span class="MJXp-msubsup" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1022" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">g</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1024">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">t</span><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mrow" id="MJXp-Span-1029" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">g</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1031" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">N</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> \ omega '_ {N} = - gk_ {g} \ hat {g} _ {E}, \; \ omega '_ {E} = gk_ {g} \ hat {g} _ {N} </script></p>  It would be possible to come to the exact same result in a formal way, having made vector multiplication in the spirit of the Mahoney filter, but now not in a connected, but in a geographical coordinate system.  Is it only necessary? <br><br>  The first hint of a useful analogy of platform and free-form inertial navigation appears, apparently, in the <a href="https://patents.google.com/patent/US4303978A/en">ancient patent of Boeing</a> .  Then this idea was actively developed by <a href="https://www.navtechgps.com/assets/1/7/1139.pdf">Salychev</a> , and more recently, by <a href="https://www.cambridge.org/core/journals/journal-of-navigation/article/simple-observer-for-gyro-and-accelerometer-biases-in-land-navigation-systems/F8F65D8F4AB70814288B34FC82EDB6E5">me too</a> .  The obvious advantages of this approach are: <br><br><ul><li>  The control angular velocity can be formed on the basis of clear physical principles. </li><li>  The horizontal and course channels, which are very different in their properties and methods of correction, are naturally separated.  In the filter Mahoney they are mixed. </li><li>  It is convenient to compensate for the effects of accelerations by attracting GNSS data, which are issued in geographic and not related axes. </li><li>  It is easy to generalize the algorithm to the case of high-precision inertial navigation, where the shape and rotation of the Earth must be taken into account.  How to do it in the Mahoney scheme, I can not imagine. </li></ul><br>  <b>Filter Majvika.</b>  Madzhvik chose a <a href="http://x-io.co.uk/res/doc/madgwick_internal_report.pdf">difficult path</a> .  If Mahoney, apparently, intuitively came to his decision, and then substantiated it mathematically, then Madjvik from the very beginning proved to be a formalist.  He undertook to solve the optimization problem.  He reasoned so.  Define the orientation with a quaternion of rotation.  In the ideal case, the estimated direction of some measurable vector (let it be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1035">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">f</span><span class="MJXp-mrow" id="MJXp-Span-1042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> - \ mathbf {g} </script>  ) coincides with the true.  Then it will be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-msubsup" id="MJXp-Span-1045"><span class="MJXp-mrow" id="MJXp-Span-1046" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-1047">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">f</span><span class="MJXp-mrow" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">q</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1056" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1057">−</span><span class="MJXp-mn" id="MJXp-Span-1058">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">f</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mrow" id="MJXp-Span-1067" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">g</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1069" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">D</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">f</span><span class="MJXp-mrow" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">q</span></span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1083">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">t</span><span class="MJXp-msubsup" id="MJXp-Span-1087"><span class="MJXp-mrow" id="MJXp-Span-1088" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-1089">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">f</span><span class="MJXp-mrow" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1098" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">z</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> {\ mathbf {q}} ^ {- 1} \ mathbf {g} _ {NED} \ mathbf {q} = \ hat {\ mathbf {g}} _ {xyz} </script>  .  In reality, this is not always achievable (especially if there are more than two vectors), but you can try to minimize the deviation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-mtext" id="MJXp-Span-1103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">f</span><span class="MJXp-mrow" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">F</span></span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1113"><span class="MJXp-mtext" id="MJXp-Span-1114">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">f</span><span class="MJXp-msubsup" id="MJXp-Span-1121"><span class="MJXp-mrow" id="MJXp-Span-1122" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">q</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1124" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1125">−</span><span class="MJXp-mn" id="MJXp-Span-1126">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">f</span><span class="MJXp-msubsup" id="MJXp-Span-1134"><span class="MJXp-mrow" id="MJXp-Span-1135" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">g</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1137" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">D</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">f</span><span class="MJXp-mrow" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">q</span></span></span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">t</span><span class="MJXp-msubsup" id="MJXp-Span-1155"><span class="MJXp-mrow" id="MJXp-Span-1156" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-1157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">f</span><span class="MJXp-mrow" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1166" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">z</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ mathbf {F} = {\ mathbf {q} ^ {- 1} \ mathbf {g} _ {NED} \ mathbf {q}} - \ hat {\ mathbf {g}} _ {xyz} </script>  from exact equality.  To do this, we introduce the criterion of minimization <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">E</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1173">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">c</span><span class="MJXp-mrow" id="MJXp-Span-1178"><span class="MJXp-mn" id="MJXp-Span-1179">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1180"><span class="MJXp-mn" id="MJXp-Span-1181">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1182"><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1184">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">f</span><span class="MJXp-mrow" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">F</span></span><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mrow" id="MJXp-Span-1194" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1196" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1197">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">w</span><span class="MJXp-mtext" id="MJXp-Span-1209">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">m</span><span class="MJXp-mrow" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">n</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> E = \ frac {1} {2} | \ mathbf {F} | ^ {2} \ rightarrow \ mathrm {min} </script></p>  Minimization requires a gradient descent — moving in small steps in the direction opposite to the gradient. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mtext" id="MJXp-Span-1221">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> \ nabla E </script>  i.e.  opposite to the fastest increasing function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> E </script>  .  By the way, Madzhvik makes a mistake: in all his works he does not enter at all <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> E </script>  and write insistently <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1232"><span class="MJXp-mtext" id="MJXp-Span-1233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">a</span><span class="MJXp-mtext" id="MJXp-Span-1239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">f</span><span class="MJXp-mrow" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">F</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ nabla \ mathbf {F} </script>  instead <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1248"><span class="MJXp-mtext" id="MJXp-Span-1249">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ nabla E </script>  , although it actually calculates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mtext" id="MJXp-Span-1257">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ nabla E </script>  . <br><br>  Gradient descent ultimately leads to the following condition: to compensate for orientation drift, you need to add to the rate of change of the quaternion from the kinematic equation a new negative term, proportional to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mtext" id="MJXp-Span-1265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ nabla E </script>  : <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1272"><span class="MJXp-mtext" id="MJXp-Span-1273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">t</span><span class="MJXp-mrow" id="MJXp-Span-1277"><span class="MJXp-mtext" id="MJXp-Span-1278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">f</span><span class="MJXp-mrow" id="MJXp-Span-1285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">q</span></span></span><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">c</span><span class="MJXp-mrow" id="MJXp-Span-1293"><span class="MJXp-mn" id="MJXp-Span-1294">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1295"><span class="MJXp-mn" id="MJXp-Span-1296">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">f</span><span class="MJXp-mrow" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">q</span></span><span class="MJXp-mtext" id="MJXp-Span-1306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">f</span><span class="MJXp-mrow" id="MJXp-Span-1313"><span class="MJXp-mtext" id="MJXp-Span-1314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">a</span></span><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1321">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">a</span><span class="MJXp-mtext" id="MJXp-Span-1326">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">c</span><span class="MJXp-mrow" id="MJXp-Span-1331"><span class="MJXp-mtext" id="MJXp-Span-1332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">E</span></span><span class="MJXp-mrow" id="MJXp-Span-1339"><span class="MJXp-mrow" id="MJXp-Span-1340"><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">E</span><span class="MJXp-mrow" id="MJXp-Span-1349"><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-48"> \ dot {\ mathbf {q}} = \ frac {1} {2} \ mathbf {q} \ mathbf {\ omega} - \ beta \ frac {\ nabla E} {| \ nabla E |} </script></p>  Here, Majvik deviates a little from our “basic principle”: he adds a corrective term not to the angular velocity, but to the rate of change of the quaternion, and this is not exactly the same thing.  As a result, it may be that the updated quaternion will cease to be single and, accordingly, will lose the ability to represent orientation.  Therefore, for the Majvik filter, artificial quaternion normalization is a vital operation, while for other filters it is desirable, not optional. <br><br><h2>  Impact of acceleration </h2><br>  Until now, it was assumed that there are no true accelerations and accelerometers measure only the acceleration of gravity <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1351"><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1353">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">f</span><span class="MJXp-mrow" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> - \ mathbf {g} </script>  .  This made it possible to obtain a vertical standard and, with its help, compensate for the roll and pitch drift.  However, in the general case, accelerometers, regardless of their principle of action, measure <i>apparent acceleration</i> - the vector difference between the true acceleration and the acceleration of free fall. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1362"><span class="MJXp-mtext" id="MJXp-Span-1363">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">f</span><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">f</span></span><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">f</span><span class="MJXp-mrow" id="MJXp-Span-1380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">a</span></span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">f</span><span class="MJXp-mrow" id="MJXp-Span-1390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> \ mathbf {f} = \ mathbf {a} - \ mathbf {g} </script>  .  The direction of apparent acceleration does not coincide with the vertical, and in the estimates of roll and pitch errors appear, caused by accelerations. <br><br>  This is easily illustrated using the analogy of a virtual gyro platform.  Its correction system is designed so that the platform stops at that angular position, in which the signals of accelerometers supposedly installed on it, i.e.  when measured vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1392"><span class="MJXp-mtext" id="MJXp-Span-1393">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">f</span><span class="MJXp-mrow" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">f</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> \ mathbf {f} </script>  becomes perpendicular to the axes of sensitivity of accelerometers.  If there is no acceleration, this position coincides with the horizon.  When horizontal accelerations occur, the gyro platform deflects.  It can be said that the gyroplatform is similar to a heavily damped pendulum or plumb. <br><br><img src="https://habrastorage.org/webt/eo/oq/a7/eooqa7bu1nsuk7q7mdm-ko2kcne.png" alt="image"><br><br>  In the comments to the post about the filter Majvika flashed the question of whether it is possible to hope that this filter is less susceptible to acceleration than, for example, the Mahoney filter.  Alas, all the filters described here exploit the same physical principles and therefore suffer from the same problems.  To deceive physics by mathematics is impossible.  What then to do? <br><br>  The easiest and rough way was invented back in the middle of the last century for aviation gyroverticules: to reduce or completely zero the control angular velocity in the presence of accelerations or angular velocity of the course (which indicates the entrance to the turn).  The same method can be transferred to the current freeware systems.  Accelerations should be judged by the values. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1402"><span class="MJXp-mtext" id="MJXp-Span-1403">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">t</span><span class="MJXp-msubsup" id="MJXp-Span-1407"><span class="MJXp-mrow" id="MJXp-Span-1408" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1410" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">t</span><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mrow" id="MJXp-Span-1418" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1420" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">E</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> \ hat {f} _ {N}, \ hat {f} _ {E} </script>  , but not <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1422"><span class="MJXp-mtext" id="MJXp-Span-1423">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">t</span><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mrow" id="MJXp-Span-1428" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1430" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1433">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">t</span><span class="MJXp-msubsup" id="MJXp-Span-1437"><span class="MJXp-mrow" id="MJXp-Span-1438" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1440" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">y</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> \ hat {f} _ {x}, \ hat {f} _ {y} </script>  which are in themselves a zero bend.  However in magnitude <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1442"><span class="MJXp-mtext" id="MJXp-Span-1443">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">t</span><span class="MJXp-msubsup" id="MJXp-Span-1447"><span class="MJXp-mrow" id="MJXp-Span-1448" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-1449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">f</span><span class="MJXp-mrow" id="MJXp-Span-1456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">f</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1458" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">D</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> \ hat {\ mathbf {f}} _ {NED} </script>  it is not always possible to distinguish the true accelerations from the projections of the acceleration of gravity, thereby caused by the inclination of the gyro platform that needs to be eliminated.  Therefore, the method does not work reliably - but does not require any additional sensors. <br><br>  A more accurate method is based on using external velocity measurements from a GNSS receiver.  If speed is known <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-mtext" id="MJXp-Span-1463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">f</span><span class="MJXp-mrow" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">v</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> \ mathbf {v} </script>  then it can be differentiated numerically and get true acceleration <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-mtext" id="MJXp-Span-1473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">t</span><span class="MJXp-mrow" id="MJXp-Span-1477"><span class="MJXp-mtext" id="MJXp-Span-1478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">f</span><span class="MJXp-mrow" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">v</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ dot {\ mathbf {v}} </script>  .  Then the difference <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mtext" id="MJXp-Span-1488">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">t</span><span class="MJXp-msubsup" id="MJXp-Span-1492"><span class="MJXp-mrow" id="MJXp-Span-1493" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-1494">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">f</span><span class="MJXp-mrow" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">f</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1503" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">D</span></span></span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1508">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">t</span><span class="MJXp-mrow" id="MJXp-Span-1512"><span class="MJXp-mtext" id="MJXp-Span-1513">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">f</span><span class="MJXp-mrow" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">v</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ hat {\ mathbf {f}} _ {NED} - \ dot {\ mathbf {v}} </script>  will be exactly equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1522"><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1524">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">t</span><span class="MJXp-msubsup" id="MJXp-Span-1528"><span class="MJXp-mrow" id="MJXp-Span-1529" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-1530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">f</span><span class="MJXp-mrow" id="MJXp-Span-1537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">g</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1539" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">D</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> - \ hat {\ mathbf {g}} _ {NED} </script>  regardless of carrier movement.  It can be used as a standard of the vertical.  For example, you can set the control angular velocity gyro in the form <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1543"><span class="MJXp-mtext" id="MJXp-Span-1544">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">g</span><span class="MJXp-msubsup" id="MJXp-Span-1549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1553">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">N</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">g</span><span class="MJXp-msubsup" id="MJXp-Span-1556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1558" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">g</span></span></span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">t</span><span class="MJXp-msubsup" id="MJXp-Span-1565"><span class="MJXp-mrow" id="MJXp-Span-1566" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1568" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">E</span></span></span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1571">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">t</span><span class="MJXp-msubsup" id="MJXp-Span-1575"><span class="MJXp-mrow" id="MJXp-Span-1576" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">v</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1578" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">E</span></span></span><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1582" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">g</span><span class="MJXp-msubsup" id="MJXp-Span-1588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1592">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">E</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">g</span><span class="MJXp-msubsup" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1598" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">g</span></span></span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1601">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">t</span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mrow" id="MJXp-Span-1606" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1608" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1611">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">t</span><span class="MJXp-msubsup" id="MJXp-Span-1615"><span class="MJXp-mrow" id="MJXp-Span-1616" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">v</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1618" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-59"> \ omega '_ {N} = gk_ {g} (\ hat {f} _ {E} - \ dot {v} _ {E}), \; \ omega '_ {E} = - gk_ {g} (\ hat {f} _ {N} - \ dot {v} _ {N}) </script></p><br><h2>  Sensor Zero Offsets </h2><br>  The sad feature of consumer-grade gyroscopes and accelerometers is the large volatility of zero offsets in time and temperature.  To eliminate them, it is not enough to have only factory or laboratory calibration - you need to reassess during operation. <br><br>  <b>Gyroscopes.</b>  Understand the zero offsets of the gyros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1621"><span class="MJXp-mtext" id="MJXp-Span-1622">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">a</span><span class="MJXp-mrow" id="MJXp-Span-1628"><span class="MJXp-mtext" id="MJXp-Span-1629">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">f</span><span class="MJXp-mrow" id="MJXp-Span-1636"><span class="MJXp-mtext" id="MJXp-Span-1637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">a</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> \ delta {\ mathbf {\ omega}} </script>  .  The calculated position of the associated coordinate system moves away from its true position with an angular velocity determined by two opposing factors — gyro zero shifts and an angular velocity control: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1643"><span class="MJXp-mtext" id="MJXp-Span-1644">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">a</span><span class="MJXp-mrow" id="MJXp-Span-1650"><span class="MJXp-mtext" id="MJXp-Span-1651">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">f</span><span class="MJXp-mrow" id="MJXp-Span-1658"><span class="MJXp-mtext" id="MJXp-Span-1659">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1666">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">f</span><span class="MJXp-mrow" id="MJXp-Span-1673"><span class="MJXp-mtext" id="MJXp-Span-1674">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">g</span><span class="MJXp-msup" id="MJXp-Span-1679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1681" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> \ delta {\ mathbf {\ omega}} - \ mathbf {\ omega '} </script>  .  If the correction system (for example, in the Mahoney filter) succeeded in stopping the care, then in the steady state it will be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1682"><span class="MJXp-mtext" id="MJXp-Span-1683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">a</span><span class="MJXp-mrow" id="MJXp-Span-1689"><span class="MJXp-mtext" id="MJXp-Span-1690">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">f</span><span class="MJXp-mrow" id="MJXp-Span-1697"><span class="MJXp-mtext" id="MJXp-Span-1698">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1705">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">f</span><span class="MJXp-mrow" id="MJXp-Span-1712"><span class="MJXp-mtext" id="MJXp-Span-1713">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">g</span><span class="MJXp-msup" id="MJXp-Span-1718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1720" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> \ delta {\ mathbf {\ omega}} = \ mathbf {\ omega '} </script>  .  In other words, in the control angular velocity <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1721"><span class="MJXp-mtext" id="MJXp-Span-1722">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">f</span><span class="MJXp-mrow" id="MJXp-Span-1729"><span class="MJXp-mtext" id="MJXp-Span-1730">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">g</span><span class="MJXp-msup" id="MJXp-Span-1735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1737" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> \ mathbf {\ omega '} </script>  enclosed information about an unknown active disturbance <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1738"><span class="MJXp-mtext" id="MJXp-Span-1739">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">a</span><span class="MJXp-mrow" id="MJXp-Span-1745"><span class="MJXp-mtext" id="MJXp-Span-1746">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">f</span><span class="MJXp-mrow" id="MJXp-Span-1753"><span class="MJXp-mtext" id="MJXp-Span-1754">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">a</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> \ delta {\ mathbf {\ omega}} </script>  .  Therefore, <i>compensatory estimation</i> can be applied: we do not know the magnitude of the disturbance directly, but we know what kind of corrective action is needed to balance it.  The estimation of gyro zero shifts is based on this.  For example, in Mahoney, the estimate is updated by law <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1760"><span class="MJXp-mtext" id="MJXp-Span-1761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">t</span><span class="MJXp-mrow" id="MJXp-Span-1765"><span class="MJXp-mtext" id="MJXp-Span-1766">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">t</span><span class="MJXp-mrow" id="MJXp-Span-1770"><span class="MJXp-mtext" id="MJXp-Span-1771">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">a</span><span class="MJXp-mtext" id="MJXp-Span-1777">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">f</span><span class="MJXp-mrow" id="MJXp-Span-1784"><span class="MJXp-mtext" id="MJXp-Span-1785">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">a</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1794" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">b</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1796">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">f</span><span class="MJXp-mrow" id="MJXp-Span-1803"><span class="MJXp-mtext" id="MJXp-Span-1804">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">g</span><span class="MJXp-msup" id="MJXp-Span-1809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1811" style="vertical-align: 0.5em;">′</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-65"> \ dot {\ hat {\ delta \ mathbf {\ omega}}} = k_ {b} \ mathbf {\ omega '} </script></p>  However, the result he gets is strange: the estimates reach 0.04 rad / s.  Even the nastiest gyros do not have this instability of zero offsets.  I suspect the problem is that Mahoney does not use GNSS or other external sensors - and is fully affected by the effects of accelerations.  Only on the vertical axis, where the accelerations do not harm, the assessment looks more or less sound: <br><br><img src="https://habrastorage.org/webt/yd/q6/lt/ydq6ltis0yxglurb6stghnn7mny.png" alt="image"><br>  <i>Mahony et al., 2008</i> <br><br>  <b>Accelerometers</b>  Rate accelerometer zero offset <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1812"><span class="MJXp-mtext" id="MJXp-Span-1813">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">a</span><span class="MJXp-mrow" id="MJXp-Span-1819"><span class="MJXp-mtext" id="MJXp-Span-1820">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">f</span><span class="MJXp-mrow" id="MJXp-Span-1827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">f</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ delta {\ mathbf {f}} </script>  much harder.  Information about them has to be extracted from the same control angular velocity. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1829"><span class="MJXp-mtext" id="MJXp-Span-1830">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">f</span><span class="MJXp-mrow" id="MJXp-Span-1837"><span class="MJXp-mtext" id="MJXp-Span-1838">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">g</span><span class="MJXp-msup" id="MJXp-Span-1843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1845" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> \ mathbf {\ omega '} </script>  .  However, in the rectilinear motion, the effect of zero displacement of accelerometers is indistinguishable from the slope of the carrier or the skewed installation of the sensor unit on it.  No addition to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1846"><span class="MJXp-mtext" id="MJXp-Span-1847">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">f</span><span class="MJXp-mrow" id="MJXp-Span-1854"><span class="MJXp-mtext" id="MJXp-Span-1855">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">g</span><span class="MJXp-msup" id="MJXp-Span-1860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1862" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> \ mathbf {\ omega '} </script>  accelerometers do not create.  The additive appears only at a turn, as allows to divide and independently estimate errors of gyroscopes and accelerometers.  An example of how this can be done is in <a href="https://www.cambridge.org/core/journals/journal-of-navigation/article/simple-observer-for-gyro-and-accelerometer-biases-in-land-navigation-systems/F8F65D8F4AB70814288B34FC82EDB6E5">my article</a> .  Here are pictures from there: <br><br><img src="https://habrastorage.org/webt/ym/wj/uw/ymwjuw7lhwbgxy8hiry4n4xtiec.png" alt="image"><br><br><h2>  Instead of a conclusion: what about the Kalman filter? </h2><br>  I have no doubt that the filters described here will almost always have an advantage over the traditional Kalman filter in terms of speed, compactness of the code and convenience of customization - for this they were created.  As for the accuracy of estimation, everything is not so clear.  I met the unsuccessfully designed Kalman filters, which, in terms of accuracy, lost noticeably to the filter with the virtual gyroplatform.  Madzhvik also argued the benefits of his filter with respect to <i>some</i> Kalman estimates.  However, for the same orientation estimation task, at least a dozen different Kalman filter schemes can be constructed, and each will have an infinite number of tuning options.  I have no reason to think that the Mahoney or Majvik filter will be more accurate than the <i>best possible</i> Kalman filter.  And of course, the Kalman approach will always remain the advantage of universality: it does not impose any rigid restrictions on the specific dynamic properties of the system being evaluated. </div>