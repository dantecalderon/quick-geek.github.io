<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exonum consensus: how it works</title>
  <meta name="description" content="Exonum TM is our open framework for creating private blockchains. Today we will tell how his consensus algorithm works. 

  
 Image: Bitfury 

 Why do...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Exonum consensus: how it works</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://exonum.com/">Exonum</a> <sup>TM</sup> is our open framework for creating private blockchains.  Today we will tell how his consensus algorithm works. <br><br> <a href="https://habr.com/ru/company/bitfury/blog/440586/"><img src="https://habrastorage.org/webt/nb/ew/8w/nbew8wre-yuufyvjl8xxtxvvphg.png"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>Image: <a href="https://bitfury.com/">Bitfury</a></i></font> <br><br><h2>  Why do we need consensus algorithms </h2><br>  Before turning to the story of how the Exonum <sup>TM</sup> consensus algorithm works, let's talk about why we need these algorithms in blockchains altogether. <br><br>  Blockchain is a distributed system without a central administrator.  To agree on the order of blocks (and, accordingly, transactions) network participants <a href="https://medium.com/swlh/blockchain-consensus-what-you-should-know-6b3c858d189a">use</a> special consensus algorithms.  The task of consensus is to help the peer-to-peer nodes to come to a common opinion about what its new state should be - that is, choose the next block in the blockchain chain. <br><br>  This is necessary in order to protect the blockchain and the information stored in it from being substituted.  For example, the blockchain on the basis of Exonum <sup>TM</sup> , implemented for Russian Railways, records information about operations with details for cars and trains.  Knowing that consensus ensures the accuracy of the data in the block, the company can follow the route of spare parts from the supplier and timely detect forgery.  More about this and other cases, we will continue. <br><br><h2>  What tasks we solved, creating an algorithm of consensus Exonum </h2><br>  Speaking of consensus, one of the first to come to mind is the Bitcoin-blockchain with its <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25BE%25D0%25BA%25D0%25B0%25D0%25B7%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE_%25D0%25B2%25D1%258B%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D1%258B">proof-of-work</a> (PoW) algorithm.  It requires the participants (miners) to perform complex mathematical operations for the selection of the block hash and the expenditure of computing system resources.  Thus, the participants of the Bitcoin network support its work by investing their own material resources.  Under such conditions, unfair online activity becomes unprofitable and costly. <br><br>  But despite the fact that Bitcoin is considered the most reliable of the existing distributed systems, its consensus cannot solve the problem of <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25B4%25D0%25B0%25D1%2587%25D0%25B0_%25D0%25B2%25D0%25B8%25D0%25B7%25D0%25B0%25D0%25BD%25D1%2582%25D0%25B8%25D0%25B9%25D1%2581%25D0%25BA%25D0%25B8%25D1%2585_%25D0%25B3%25D0%25B5%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B0%25D0%25BB%25D0%25BE%25D0%25B2">Byzantine node behavior</a> .  By Byzantine behavior, we understand malicious activity that could disrupt the operation of the consensus algorithm.  Such activities also include situations where nodes lose contact with the network or go offline. <br><br>  Back in the mid-80s, <a href="https://groups.csail.mit.edu/tds/papers/Lynch/MIT-LCS-TM-270.pdf">it was proved</a> that, in order to ensure the sustainability of a distributed system, it must work under partial synchronism.  In this case, the algorithm of consensus must have the following criteria: <br><br><ul><li>  <b>Liveness</b> - should be able to take a new block at any time. </li><li>  <b>Consistency</b> - the transaction database on all nodes of the network must be identical. </li><li>  <b>Censorship resistance</b> - the nodes should not give preference to any transactions or ignore them. </li></ul><br>  For a distributed network with a known number of participants, the most optimal consensus model is BFT ( <a href="https://en.wikipedia.org/wiki/Byzantine_fault_tolerance">byzantine fault tolerance</a> ).  It satisfies the requirements of partial synchronization of nodes and is able to maintain a stable network even if a third of its members are compromised.  For these reasons, it is the BFT model <a href="https://bitfury.com/content/downloads/wp_consensus_181227.pdf">that formed the basis of the</a> Exonum <sup>TM</sup> <a href="https://bitfury.com/content/downloads/wp_consensus_181227.pdf">consensus algorithm</a> . <br><br><h2>  How the Exonum Consensus Algorithm Works </h2><br>  There are three types of nodes in the Exonum blockchain: validators, auditors and light clients.  The first ones check the validity of transactions in new blocks, and the second - distribute the load on the network and control the work of validators.  As for light clients, they only provide network members with the opportunity to send transactions to the blockchain.  Light clients and auditors are not directly involved in the consensus algorithm, so we will not talk about them within the framework of this material. <br><br>  The task of validators is to vote for the inclusion of new blocks in the blockchain.  As we said above, the Exonum <sup>TM</sup> network can function stably even if a third of all the nodes are Byzantine.  Accordingly, to achieve consensus, the block must approve 2/3 of the blockchain network nodes.  And this statement can be confirmed mathematically. <br><br>  Suppose that there are h honest honest and f Byzantine nodes (faulty) in the network.  Then the total number of validators can be represented as N = h + f.  All validators vote for one of the two presented blocks, while they collect the votes of other participants and decide on the winner based on the threshold rule. <br><br><blockquote>  It says: the <b>number of votes for the winner must be greater than or equal to Œ± * N</b> , where Œ± is a number in the range from 0 to 1. Thus, an absolute majority of votes is achieved for Œ±&gt; 1/2. </blockquote><br>  At the end of the vote, each validator independently decides which of the two candidates has won.  However, validators may not decide who to vote for, if too few validators send their votes to the rest.  This can happen if Byzantine knots begin to send votes for different candidates to honest members of the network, trying to confuse them. <br><br>  To rule out such a situation, two conditions must be met: <br><br><ul><li>  Honest validators should be able to make a choice without the participation of Byzantine knots.  This condition is determined by the liveness property, which we talked about above.  Mathematically, it is expressed by the following inequality: h ‚â• Œ± * N. </li><li>  A candidate voted for by a minority of honest validators cannot overcome the threshold in Œ± * N. This is dictated by the consistency criterion.  The condition is expressed as: [h / 2] + f &lt;Œ± * N, where [h / 2] is the integer part of the number h / 2. </li></ul><br>  As a result, we obtain the following chain of inequalities: h&gt; 2f, Œ±&gt; 2/3, and N ‚â• 3f + 1. It follows that to confirm the block of transactions, it must receive two thirds of the validators. <br><br>  Next, let's talk about how the validators vote in the Exonum-blockchain.  In general, the scheme is as follows: <br><br><img src="https://habrastorage.org/webt/ec/iq/gx/eciqgxzxfgvxbvavqr3j5x49o50.png"><br><br>  The process of reaching a consensus begins with the fact that the main node - it is selected by a separate algorithm and changes regularly - forms a list of transactions that must be added to the blockchain (makes up the <b><i>proposal</i></b> ).  This list is then broadcast throughout the network to the validator nodes. <br><br>  Validators check the received message for correspondence to the serialization format.  If any errors are fixed, the node completely ignores the received message.  For example, the suggestion to add a block in the middle of a blockchain or re-record an already existing transaction will be ignored.  If everything is in order, then the voting stage begins - the validator nodes vote to add the block to the blockchain, broadcasting the <b><i>prevote</i></b> message. <br><br>  The node, whose offer has received two thirds of the approval from validators, is automatically blocked.  This state is called <i>proof-of-lock</i> .  The site loses the ability to vote for the proposals of other validators and cannot change its <b><i>proposal</i></b> . <br><br>  After the required number of votes from validators is dialed, the main node enters the approved transactions into a block and transmits a special message - <b><i>precommit</i></b> .  It contains a <a href="https://exonum.com/doc/version/latest/architecture/storage/">hash of the updated state of the blockchain</a> and indicates that the node is ready to add the proposed block to the chain.  At that moment, when most validators respond with a similar <b><i>precommit</i></b> message (with the same hash), the block is added to the blockchain.  Consensus is reached, and the procedure is repeated for each subsequent block. <br><br>  To improve the stability of the system, the validators periodically exchange two more messages - <b><i>Request</i></b> and <b><i>Block</i></b> .  The first is generated if the nodes lack any transaction data.  The second is needed to transfer information about a block of transactions to a node that is behind in time (for example, turned off), to synchronize the work of the entire network. <br><br>  To evaluate the consensus possibilities, we checked the work of the blockchain on the basis of two configurations: in one data center and several geographically distributed data centers.  During tests, the TPS parameter ‚Äî the number of transactions per second ‚Äî was estimated for different numbers of validators.  Next, we present graphs of network performance changes in blockchains for working with cryptocurrencies (black graph) and timestamps - timestamping (blue graph). <br><br><img src="https://habrastorage.org/webt/cu/gz/os/cugzosghbkq9ff0cvnz5ysjsk1a.png"><br>  <font color="#A9A9A9"><i>TPS as a function of the number of validators in the case of a single data center</i></font> <br><br><img src="https://habrastorage.org/webt/bc/ze/gy/bczegyazailtoztxqautkdxfgt8.png"><br>  <font color="#A9A9A9"><i>TPS as a function of the number of validators in the case of multiple data centers</i></font> <br><br>  On average, the Exonum blockchain was able to process from 2 to 13 thousand transactions per second, depending on the network configuration. <br><br><h2>  Where is Exonum already used? </h2><br>  The Exonum <sup>TM</sup> framework is used today in a variety of projects.  Last summer, together with Technoprom, we <a href="http://www.cnews.ru/news/line/2018-08-02_tehnoprom_razrabotal_blokchejnproekt_na_platforme">created a</a> special marketplace for Russian Railways.  In the Exonum-blockchain, operations with details for trains and the data sheets of each car are recorded.  This makes it possible to track the movement of all parts from official suppliers and detect forgeries. <br><br>  We also <a href="https://forklog.com/bitfury-i-universitet-sinergiya-zapustyat-obrazovatelnuyu-blokchejn-platformu/">launched an</a> educational blockchain project based on Synergy University.  The registry registers and stores all information about student performance: grades, exam results and diplomas.  According to our colleagues, this approach eliminates the possibility of making changes to the documents on education and helps to save on their archiving and certification. <br><br>  Even on the basis of Exonum <sup>TM</sup> we have <a href="https://www.aricent.com/news/new-research-shows-blockchain-speeds-product-development-mobile-operators">implemented a</a> series of pilot projects that accelerate the development and release of software.  Our partners from the engineering organization Aricent tested the framework for six months.  The blockchain approach to software development has increased programmer productivity and error correction. <br><br>  We <a href="https://www.eurekalert.org/pub_releases/2018-05/imi-lbg051118.php">started</a> another project together with a group of medical companies.  Including with a startup Insillico, where they apply deep training to search for new drugs.  Exonum will be the core of the ecosystem for sharing patient data.  The system will simplify clinical trials, as well as help with the analysis of medical records and DNA of patients.  As a result, doctors will be able to more quickly diagnose diseases and prescribe a more effective treatment. <br><br>  <i>We hope that our blockchain will find application in other tasks and in other industries.</i>  <i>We are currently working to integrate Exonum <sup>TM</sup> into systems for voting, auctions and digital rights management.</i>  <i>Demo some solutions are <a href="https://exonum.com/">on the official site</a> .</i> </div><p>Source: <a href="https://habr.com/ru/post/440586/">https://habr.com/ru/post/440586/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>