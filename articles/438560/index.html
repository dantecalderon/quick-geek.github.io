<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing XGBoost from scratch - part 1: decision trees</title>
  <meta name="description" content="Hi, Habr! 

 After numerous searches for high-quality guides on decision trees and ensemble algorithms (boosting, decisive forest, etc.) with their di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Writing XGBoost from scratch - part 1: decision trees</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/aj/ir/za/ajirza4_t3yxzdrsnidc72gclfs.png"><br><br>  Hi, Habr! <br><br>  After numerous searches for high-quality guides on decision trees and ensemble algorithms (boosting, decisive forest, etc.) with their direct implementation in programming languages, and without finding anything (whoever finds ‚Äî write in the comments, maybe I‚Äôll get something new) I decided to make my own guide how I would like it to be.  The task in words is simple, but as you know, the devil is in the details, of which there are a lot of algorithms with trees. <br><br>  Since the topic is quite extensive, it will be very difficult to fit everything into one article, so there will be two publications: the first is devoted to trees, and the second part will be devoted to the implementation of the gradient boosting algorithm.  All the material presented here is compiled and executed on the basis of open sources, my code, the code of colleagues and friends.  Immediately I warn you, there will be a lot of code. <br><br><img src="https://habrastorage.org/webt/ku/4l/s6/ku4ls6k2z6t-hibmqqupnfia7um.png"><br><a name="habracut"></a><br>  So you need to know and be able to learn how to write from scratch your ensemble algorithms with decision trees?  Since an ensemble of algorithms is nothing more than a composition of ‚Äúweak algorithms‚Äù, then to write a good ensemble requires good ‚Äúweak algorithms‚Äù, we will analyze them in detail in this article.  As the name implies, these are decisive trees, and moving from simple to complex, we will learn how to write them.  In this case, the emphasis will be placed directly on the implementation, the whole theory will be presented to a minimum, basically I will give references to materials for independent study. <br><br>  To assimilate the material, you need to understand how good or bad our algorithm is.  We will understand very simply - let's fix some specific data set and compare our algorithms with the algorithms of the trees from Sklearn (well, what about without this library).  We will compare many things: the complexity of the algorithm, the metrics on the data, the running time, etc. <br><br>  What is the decisive tree?  Very good material, where the principle of the work of the decision tree is explained, is contained <a href="https://github.com/Yorko/mlcourse.ai/blob/master/jupyter_russian/topic03_decision_trees_knn/topic3_trees_knn.ipynb">in the ODS course</a> (by the way, a cool course, I recommend to those who begin their acquaintance with ML). <br><br>  A very important clarification: in all the cases described below, all signs will be real, we will not do special transformations with data outside the algorithms (we are comparing algorithms, not datasets). <br><br>  Now let's learn how to solve a regression problem with decision trees.  As entropy we will use the <a href="https://en.wikipedia.org/wiki/Mean_squared_error">MSE</a> metric. <br><br>  We implement a very simple <code>RegressionTree</code> class, which is based on a recursive approach.  Intentionally we will start with a very inefficient, but easy to understand implementation of this class, in order to be able to further improve it. <br><br><h3>  1. Class RegressionTree () </h3><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RegressionTree</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">''' –ö–ª–∞—Å—Å RegressionTree —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö, –∫–æ–≥–¥–∞ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —É—Å–ª–æ–≤–∏—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ä–µ–∫—É—Ä—Å–∏–∏. '''</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, max_depth=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, n_epoch=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">, min_size=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">8</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' –û–±—ä—è–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å–∞. '''</span></span> self.max_depth = max_depth <span class="hljs-comment"><span class="hljs-comment"># –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ self.min_size = min_size # –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–¥–¥–µ—Ä–µ–≤–∞ self.value = 0 # –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ (—Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º –ª–∏—Å—Ç—å—è–º) self.feature_idx = -1 # –Ω–æ–º–µ—Ä –ª—É—á—à–µ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ self.feature_threshold = 0 # –∑–Ω–∞—á–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ self.left = None # –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ self.right = None # –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ def fit(self, X, y): ''' –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—É—á–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞. –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–º –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å. ''' # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è self.value = y.mean() base_error = ((y - self.value) ** 2).sum() error = base_error flag = 0 # –æ—à–∏–±–∫–∏ –≤ –ª–µ–≤–æ–º –∏ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ prev_error_left = base_error prev_error_right = 0 # –µ—Å–ª–∏ –¥–æ—à–ª–∏ –¥–æ –≥–ª—É–±–∏–Ω—ã 0 - –≤—ã—Ö–æ–¥–∏–º if self.max_depth &lt;= 1: return dim_shape = X.shape[1] # –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ª–µ–≤–æ–º –∏ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ left_value = 0 right_value = 0 # –Ω–∞—á–∏–Ω–∞–µ–º —Ü–∏–∫–ª –ø–æ –ø—Ä–∏–∑–Ω–∞–∫–∞–º for feat in range(dim_shape): # —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ idxs = np.argsort(X[:, feat]) # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—ç–º–ø–ª–æ–≤ –≤ –ª–µ–≤–æ–º –∏ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ N = X.shape[0] N1, N2 = N, 0 thres = 1 # –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø—Ä–∏–∑–Ω–∞–∫–∞ while thres &lt; N - 1: N1 -= 1 N2 += 1 idx = idxs[thres] x = X[idx, feat] # –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ if thres &lt; N - 1 and x == X[idxs[thres + 1], feat]: thres += 1 continue # –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è —É –Ω–∞—Å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ç–∞–∫–æ–≥–æ —Å–ø–ª–∏—Ç–∞ target_right = y[idxs][:thres] target_left = y[idxs][thres:] mean_right = y[idxs][:thres].mean(), mean_left = y[idxs][thres:].mean() # –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ —É–∂–µ –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –æ—à–∏–±–∫—É - # –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–¥–∏–∫—Ç—ã (—Å—Ä–µ–¥–Ω–µ–µ –≤ –ø–æ—Ç–æ–º–∫–∞—Ö) left_shape = target_left.shape[0] right_shape = target_right.shape[0] mean_left_array = [mean_left for _ in range(left_shape)] mean_right_array = [mean_right for _ in range(right_shape)] # —Å—á–∏—Ç–∞–µ–º –æ—à–∏–±–∫—É —Å–ª–µ–≤–∞ –∏ —Å–ø—Ä–∞–≤–∞ prev_error_left = N1/N * mse(target_left, mean_left_array) prev_error_right = N2/N * mse(target_right, mean_right_array) # –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ª–æ–≤–∏—è —Å–ø–ª–∏—Ç–∞, —Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º if (prev_error_left + prev_error_right &lt; error): if (min(N1,N2) &gt; self.min_size): self.feature_idx = feat self.feature_threshold = x left_value = mean_left right_value = mean_right flag = 1 error = prev_error_left + prev_error_right thres += 1 # –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ª—É—á—à–∏–π —Å–ø–ª–∏—Ç, –≤—ã—Ö–æ–¥–∏–º if self.feature_idx == -1: return # –¥–æ—à–ª–∏ —Å—é–¥–∞ - –µ—Å—Ç—å —Ö–æ—Ä–æ—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ, –Ω—É–∂–Ω–æ –æ–±—É—á–∞—Ç—å –¥–∞–ª—å—à–µ # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Ç–æ–º–∫–æ–≤ - —Ç–µ –∂–µ –¥–µ—Ä–µ–≤—å—è —Ä–µ—à–µ–Ω–∏–π self.left = RegressionTree(self.max_depth - 1) self.left.value = left_value self.right = RegressionTree(self.max_depth - 1) self.right.value = right_value # –∏–Ω–¥–µ–∫—Å—ã –ø–æ—Ç–æ–º–∫–æ–≤ idxs_l = (X[:, self.feature_idx] &gt; self.feature_threshold) idxs_r = (X[:, self.feature_idx] &lt;= self.feature_threshold) # –æ–±—É—á–∞–µ–º self.left.fit(X[idxs_l, :], y[idxs_l]) self.right.fit(X[idxs_r, :], y[idxs_r]) def __predict(self, x): ''' –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è - —Å–º–æ—Ç—Ä–∏–º —É–∑–ª—ã, –∏–¥–µ–º –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ—Ç–æ–º–∫–æ–≤ –∏ —Å–º–æ—Ç—Ä–∏–º –≤ –∫–æ–Ω—Ü–µ self.value - —ç—Ç–æ –∏ –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç–æ–º. ''' if self.feature_idx == -1: return self.value if x[self.feature_idx] &gt; self.feature_threshold: return self.left.__predict(x) else: return self.right.__predict(x) def predict(self, X): ''' –ü—Ä–µ–¥–∏–∫—Ç –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã - –ø—Ä–æ—Å—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ—á–∫–∏ –≤—ã–∑—ã–≤–∞–µ–º __predict(). ''' y = np.zeros(X.shape[0]) for i in range(X.shape[0]): y[i] = self.__predict(X[i]) return y</span></span></code> </pre><br>  Briefly explain what each method does here. <br><br>  The <code>fit</code> method, as the name implies, teaches the model.  The training sample is sent to the input and the tree learning procedure takes place.  Sorting signs, we are looking for the best partitioning of the tree in terms of reduced entropy, in this case <code>mse</code> .  Determining that we managed to find a good split is very simple; two conditions are enough.  We do not want few objects to fall into the partition (protection against retraining), and the weighted average error by <code>mse</code> must be less than the error that is now in the tree - we are looking for that very increase in <a href="https://en.wikipedia.org/wiki/Information_gain_in_decision_trees">information gain</a> .  Having thus all the signs and all the unique values ‚Äã‚Äãfor them, we will sort out all the options and choose the best partition.  And further we do the recursive call on the received partitions until the conditions for exit from recursion are fulfilled. <br><br>  The <code>__predict</code> method, as the name implies, makes a prediction.  Having received an object as input, it goes along the nodes of the obtained tree - each node has a sign number and a value on it, and depending on what value the incoming method of the object has on this sign, we go either to the right descendant or to the left, until we reach the sheet, in which will be the answer for this object. <br><br>  The <code>predict</code> method does the same as the last method, only for a group of objects. <br><br>  We import a well-known set of data on homes in California.  This is a common dataset with data and target for solving a regression problem. <br><br><pre> <code class="python hljs">data = datasets.fetch_california_housing() X = np.array(data.data) y = np.array(data.target)</code> </pre><br>  Well, let's start the comparison!  First, let's see how fast the algorithm learns.  We will set a single parameter <code>max_depth</code> in ourselves and in Sklearn, let it be equal to 2. <br><br><pre> <code class="python hljs">%%time A = RegressionTree(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-comment"><span class="hljs-comment"># —ç—Ç–æ –Ω–∞—à –∞–ª–≥–æ—Ä–∏—Ç–º A.fit(X,y)</span></span></code> </pre> <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.tree <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DecisionTreeRegressor %%time model = DecisionTreeRegressor(max_depth=<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-comment"><span class="hljs-comment"># –∏–∑ Sklearn model.fit(X,y)</span></span></code> </pre> <br>  The following is displayed: <br><br><ul><li>  For our algorithm, CPU times: user 4min 47s, sys: 8.25 ms, total: 4min 47s <br>  Wall time: 4min 47s </li><li>  For Sklearn - CPU times: user 53.5 ms, sys: 0 ns, total: 53.5 ms <br>  Wall time: 53.4 ms </li></ul><br>  As you can see, the algorithm learns thousands of times more slowly.  What is the reason?  Let's figure it out. <br><br>  Recall how the procedure for finding the best partition is arranged.  As is known, in the general case, with the size of objects <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> N </script>  and with the number of signs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.057ex" viewBox="0 -780.1 523.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-64" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> d </script>  , the difficulty of finding the best split is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">O</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">N</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">N</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">d</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.252ex" height="2.66ex" viewBox="0 -832 6997.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-2217" x="2263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-6C" x="2986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-6F" x="3284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-67" x="3770" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-4E" x="4250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-2217" x="5361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-64" x="6084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-29" x="6607" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> O (N * logN * d) </script>  . <br><br>  Where does this complexity come from? <br><br>  First, in order to effectively recalculate the error, it is necessary to sort all the columns before passing by the feature in order to move from the smallest to the largest.  Since we do this for every attribute, this creates an appropriate complexity.  As you can see, we sort the signs, but the whole trouble lies in recalculating the error - every time we drive the data into the <code>mse</code> method, which works beyond the line.  This makes the error recalculation so inefficient!  After all, then the difficulty of finding a split increases to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">O</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-22" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">d</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.17ex" height="2.901ex" viewBox="0 -935.7 4378.9 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-2217" x="2743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMATHI-64" x="3465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/438560/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjN5Daz1uZX5lqEoIeqNq__i0SuhA#MJMAIN-29" x="3989" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> O (N ^ 2 * d) </script>  that when large <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> N </script>  tremendously slows down the algorithm.  Therefore, smoothly proceed to the next item. <br><br><h3>  2. RegressionTree () class with quick error recalculation </h3><br>  What should I do to quickly recalculate the error?  Take a pen and paper, and paint how we should change the formulas. <br><br>  For example, at some step there is already an error calculated for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-28"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> N </script>  objects.  It has the following formula: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-mtext" id="MJXp-Span-31">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">u</span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-36"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">i</span><span class="MJXp-mo" id="MJXp-Span-38">=</span><span class="MJXp-mn" id="MJXp-Span-39">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-44" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-46">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">c</span><span class="MJXp-mrow" id="MJXp-Span-51"><span class="MJXp-mtext" id="MJXp-Span-52">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">u</span><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">i</span><span class="MJXp-mo" id="MJXp-Span-59">=</span><span class="MJXp-mn" id="MJXp-Span-60">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-64" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ sum_ {i = 1} ^ n (y_i - \ frac {\ sum_ {i = 1} ^ N y_i} {N}) ^ 2 </script>  .  Here it is necessary to divide by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> N </script>  but for now let's put it down.  We want to quickly get this error - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">u</span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">N</span><span class="MJXp-mo" id="MJXp-Span-84">‚àí</span><span class="MJXp-mn" id="MJXp-Span-85">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">i</span><span class="MJXp-mo" id="MJXp-Span-80">=</span><span class="MJXp-mn" id="MJXp-Span-81">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-89" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-91">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">c</span><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mtext" id="MJXp-Span-97">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">u</span><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">N</span><span class="MJXp-mo" id="MJXp-Span-108">‚àí</span><span class="MJXp-mn" id="MJXp-Span-109">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">i</span><span class="MJXp-mo" id="MJXp-Span-104">=</span><span class="MJXp-mn" id="MJXp-Span-105">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">N</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-116">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-119" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ sum_ {i = 1} ^ {N-1} (y_i - \ frac {\ sum_ {i = 1} ^ {N-1} y_i} {N-1}) ^ 2 </script>  , that is, let's throw the error that the element introduces <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-msubsup" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-123" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> y_i </script>  in another part. <br><br>  Since we are throwing the object, the error must be recalculated in two places - on the right side (excluding this object), and on the left side (taking this object into account).  But without loss of generality, we derive only one formula, since they will be similar. <br><br>  Since we work with <code>mse</code> , we are not lucky: it‚Äôs quite difficult to derive a quick error recalculation, but when working with other metrics (for example, the Gini criterion, if we solve the classification problem), the quick recalculation output is much easier. <br><br>  Well, let's begin to derive formulas! <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-124"><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">u</span><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">i</span><span class="MJXp-mo" id="MJXp-Span-132">=</span><span class="MJXp-mn" id="MJXp-Span-133">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-138" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">c</span><span class="MJXp-mrow" id="MJXp-Span-145"><span class="MJXp-mtext" id="MJXp-Span-146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">u</span><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">i</span><span class="MJXp-mo" id="MJXp-Span-153">=</span><span class="MJXp-mn" id="MJXp-Span-154">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-163" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">u</span><span class="MJXp-msubsup" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">N</span><span class="MJXp-mo" id="MJXp-Span-176">‚àí</span><span class="MJXp-mn" id="MJXp-Span-177">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">i</span><span class="MJXp-mo" id="MJXp-Span-172">=</span><span class="MJXp-mn" id="MJXp-Span-173">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-181" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">c</span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mtext" id="MJXp-Span-189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">u</span><span class="MJXp-msubsup" id="MJXp-Span-192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">i</span><span class="MJXp-mo" id="MJXp-Span-196">=</span><span class="MJXp-mn" id="MJXp-Span-197">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-201" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-206" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-211" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">c</span><span class="MJXp-mrow" id="MJXp-Span-218"><span class="MJXp-mtext" id="MJXp-Span-219">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">u</span><span class="MJXp-msubsup" id="MJXp-Span-222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">i</span><span class="MJXp-mo" id="MJXp-Span-226">=</span><span class="MJXp-mn" id="MJXp-Span-227">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-231" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-236" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> \ sum_ {i = 1} ^ N (y_i - \ frac {\ sum_ {i = 1} ^ N y_i} {N}) ^ 2 = \ sum_ {i = 1} ^ {N-1} (y_i - \ frac {\ sum_ {i = 1} ^ N y_i} {N}) ^ 2 + (y_N - \ frac {\ sum_ {i = 1} ^ N y_i} {N}) ^ 2 </script></p><br>  Let's write out the first member: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-237"><span class="MJXp-mtext" id="MJXp-Span-238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">u</span><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">N</span><span class="MJXp-mo" id="MJXp-Span-249">‚àí</span><span class="MJXp-mn" id="MJXp-Span-250">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">i</span><span class="MJXp-mo" id="MJXp-Span-245">=</span><span class="MJXp-mn" id="MJXp-Span-246">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-254" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-256">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">c</span><span class="MJXp-mrow" id="MJXp-Span-261"><span class="MJXp-mtext" id="MJXp-Span-262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">u</span><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">i</span><span class="MJXp-mo" id="MJXp-Span-269">=</span><span class="MJXp-mn" id="MJXp-Span-270">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-274" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-279" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-281">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">u</span><span class="MJXp-msubsup" id="MJXp-Span-284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">N</span><span class="MJXp-mo" id="MJXp-Span-292">‚àí</span><span class="MJXp-mn" id="MJXp-Span-293">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">i</span><span class="MJXp-mo" id="MJXp-Span-288">=</span><span class="MJXp-mn" id="MJXp-Span-289">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-297" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-299">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">c</span><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mtext" id="MJXp-Span-305">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">u</span><span class="MJXp-msubsup" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">N</span><span class="MJXp-mo" id="MJXp-Span-316">‚àí</span><span class="MJXp-mn" id="MJXp-Span-317">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">i</span><span class="MJXp-mo" id="MJXp-Span-312">=</span><span class="MJXp-mn" id="MJXp-Span-313">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-320" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-324" style="vertical-align: -0.4em;">N</span></span></span><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-327"><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-329" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-331" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">u</span><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">N</span><span class="MJXp-mo" id="MJXp-Span-343">‚àí</span><span class="MJXp-mn" id="MJXp-Span-344">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">i</span><span class="MJXp-mo" id="MJXp-Span-339">=</span><span class="MJXp-mn" id="MJXp-Span-340">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">c</span><span class="MJXp-mrow" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">N</span><span class="MJXp-msubsup" id="MJXp-Span-353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-355" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-357">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">u</span><span class="MJXp-msubsup" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">N</span><span class="MJXp-mo" id="MJXp-Span-368">‚àí</span><span class="MJXp-mn" id="MJXp-Span-369">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">i</span><span class="MJXp-mo" id="MJXp-Span-364">=</span><span class="MJXp-mn" id="MJXp-Span-365">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-372" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">N</span></span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-376">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">c</span><span class="MJXp-mrow" id="MJXp-Span-381"><span class="MJXp-msubsup" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-384" style="vertical-align: -0.4em;">N</span></span></span><span class="MJXp-mrow" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-387"><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-389" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-391" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">u</span><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">N</span><span class="MJXp-mo" id="MJXp-Span-403">‚àí</span><span class="MJXp-mn" id="MJXp-Span-404">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">i</span><span class="MJXp-mo" id="MJXp-Span-399">=</span><span class="MJXp-mn" id="MJXp-Span-400">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">c</span><span class="MJXp-mrow" id="MJXp-Span-411"><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">N</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-415">1</span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-419" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-421">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">u</span><span class="MJXp-msubsup" id="MJXp-Span-424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">N</span><span class="MJXp-mo" id="MJXp-Span-432">‚àí</span><span class="MJXp-mn" id="MJXp-Span-433">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">i</span><span class="MJXp-mo" id="MJXp-Span-428">=</span><span class="MJXp-mn" id="MJXp-Span-429">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">N</span></span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-440">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">c</span><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-msubsup" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-448" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-457" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-459" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">u</span><span class="MJXp-msubsup" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">N</span><span class="MJXp-mo" id="MJXp-Span-470">‚àí</span><span class="MJXp-mn" id="MJXp-Span-471">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">i</span><span class="MJXp-mo" id="MJXp-Span-466">=</span><span class="MJXp-mn" id="MJXp-Span-467">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">c</span><span class="MJXp-mrow" id="MJXp-Span-478"><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">N</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-482">1</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-486" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-488">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">u</span><span class="MJXp-msubsup" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">N</span><span class="MJXp-mo" id="MJXp-Span-499">‚àí</span><span class="MJXp-mn" id="MJXp-Span-500">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">i</span><span class="MJXp-mo" id="MJXp-Span-495">=</span><span class="MJXp-mn" id="MJXp-Span-496">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-503" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-506"><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-508" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-510">2</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-512">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">c</span><span class="MJXp-mrow" id="MJXp-Span-517"><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">N</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-521">1</span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-527">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">u</span><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">N</span><span class="MJXp-mo" id="MJXp-Span-538">‚àí</span><span class="MJXp-mn" id="MJXp-Span-539">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">i</span><span class="MJXp-mo" id="MJXp-Span-534">=</span><span class="MJXp-mn" id="MJXp-Span-535">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-542" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">N</span></span><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-546">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">c</span><span class="MJXp-mrow" id="MJXp-Span-551"><span class="MJXp-msubsup" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-554" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-558" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">N</span></span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-563">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">c</span><span class="MJXp-mrow" id="MJXp-Span-568"><span class="MJXp-msubsup" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-571" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-575" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-578"><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-580" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-582" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">u</span><span class="MJXp-msubsup" id="MJXp-Span-586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">N</span><span class="MJXp-mo" id="MJXp-Span-594">‚àí</span><span class="MJXp-mn" id="MJXp-Span-595">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">i</span><span class="MJXp-mo" id="MJXp-Span-590">=</span><span class="MJXp-mn" id="MJXp-Span-591">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-597">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">c</span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">N</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-606">1</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-610" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-612">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">u</span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">N</span><span class="MJXp-mo" id="MJXp-Span-623">‚àí</span><span class="MJXp-mn" id="MJXp-Span-624">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">i</span><span class="MJXp-mo" id="MJXp-Span-619">=</span><span class="MJXp-mn" id="MJXp-Span-620">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-627" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-630"><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-632" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-634">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">u</span><span class="MJXp-msubsup" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">N</span><span class="MJXp-mo" id="MJXp-Span-645">‚àí</span><span class="MJXp-mn" id="MJXp-Span-646">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">i</span><span class="MJXp-mo" id="MJXp-Span-641">=</span><span class="MJXp-mn" id="MJXp-Span-642">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-648">2</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">c</span><span class="MJXp-mrow" id="MJXp-Span-655"><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">N</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-659">1</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-663" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-665">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">u</span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">N</span><span class="MJXp-mo" id="MJXp-Span-676">‚àí</span><span class="MJXp-mn" id="MJXp-Span-677">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">i</span><span class="MJXp-mo" id="MJXp-Span-672">=</span><span class="MJXp-mn" id="MJXp-Span-673">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-680" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">N</span></span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-684">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">c</span><span class="MJXp-mrow" id="MJXp-Span-689"><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-692" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-696" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">N</span></span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-701">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">c</span><span class="MJXp-mrow" id="MJXp-Span-706"><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-709" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-716"><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-718" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-721" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-722">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">u</span><span class="MJXp-msubsup" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">N</span><span class="MJXp-mo" id="MJXp-Span-733">‚àí</span><span class="MJXp-mn" id="MJXp-Span-734">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">i</span><span class="MJXp-mo" id="MJXp-Span-729">=</span><span class="MJXp-mn" id="MJXp-Span-730">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-736">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">c</span><span class="MJXp-mrow" id="MJXp-Span-741"><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">N</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-745">1</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-749" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-751">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">u</span><span class="MJXp-msubsup" id="MJXp-Span-754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">N</span><span class="MJXp-mo" id="MJXp-Span-762">‚àí</span><span class="MJXp-mn" id="MJXp-Span-763">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">i</span><span class="MJXp-mo" id="MJXp-Span-758">=</span><span class="MJXp-mn" id="MJXp-Span-759">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-766" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">N</span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-770">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-771"><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-773" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-776">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">c</span><span class="MJXp-mrow" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">N</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-784">1</span></span><span class="MJXp-mrow" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-787"><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-789" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-791">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">u</span><span class="MJXp-msubsup" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">N</span><span class="MJXp-mo" id="MJXp-Span-802">‚àí</span><span class="MJXp-mn" id="MJXp-Span-803">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">i</span><span class="MJXp-mo" id="MJXp-Span-798">=</span><span class="MJXp-mn" id="MJXp-Span-799">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-805">2</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-807">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">c</span><span class="MJXp-mrow" id="MJXp-Span-812"><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">N</span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-816">1</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-820" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-822">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">u</span><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">N</span><span class="MJXp-mo" id="MJXp-Span-833">‚àí</span><span class="MJXp-mn" id="MJXp-Span-834">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">i</span><span class="MJXp-mo" id="MJXp-Span-829">=</span><span class="MJXp-mn" id="MJXp-Span-830">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-837" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">N</span></span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-841">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">c</span><span class="MJXp-mrow" id="MJXp-Span-846"><span class="MJXp-msubsup" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-849" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">N</span></span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mspace" id="MJXp-Span-857" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">c</span><span class="MJXp-mrow" id="MJXp-Span-865"><span class="MJXp-msubsup" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-868" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-872" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mo" id="MJXp-Span-876" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-877" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \ sum_ {i = 1} ^ {N-1} (y_i - \ frac {\ sum_ {i = 1} ^ N y_i} {N}) ^ 2 = \ sum_ {i = 1} ^ {N-1 } (y_i - \ frac {\ sum_ {i = 1} ^ {N-1} y_i + y_N} {N}) ^ 2 = \\ \ sum_ {i = 1} ^ {N-1} (\ frac { Ny_i - \ sum_ {i = 1} ^ {N-1} y_i} {N} - \ frac {y_N} {N}) ^ 2 = \\ \ sum_ {i = 1} ^ {N-1} (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N} - \ frac {y_N - y_i} {N}) ^ 2 = \\ sum_ {i = 1 } ^ {N-1} (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N}) ^ 2 - 2 (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N}) \ frac {y_N - y_i} {N} + (\ frac {y_N - y_i} {N}) ^ 2 = \\ \ sum_ {i = 1} ^ {N-1} (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N}) ^ 2 - \ sum_ {i = 1} ^ {N-1} (2 (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N}) \ frac {y_N - y_i} {N} - (\ frac {y_N - y_i} {N}) ^ 2) = \\ \ sum_ {i = 1} ^ {N-1} (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N-1}) ^ 2 * (\ frac {N-1} {N}) ^ 2 - \ sum_ {i = 1} ^ {N-1} (2 (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N}) \ frac {y_N - y_i} {N} - \\ - (\ frac {y_N - y_i} { N}) ^ 2) </script></p><br>  Phew, just a little bit left.  It remains only to express the required amount. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-879"><span class="MJXp-mtext" id="MJXp-Span-880">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">u</span><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">i</span><span class="MJXp-mo" id="MJXp-Span-887">=</span><span class="MJXp-mn" id="MJXp-Span-888">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-894" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-896">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">c</span><span class="MJXp-mrow" id="MJXp-Span-901"><span class="MJXp-mtext" id="MJXp-Span-902">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">u</span><span class="MJXp-msubsup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">i</span><span class="MJXp-mo" id="MJXp-Span-909">=</span><span class="MJXp-mn" id="MJXp-Span-910">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-915" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-918"><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-920" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-922">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">u</span><span class="MJXp-msubsup" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">N</span><span class="MJXp-mo" id="MJXp-Span-933">‚àí</span><span class="MJXp-mn" id="MJXp-Span-934">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">i</span><span class="MJXp-mo" id="MJXp-Span-929">=</span><span class="MJXp-mn" id="MJXp-Span-930">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">c</span><span class="MJXp-mrow" id="MJXp-Span-941"><span class="MJXp-mo" id="MJXp-Span-942" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">N</span><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-945">1</span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-949" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-951">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">u</span><span class="MJXp-msubsup" id="MJXp-Span-954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">N</span><span class="MJXp-mo" id="MJXp-Span-962">‚àí</span><span class="MJXp-mn" id="MJXp-Span-963">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">i</span><span class="MJXp-mo" id="MJXp-Span-958">=</span><span class="MJXp-mn" id="MJXp-Span-959">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-966" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">N</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-970">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-971"><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-973" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-976">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">c</span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">N</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-984">1</span></span><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-989" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mspace" id="MJXp-Span-991" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-992">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">u</span><span class="MJXp-msubsup" id="MJXp-Span-995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">N</span><span class="MJXp-mo" id="MJXp-Span-1003">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1004">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">i</span><span class="MJXp-mo" id="MJXp-Span-999">=</span><span class="MJXp-mn" id="MJXp-Span-1000">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1005" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1006">2</span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1008">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">c</span><span class="MJXp-mrow" id="MJXp-Span-1013"><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">N</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1017">1</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1021" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1023">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">u</span><span class="MJXp-msubsup" id="MJXp-Span-1026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">N</span><span class="MJXp-mo" id="MJXp-Span-1034">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1035">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">i</span><span class="MJXp-mo" id="MJXp-Span-1030">=</span><span class="MJXp-mn" id="MJXp-Span-1031">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1038" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">N</span></span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1043">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">c</span><span class="MJXp-mrow" id="MJXp-Span-1048"><span class="MJXp-msubsup" id="MJXp-Span-1049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1051" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1055" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">N</span></span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">c</span><span class="MJXp-mrow" id="MJXp-Span-1066"><span class="MJXp-msubsup" id="MJXp-Span-1067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1069" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1073" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-1076"><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1078" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1084" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1086">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">u</span><span class="MJXp-msubsup" id="MJXp-Span-1089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">i</span><span class="MJXp-mo" id="MJXp-Span-1093">=</span><span class="MJXp-mn" id="MJXp-Span-1094">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1097">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">c</span><span class="MJXp-mrow" id="MJXp-Span-1102"><span class="MJXp-msubsup" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1105" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">N</span></span><span class="MJXp-msubsup" id="MJXp-Span-1108"><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1110" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> \ sum_ {i = 1} ^ {N} (y_i - \ frac {\ sum_ {i = 1} ^ {N} y_i} {N}) ^ 2 = \ sum_ {i = 1} ^ {N-1 } (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N-1}) ^ 2 * (\ frac {N-1} {N}) ^ 2 - \\ \ sum_ {i = 1} ^ {N-1} (2 (\ frac {(N-1) y_i - \ sum_ {i = 1} ^ {N-1} y_i} {N}) (\ frac {y_N - y_i} {N}) - (\ frac {y_N - y_i} {N}) ^ 2) + (y_N - \ sum_ {i = 1} ^ {N} \ frac {y_i} {N}) ^ 2 </script></p><br>  And then it is clear how to express the necessary amount.  To recalculate the error, we need to store only the amounts of the elements on the right and left, as well as the new element itself, which entered the input.  Now the error is recalculated for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">O</span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1114">1</span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> O (1) </script>  . <br><br>  Well, let's implement this in code. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RegressionTreeFastMse</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">''' –ö–ª–∞—Å—Å RegressionTree —Å –±—ã—Å—Ç—Ä—ã–º –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º –æ—à–∏–±–∫–∏. –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –æ—à–∏–±–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç O(1). '''</span></span> <span class="hljs-comment"><span class="hljs-comment"># –æ–±—ä—è–≤–ª—è–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–ª–∞—Å—Å–∞ def __init__(self, max_depth=3, min_size=10): self.max_depth = max_depth self.min_size = min_size self.value = 0 self.feature_idx = -1 self.feature_threshold = 0 self.left = None self.right = None # –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—É—á–µ–Ω–∏—è - —Å—é–¥–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ def fit(self, X, y): # –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ y self.value = y.mean() # –Ω–∞—á–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ - mse –º–µ–∂–¥—É –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ –ª–∏—Å—Ç–µ (–ø–æ–∫–∞ –Ω–µ—Ç # —Ä–∞–∑–±–∏–µ–Ω–∏—è, —ç—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º –æ–±—ä–µ–∫—Ç–∞–º) –∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ base_error = ((y - self.value) ** 2).sum() error = base_error flag = 0 # –ø—Ä–∏—à–ª–∏ –≤ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≥–ª—É–±–∏–Ω—É if self.max_depth &lt;= 1: return dim_shape = X.shape[1] left_value, right_value = 0, 0 for feat in range(dim_shape): prev_error1, prev_error2 = base_error, 0 idxs = np.argsort(X[:, feat]) # –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–±—Ä–æ—Å–∞ —Å—É–º–º—ã mean1, mean2 = y.mean(), 0 sm1, sm2 = y.sum(), 0 N = X.shape[0] N1, N2 = N, 0 thres = 1 while thres &lt; N - 1: N1 -= 1 N2 += 1 idx = idxs[thres] x = X[idx, feat] # –≤—ã—á–∏—Å–ª—è–µ–º –¥–µ–ª—å—Ç—ã - –ø–æ –Ω–∏–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å—Å—è –ø–µ—Ä–µ–±—Ä–æ—Å delta1 = (sm1 - y[idx]) * 1.0 / N1 - mean1 delta2 = (sm2 + y[idx]) * 1.0 / N2 - mean2 # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—É–º–º—ã sm1 -= y[idx] sm2 += y[idx] # –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ –∑–∞ O(1) prev_error1 += (delta1**2) * N1 prev_error1 -= (y[idx] - mean1)**2 prev_error1 -= 2 * delta1 * (sm1 - mean1 * N1) mean1 = sm1/N1 prev_error2 += (delta2**2) * N2 prev_error2 += (y[idx] - mean2)**2 prev_error2 -= 2 * delta2 * (sm2 - mean2 * N2) mean2 = sm2/N2 # –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –±–ª–∏–∑–∫–∏–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É –∑–Ω–∞—á–µ–Ω–∏—è if thres &lt; N - 1 and np.abs(x - X[idxs[thres + 1], feat]) &lt; 1e-5: thres += 1 continue # 2 —É—Å–ª–æ–≤–∏—è, —á—Ç–æ–±—ã –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å —Å–ø–ª–∏—Ç - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ # –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–æ —ç–ª-–≤ –≤ –∫–∞–∂–¥–æ–º –ª–∏—Å—Ç–µ if (prev_error1 + prev_error2 &lt; error): if (min(N1,N2) &gt; self.min_size): # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–∞–º—ã–π –ª—É—á—à–∏–π –ø—Ä–∏–∑–Ω–∞–∫ –∏ –≥—Ä–∞–Ω–∏—Ü—É –ø–æ –Ω–µ–º—É self.feature_idx, self.feature_threshold = feat, x # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ª–∏—Å—Ç–∞—Ö left_value, right_value = mean1, mean2 # —Ñ–ª–∞–≥ - –∑–Ω–∞—á–∏—Ç —Å–¥–µ–ª–∞–ª–∏ —Ö–æ—Ä–æ—à–∏–π —Å–ø–ª–∏—Ç flag = 1 error = prev_error1 + prev_error2 thres += 1 # –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–∑–¥–µ–ª–∏–ª–∏, –≤—ã—Ö–æ–¥–∏–º if self.feature_idx == -1: return self.left = RegressionTreeFastMse(self.max_depth - 1) # print ("–õ–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Å –≥–ª—É–±–∏–Ω–æ–π %d"%(self.max_depth - 1)) self.left.value = left_value self.right = RegressionTreeFastMse(self.max_depth - 1) # print ("–ü—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Å –≥–ª—É–±–∏–Ω–æ–π %d"%(self.max_depth - 1)) self.right.value = right_value idxs_l = (X[:, self.feature_idx] &gt; self.feature_threshold) idxs_r = (X[:, self.feature_idx] &lt;= self.feature_threshold) self.left.fit(X[idxs_l, :], y[idxs_l]) self.right.fit(X[idxs_r, :], y[idxs_r]) def __predict(self, x): if self.feature_idx == -1: return self.value if x[self.feature_idx] &gt; self.feature_threshold: return self.left.__predict(x) else: return self.right.__predict(x) def predict(self, X): y = np.zeros(X.shape[0]) for i in range(X.shape[0]): y[i] = self.__predict(X[i]) return y</span></span></code> </pre> <br>  Let's measure the time that is spent on training now and compare it with the analog from Sklearn. <br><br><pre> <code class="python hljs">%%time A = RegressionTreeFastMse(<span class="hljs-number"><span class="hljs-number">4</span></span>, min_size=<span class="hljs-number"><span class="hljs-number">5</span></span>) A.fit(X,y) test_mytree = A.predict(X) test_mytree</code> </pre> <br><pre> <code class="python hljs">%%time model = DecisionTreeRegressor(max_depth=<span class="hljs-number"><span class="hljs-number">4</span></span>) model.fit(X,y) test_sklearn = model.predict(X)</code> </pre><br><ul><li>  For our algorithm, it turns out - CPU times: user 3.11 s, sys: 2.7 ms, total: 3.11 s <br>  Wall time: 3.11 s. </li><li>  For an algorithm from Sklearn - CPU times: user 45.9 ms, sys: 1.09 ms, total: 47 ms <br>  Wall time: 45.7 ms. </li></ul><br>  The results are already more pleasant.  Well, let's further improve the algorithm. <br><br><h3>  3. Class RegressionTree () with linear combinations of signs </h3><br>  Now our algorithm does not use the relationship between the signs.  We fix one feature and see only orthogonal partitions of the space.  How to learn to use linear interrelations between signs?  That is, look for the best partitions not like <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1116"><span class="MJXp-msubsup" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1119" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> a_ {feat} <x </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">u</span><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">K</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">i</span><span class="MJXp-mo" id="MJXp-Span-1134">=</span><span class="MJXp-mn" id="MJXp-Span-1135">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1139" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-msubsup" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1143" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> \ sum_ {i = 1} ^ K b_i * a_i <x </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> K </script>  - is some number less than the dimension of our space? <br><br>  There are many options, I will highlight the two most interesting from my point of view.  Both of these approaches are outlined in <a href="https://books.google.ru/books/about/Classification_and_Regression_Trees.html">the Friedman book</a> (he invented these trees). <br><br>  I will give a picture so that it is clear what is meant: <br><br><img src="https://habrastorage.org/webt/qj/dp/jv/qjdpjvancjl_6nmcynm3ludrysu.png"><br><br>  First, you can try to find these linear partitions algorithmically.  It is clear that it is impossible to sort through all linear combinations, because there are an infinite number of them, therefore such an algorithm must be greedy, that is, at each iteration it is possible to improve the result of the previous iteration.  The main idea of ‚Äã‚Äãthis algorithm can be found in the booklet; I will also leave here a link to the <a href="https://github.com/dimjava/MachineLearningTechnoSphere/blob/master/Boosting/GradBoostingLin.ipynb">repository of</a> my friend and colleague with the implementation of this algorithm. <br><br>  Secondly, if we do not go far from the idea of ‚Äã‚Äãfinding the best orthogonal partition, then how can we modify the data so that the information about the relationship between the signs is used and the search is by orthogonal partitions?  That's right, to make some transformations of the original signs into new ones.  For example, you can take the sum of some combination of signs and look for partitions already on them.  Such a method is worse in the algorithmic concept, but it performs its task ‚Äî it searches for orthogonal partitions already in some interrelationships of features. <br><br>  Well, let's realize - we will add as various signs, for example, all possible combinations of the amounts of signs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">i</span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> i, j </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">I</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> I <j </script>  .  I note that the complexity of the algorithm in this case will increase, it is clear how many times.  Well, to be considered faster, we will use cython. <br><br><pre> <code class="python hljs">%load_ext Cython %%cython -a <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np cimport numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> itertools <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * cdef <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RegressionTreeCython</span></span></span><span class="hljs-class">:</span></span> cdef public int max_depth cdef public int feature_idx cdef public int min_size cdef public int averages cdef public np.float64_t feature_threshold cdef public np.float64_t value cpdef RegressionTreeCython left cpdef RegressionTreeCython right <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, max_depth=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, min_size=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">, averages=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.max_depth = max_depth self.min_size = min_size self.value = <span class="hljs-number"><span class="hljs-number">0</span></span> self.averages = averages self.feature_idx = <span class="hljs-number"><span class="hljs-number">-1</span></span> self.feature_threshold = <span class="hljs-number"><span class="hljs-number">0</span></span> self.left = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.right = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">data_transform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, np.ndarray[np.float64_t, ndim=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">] X, list index_tuples)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö - –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –≤ –≤–∏–¥–µ —Å—É–º–º—ã for i in index_tuples: # –¥–æ–±–∞–≤–ª—è–µ–º —Å—É–º–º—ã, –∏–Ω–¥–µ–∫—Å—ã –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ X = np.hstack((X, X[:, i[0]:(i[1]+1)].sum(axis=1).reshape(X.shape[0],1))) return X def fit(self, np.ndarray[np.float64_t, ndim=2] X, np.ndarray[np.float64_t, ndim=1] y): cpdef np.float64_t mean1 = 0.0 cpdef np.float64_t mean2 = 0.0 cpdef long N = X.shape[0] cpdef long N1 = X.shape[0] cpdef long N2 = 0 cpdef np.float64_t delta1 = 0.0 cpdef np.float64_t delta2 = 0.0 cpdef np.float64_t sm1 = 0.0 cpdef np.float64_t sm2 = 0.0 cpdef list index_tuples cpdef list stuff cpdef long idx = 0 cpdef np.float64_t prev_error1 = 0.0 cpdef np.float64_t prev_error2 = 0.0 cpdef long thres = 0 cpdef np.float64_t error = 0.0 cpdef np.ndarray[long, ndim=1] idxs cpdef np.float64_t x = 0.0 # —Ç–∞–∫—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ # –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–Ω–¥–µ–∫—Å—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º —Å—É–º–º–∏—Ä—É–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ if self.averages: stuff = list(range(0,X.shape[1],1)) index_tuples = list(combinations(stuff,2)) # –≤—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö X = self.data_transform(X, index_tuples) # –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ y self.value = y.mean() # –Ω–∞—á–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ - mse –º–µ–∂–¥—É –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ –ª–∏—Å—Ç–µ (–ø–æ–∫–∞ –Ω–µ—Ç —Ä–∞–∑–±–∏–µ–Ω–∏—è, # —ç—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º –æ–±—ä–µ–∫—Ç–∞–º) –∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ base_error = ((y - self.value) ** 2).sum() error = base_error flag = 0 # –ø—Ä–∏—à–ª–∏ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≥–ª—É–±–∏–Ω—É if self.max_depth &lt;= 1: return dim_shape = X.shape[1] left_value, right_value = 0, 0 for feat in range(dim_shape): prev_error1, prev_error2 = base_error, 0 idxs = np.argsort(X[:, feat]) # –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–±—Ä–æ—Å–∞ —Å—É–º–º—ã mean1, mean2 = y.mean(), 0 sm1, sm2 = y.sum(), 0 N = X.shape[0] N1, N2 = N, 0 thres = 1 while thres &lt; N - 1: N1 -= 1 N2 += 1 idx = idxs[thres] x = X[idx, feat] # –≤—ã—á–∏—Å–ª—è–µ–º –¥–µ–ª—å—Ç—ã - –ø–æ –Ω–∏–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å—Å—è –ø–µ—Ä–µ–±—Ä–æ—Å delta1 = (sm1 - y[idx]) * 1.0 / N1 - mean1 delta2 = (sm2 + y[idx]) * 1.0 / N2 - mean2 # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—É–º–º—ã sm1 -= y[idx] sm2 += y[idx] # –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ –∑–∞ O(1) prev_error1 += (delta1**2) * N1 prev_error1 -= (y[idx] - mean1)**2 prev_error1 -= 2 * delta1 * (sm1 - mean1 * N1) mean1 = sm1/N1 prev_error2 += (delta2**2) * N2 prev_error2 += (y[idx] - mean2)**2 prev_error2 -= 2 * delta2 * (sm2 - mean2 * N2) mean2 = sm2/N2 # –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –±–ª–∏–∑–∫–∏–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É –∑–Ω–∞—á–µ–Ω–∏—è if thres &lt; N - 1 and np.abs(x - X[idxs[thres + 1], feat]) &lt; 1e-5: thres += 1 continue # 2 —É—Å–ª–æ–≤–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è —Å–ø–ª–∏—Ç–∞ - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ # –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –≤ –∫–∞–∂–¥–æ–º –ª–∏—Å—Ç–µ if (prev_error1 + prev_error2 &lt; error): if (min(N1,N2) &gt; self.min_size): # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–∞–º—ã–π –ª—É—á—à–∏–π –ø—Ä–∏–∑–Ω–∞–∫ –∏ –≥—Ä–∞–Ω–∏—Ü—É –ø–æ –Ω–µ–º—É self.feature_idx, self.feature_threshold = feat, x # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ª–∏—Å—Ç–∞—Ö left_value, right_value = mean1, mean2 # —Ñ–ª–∞–≥ - –∑–Ω–∞—á–∏—Ç —Å–¥–µ–ª–∞–ª–∏ —Ö–æ—Ä–æ—à–∏–π —Å–ø–ª–∏—Ç flag = 1 error = prev_error1 + prev_error2 thres += 1 # self.feature_idx - –∏–Ω–¥–µ–∫—Å —Å–∞–º–æ–π –∫—Ä—É—Ç–æ–π —Ä–∞–∑–¥–µ–ª—è—é—â–µ–π —Ñ–∏—á–∏. # –ï—Å–ª–∏ —ç—Ç–æ –∫–∞–∫–∞—è-—Ç–æ –∏–∑ —Å—É–º–º, –∏ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–∞–∫–æ–µ-—Ç–æ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ # –æ –¥–∞–Ω–Ω—ã—Ö, —Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –∑–Ω–∞—á–∏—Ç —ç—Ç–∞ —Å—É–º–º–∞ # –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–∑–¥–µ–ª–∏–ª–∏, –≤—ã—Ö–æ–¥–∏–º if self.feature_idx == -1: return # –≤—ã–∑—ã–≤–∞–µ–º –ø–æ—Ç–æ–º–∫–æ–≤ –¥–µ—Ä–µ–≤–∞ self.left = RegressionTreeCython(self.max_depth - 1, averages=0) self.left.value = left_value self.right = RegressionTreeCython(self.max_depth - 1, averages=0) self.right.value = right_value # –Ω–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ø–æ—Ç–æ–º–∫–æ–≤ idxs_l = (X[:, self.feature_idx] &gt; self.feature_threshold) idxs_r = (X[:, self.feature_idx] &lt;= self.feature_threshold) # –æ–±—É—á–µ–Ω–∏–µ –ø–æ—Ç–æ–º–∫–æ–≤ self.left.fit(X[idxs_l, :], y[idxs_l]) self.right.fit(X[idxs_r, :], y[idxs_r]) def __predict(self, np.ndarray[np.float64_t, ndim=1] x): if self.feature_idx == -1: return self.value if x[self.feature_idx] &gt; self.feature_threshold: return self.left.__predict(x) else: return self.right.__predict(x) def predict(self, np.ndarray[np.float64_t, ndim=2] X): # —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥–∏–∫—Ç—ã, –Ω—É–∂–Ω–æ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–∏—Ç—å —Å—É–º–º—ã –≤ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É if self.averages: stuff = list(range(0,X.shape[1],1)) index_tuples = list(itertools.combinations(stuff,2)) X = self.data_transform(X, index_tuples) y = np.zeros(X.shape[0]) for i in range(X.shape[0]): y[i] = self.__predict(X[i]) return y</span></span></code> </pre> <br><h3>  4. Comparison of results </h3><br>  Well, let's compare the results.  We will compare three algorithms with the same parameters - a tree from Sklearn, our usual tree and our tree with new features.  Let's divide many times our training and test sets, and calculate the error. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KFold <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_metrics</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(X,y,n_folds=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">, model=None)</span></span></span><span class="hljs-function">:</span></span> kf = KFold(n_splits=n_folds, shuffle=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) kf.get_n_splits(X) er_list = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> train_index, test_index <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> kf.split(X): X_train, X_test = X[train_index], X[test_index] y_train, y_test = y[train_index], y[test_index] model.fit(X_train,y_train) predict = model.predict(X_test) er_list.append(mse(y_test, predict)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> er_list</code> </pre> <br>  Now let's run all the algorithms. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt data = datasets.fetch_california_housing() X = np.array(data.data) y = np.array(data.target) er_sklearn_tree = get_metrics(X,y,<span class="hljs-number"><span class="hljs-number">30</span></span>,DecisionTreeRegressor(max_depth=<span class="hljs-number"><span class="hljs-number">4</span></span>, min_samples_leaf=<span class="hljs-number"><span class="hljs-number">10</span></span>)) er_fast_mse_tree = get_metrics(X,y,<span class="hljs-number"><span class="hljs-number">30</span></span>,RegressionTreeFastMse(<span class="hljs-number"><span class="hljs-number">4</span></span>, min_size=<span class="hljs-number"><span class="hljs-number">10</span></span>)) er_averages_tree = get_metrics(X,y,<span class="hljs-number"><span class="hljs-number">30</span></span>,RegressionTreeCython(<span class="hljs-number"><span class="hljs-number">4</span></span>, min_size=<span class="hljs-number"><span class="hljs-number">10</span></span>)) %matplotlib inline data = [er_sklearn_tree, er_fast_mse_tree, er_averages_tree] fig7, ax7 = plt.subplots() ax7.set_title(<span class="hljs-string"><span class="hljs-string">''</span></span>) ax7.boxplot(data, labels=[<span class="hljs-string"><span class="hljs-string">'Sklearn Tree'</span></span>, <span class="hljs-string"><span class="hljs-string">'Fast Mse Tree'</span></span>, <span class="hljs-string"><span class="hljs-string">'Averages Tree'</span></span>]) plt.grid() plt.show()</code> </pre> <br>  Results: <br><br><img src="https://habrastorage.org/webt/yo/2n/-v/yo2n-v39rbo9w_8c-a1wok79vgu.png"><br><br>  Our usual tree lost Sklearn (it‚Äôs understandable: Sklearn is well optimized, and <a href="https://scikit-learn.org/stable/auto_examples/tree/plot_tree_regression.html">in it,</a> by default, the tree uses many more parameters that we don‚Äôt take into account), but when adding amounts, the result becomes more pleasant. <br><br>  To summarize: we learned how to write decisive trees from scratch, learned how to improve their work and checked their performance on real datasets by comparing it with an algorithm from Sklearn.  However, the improvement of the algorithms is not limited to the methods described here, so keep in mind that the proposed code can be made even better.  In the next article we will write the boosting based on these algorithms. <br><br>  Successes to all! </div><p>Source: <a href="https://habr.com/ru/post/438560/">https://habr.com/ru/post/438560/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>