<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A-Frame Review</title>
  <meta name="description" content="A-Frame is a web framework that allows you to create various applications, games, scenes in virtual reality (VR). All of the above will be available d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>A-Frame Review</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/f-/qn/zb/f-qnzbemgwkrqoepzchim4omo38.png"><br><br>  <b><a href="https://aframe.io/">A-Frame</a></b> is a web framework that allows you to create various applications, games, scenes in virtual reality (VR).  All of the above will be available directly from the browser of your VR helmet.  This tool will be useful both for those who want to engage in the development of VR games in the browser, and for example, it can be useful as a platform for creating web BP applications, sites, landing pages.  The use of BP Web is limited only by your imagination.  Offhand, I can bring a couple of areas of human activity where BP can be useful: education, medicine, sports, sales, recreation. <br><a name="habracut"></a><br><h2>  What's inside? </h2><br>  A-Frame is not written from 0 on pure WebGL, it is based on the <i>Three.js</i> library.  Therefore, I recommend to start with the basic concepts of Three.js before starting to work with A-Frame, although this is not necessary, since A-Frame is designed in such a way that you least think about rendering geometry and concentrate more on the logic of your application .  That's what the framework is for. <br><br>  To do this, A-Frame postulates three main points, which we will discuss later. <br><br><h2>  A-Frame works with HTML </h2><br>  Many of the basic elements of A-Frame, such as scene, camera, box, sphere, etc., are added to the scene via tags of the same name with the prefix <b>a-</b> .  Each such element is registered as user.  Today, A-Frame (0.8.0) uses the v0 specification. <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">position</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-1 0.5 -3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rotation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0 45 0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#4CC3D9"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-sphere</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">position</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0 1.25 -5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">radius</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.25"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#EF2D5E"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-sphere</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  This small code fragment will draw a WebGL scene to which two objects will be added: a cube and a sphere with the specified parameters.  In addition to the above two elements, there are a number of other primitives that can be added to the scene in the same way: <i>&lt;a-circle&gt;, &lt;a-cone&gt;, &lt;a-cylinder&gt;, &lt;a-dodecahedron&gt;, &lt;a-icosahedron&gt; , &lt;a-octahedron&gt;, &lt;a-plane&gt;, &lt;a-ring&gt;, &lt;a-tetrahedron&gt;, &lt;a-torus-knot&gt;, &lt;a-torus&gt;, &lt;a-triangle&gt;</i> .  Also in A-Frame there are a number of other elements that perform certain functions: <br><br><ul><li>  <b>&lt;a-camera&gt;</b> - creates a camera.  Currently only the perspective camera is supported (PerspectiveCamera) </li><li>  <b>&lt;a-obj-model&gt;, &lt;a-collada-model&gt;, &lt;a-gltf-model&gt;</b> - they all load and display models of the appropriate format. </li><li>  <b>&lt;a-cursor&gt;</b> is an element that allows you to perform various actions: click, pointing, etc. The cursor is tied to the center of the camera, so it will always be in the center of what the user sees. </li><li>  <b>&lt;a-image&gt;</b> - displays the selected image on the plane (&lt;a-plane&gt;). </li><li>  <b>&lt;a-link&gt;</b> is the same as a tag, only for a 3D scene. </li><li>  <b>&lt;a-sky&gt;</b> is a huge top hat around the scene that allows you to display 360 photos.  Or you can just fill it with some color. </li><li>  <b>&lt;a-sound&gt;</b> - creates a sound source at a given position. </li><li>  <b>&lt;a-text&gt;</b> - draws flat text. </li><li>  <b>&lt;a-video&gt;</b> - plays the video on the plane. </li></ul><br>  I would also like to note that we work with DOM elements, and therefore we can use the standard DOM API, including querySelector, getElementById, appendChild, and so on. <br><br><h2>  A-Frame uses ECS </h2><br><img src="https://habrastorage.org/webt/2j/ms/b6/2jmsb6kaxov-akanrv-ea2pk9-g.png"><br>  <b>ECS (Entity Component System)</b> - application and game design pattern.  A widespread prevalence was just the same in the second segment.  As the name implies, the three basic concepts of the pattern are Entity (Entity), Component (Component), System (System).  In the classical form, they are interrelated with each other as follows: we have some container object (Entity) to which we can add components.  Usually the component is responsible for a separate part of the logic.  For example, we have a Player object (Player), it has a Health component.  This component will contain all the logic associated with the replenishment or loss of health of the player (object).  And systems, in turn, are needed in order to manage a set of entities united by some components.  Typically, a component can register an entity within a system of the same name. <br><br>  In A-Frame, this pattern is implemented very simply and elegantly - using attributes.  As entities, any A-Frame elements are used - <i>&lt;a-scene&gt;, &lt;a-box&gt;, &lt;a-sphere&gt;,</i> etc. But the <i>&lt;a-entity&gt;</i> element stands apart of course.  His name speaks for itself.  All other elements are essentially wrappers for the components and are made for convenience, since any element can be created using the <i>&lt;a-entity&gt;</i> .  For example <i>&lt;a-box&gt;</i> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-entity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">geometry</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primitive: box; width: 1; height: 1; depth: 1"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-entity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <b>geometry</b> is in this case the component that was added to the <i>&lt;a-entity&gt; entity</i> .  By itself, the <i>&lt;a-entity&gt;</i> does not have any logic (in the global sense), and the <i>geometry</i> component essentially turns it into a cube or something else.  Another equally important component is the <b>material</b> .  It adds material to geometry.  The material is responsible for whether our cube will shine like metal, will it have any textures, etc.  In pure <i>Three.js</i> we would have to create a separate geometry, a separate material, and then it would all have to be combined in the mesh.  In general, this approach saves time. <br><br>  Any component in A-Frame must be registered globally through a special design: <br><br><pre> <code class="javascript hljs">AFRAME.registerComponent(<span class="hljs-string"><span class="hljs-string">'hello-world'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Hello, World!'</span></span>); } });</code> </pre><br>  Then this component can be added to the scene, or any other element. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-entity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hello-world</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-entity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Since we added <b>init</b> callback for our component, as soon as the element is added to the DOM, this callback will work and we will see our message in the console.  There are other lifecycle callbacks in the A-Frame components.  Let's look at them in more detail: <br><br><ul><li>  <b>update</b> - called when initializing both init and updating any property of this component. </li><li>  <b>remove</b> - called after removing a component or an entity containing it.  That is, if you remove the &lt;a-entity&gt; from the DOM, all its components will call remove the callback. </li><li>  <b>tick</b> - called every time before rendering the scene.  Inside, the render loop uses requestAnimaitonFrame </li><li>  <b>tock</b> - called every time after rendering the scene. </li><li>  <b>play</b> - each is called when the scene rendering is resumed.  Essentially after scene.play (); </li><li>  <b>pause</b> - called every time the scene rendering is stopped.  Essentially after scene.pause (); </li><li>  <b>updateSchema</b> - called every time after updating the schema. </li></ul><br>  Another important component concept in A-Frame is the schema.  The schema describes the properties of the component.  It is defined as follows: <br><br><pre> <code class="javascript hljs">AFRAME.registerComponent(<span class="hljs-string"><span class="hljs-string">'my-component'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: { <span class="hljs-attr"><span class="hljs-attr">arrayProperty</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'array'</span></span>, <span class="hljs-attr"><span class="hljs-attr">default</span></span>: []}, <span class="hljs-attr"><span class="hljs-attr">integerProperty</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'int'</span></span>, <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>} } }</code> </pre><br>  In this case, our component <b>my-component</b> will contain two properties <i>arrayProperty</i> and <i>integerProperty</i> .  To pass them to the component, you must set the value of the corresponding attribute. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-entity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">my-component</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"arrayProperty: 1,2,3; integerProperty: 7"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-entity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  You can get these properties inside the component through the <b>data</b> property. <br><br><pre> <code class="javascript hljs">AFRAME.registerComponent(<span class="hljs-string"><span class="hljs-string">'my-component'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: { <span class="hljs-attr"><span class="hljs-attr">arrayProperty</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'array'</span></span>, <span class="hljs-attr"><span class="hljs-attr">default</span></span>: []}, <span class="hljs-attr"><span class="hljs-attr">integerProperty</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'int'</span></span>, <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>} }, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data); } }</code> </pre><br>  To get the properties of the component from the entity to which it is added, you can use the slightly modified <i>getAttribute</i> function.  When referring to an A-Frame entity, it returns not just the string value of the attribute, but the <i>data</i> object mentioned above. <br><br><pre> <code class="javascript hljs"> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.getAttribute(<span class="hljs-string"><span class="hljs-string">'my-component'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// {arrayProperty: [1,2,3], integerProperty: 7}</span></span></code> </pre><br>  In approximately the same way, you can change the properties of a component: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.setAttribute(<span class="hljs-string"><span class="hljs-string">'my-component'</span></span>,{<span class="hljs-attr"><span class="hljs-attr">arrayProperty</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">integerProperty</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>})</code> </pre><br>  Now let's talk about systems.  Systems in an A-Frame are registered in a similar way as components: <br><br><pre> <code class="javascript hljs">AFRAME.registerSystem(<span class="hljs-string"><span class="hljs-string">'my-system'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Hello, System!'</span></span>); }, });</code> </pre><br>  As well as the component, the system has a scheme and callbacks.  Only the system has only 5 of them: <b>init, play, pause, tick, tock</b> .  The system does not need to be added as a component to an entity.  It will automatically be added to the scene. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.sceneEl.systems[<span class="hljs-string"><span class="hljs-string">'my-system'</span></span>];</code> </pre><br>  If the component has the same name as the system, then the system will be accessible by the link <b>this.system</b> . <br><br><pre> <code class="javascript hljs">AFRAME.registerSystem(<span class="hljs-string"><span class="hljs-string">'enemy'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{}, }); AFRAME.registerComponent(<span class="hljs-string"><span class="hljs-string">'enemy'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> enemySystem = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.system; }, });</code> </pre><br>  Usually systems are needed in order to assemble and manage entities with the appropriate components.  Here, in theory, should be the logic that belongs to the collection of entities.  For example, the management of the appearance of enemies in the game. <br><br><h2>  Communication in A-Frame takes place via browser events. </h2><br>  And indeed, why reinvent the wheel, if at the moment there is an excellent embedded implementation of a publisher-subscriber for DOM elements.  DOM events allow you to listen to browser events, such as pressing a keyboard key, clicking a mouse, and others, as well as custom events.  A-Frame offers us a convenient and easy way to communicate between entities, components and systems, through user events.  To do this, each A-Frame element is patched by the <b>emit</b> function, it takes three parameters: the <i>first</i> is the name of the event, the <i>second</i> is the data that needs to be transmitted, the <i>third</i> is whether the event should float. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.emit(<span class="hljs-string"><span class="hljs-string">'start-game'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">level</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>}, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);</code> </pre><br>  You can subscribe to this event in our usual way using <b>addEventListener:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> someEntity = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'someEntity'</span></span>); someEntity.addEventListener(<span class="hljs-string"><span class="hljs-string">'start-game'</span></span>, () =&gt; {...});</code> </pre><br>  The bubbling of events here is a very important point, because sometimes two entities that must communicate with each other are on the same level, in which case you can add an event listener to the scene element.  He as you could see earlier, is available inside each element through the <b>sceneEl</b> link. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.sceneEl.addEventListener(<span class="hljs-string"><span class="hljs-string">'start-game'</span></span>, () =&gt; {...});</code> </pre><br><h2>  Finally </h2><br>  Here, perhaps, all that about what I wanted to tell in this article.  In A-Frame there are still many different topics that could be sanctified, but this article is an overview and I wanted to focus the attention of the reader only on the main points.  In the next article we will try to create a basic scene in order to test all the knowledge gained in practice.  Thanks to all! </div><p>Source: <a href="https://habr.com/ru/post/439416/">https://habr.com/ru/post/439416/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
</ul></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>