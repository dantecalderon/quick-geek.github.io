<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Quals: Saudi and Oman National Cyber ‚Äã‚ÄãSecurity CTF 2019. WriteUp</title>
  <meta name="description" content="Hi, Habr. 

 On February 7-9, 2019, the qualifying stage of the competition was held at the cybertalents site, the goal is to search for cyber talents...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Quals: Saudi and Oman National Cyber ‚Äã‚ÄãSecurity CTF 2019. WriteUp</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr. <br><br>  On February 7-9, 2019, the qualifying stage of the competition was held at the cybertalents site, the goal is to search for cyber talents for Oman and Saudi Arabia.  People from other countries, according to the rules of the event, participate out of competition.  Under the cut - analysis of certain tasks. <br><br><img src="https://habrastorage.org/webt/gh/8e/gd/gh8egd9dnbifibw1xlstbljys5c.png"><br><a name="habracut"></a><br>  The competition consists of 9 tasks, four of them are ‚Äúeasy‚Äù difficulty levels, four are ‚Äúmedium‚Äù, and one is ‚Äúhard‚Äù.  For each task given 50, 100 and 200 points, respectively.  Tasks are also categorized.  Below is a solution to some problems. <br><br><h3>  Back to basics </h3><br>  Easy, Web Analytics <br><blockquote>  not pretty much many options.  There is always a different way </blockquote>  Given a link like example.com/somepage.  When going through it, we are redirected (301 Moved Permanently) to the same page with a slash at the end, and she, in turn, redirects to google.com: <br><br><img src="https://habrastorage.org/webt/pz/p3/d-/pzp3d-wuprvqxtiyqigsa9vt3s4.png"><br><br>  Let's try a POST request to the second page: <br><br><img src="https://habrastorage.org/webt/md/t2/zn/mdt2znq6qeimy-wgvd2wwttgmcy.png"><br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x7f88=[<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"join"</span></span>,<span class="hljs-string"><span class="hljs-string">"reverse"</span></span>,<span class="hljs-string"><span class="hljs-string">"split"</span></span>,<span class="hljs-string"><span class="hljs-string">"log"</span></span>,<span class="hljs-string"><span class="hljs-string">"ceab068d9522dc567177de8009f323b2"</span></span>];<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reverse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0xa6e5x2</span></span></span><span class="hljs-function">)</span></span>{flag= _0xa6e5x2[_0x7f88[<span class="hljs-number"><span class="hljs-number">3</span></span>]](_0x7f88[<span class="hljs-number"><span class="hljs-number">0</span></span>])[_0x7f88[<span class="hljs-number"><span class="hljs-number">2</span></span>]]()[_0x7f88[<span class="hljs-number"><span class="hljs-number">1</span></span>]](_0x7f88[<span class="hljs-number"><span class="hljs-number">0</span></span>])}<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>[_0x7f88[<span class="hljs-number"><span class="hljs-number">4</span></span>]]= reverse;<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>[_0x7f88[<span class="hljs-number"><span class="hljs-number">4</span></span>]](_0x7f88[<span class="hljs-number"><span class="hljs-number">5</span></span>])</code> </pre> <br>  Gently pass the code through JS beautify: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reverse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0xa6e5x2</span></span></span><span class="hljs-function">) </span></span>{ flag = _0xa6e5x2[<span class="hljs-string"><span class="hljs-string">'split'</span></span>](<span class="hljs-string"><span class="hljs-string">''</span></span>)[<span class="hljs-string"><span class="hljs-string">'reverse'</span></span>]()[<span class="hljs-string"><span class="hljs-string">'join'</span></span>](<span class="hljs-string"><span class="hljs-string">''</span></span>) } <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>[<span class="hljs-string"><span class="hljs-string">'log'</span></span>] = reverse; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>[<span class="hljs-string"><span class="hljs-string">'log'</span></span>](<span class="hljs-string"><span class="hljs-string">'ceab068d9522dc567177de8009f323b2'</span></span>)</code> </pre> <br>  Flag: <code>2b323f9008ed771765cd2259d860baec</code> <br><br><h3>  I love images </h3><br>  Easy Digital Forensics <br><blockquote>  You can find it? </blockquote>  The picture is attached to the task: <br><br><img src="https://habrastorage.org/webt/vr/lg/wk/vrlgwk8feru6j5bhinoysrxj8wa.png"><br>  <a href="https://yadi.sk/i/4idB113kAFsn4w">Link to the picture</a> <br><br><div class="spoiler">  <b class="spoiler_title">Decision</b> <div class="spoiler_text">  Open the hex editor.  Note that the <a href="https://www.w3.org/TR/PNG-Structure.html">png</a> format <a href="https://www.w3.org/TR/PNG-Structure.html">has a ‚ÄúIEND‚Äù trailer</a> (49 45 4E 44).  We look at the end: <br><img src="https://habrastorage.org/webt/al/so/zv/alsozvemfrdbf_ormdvq3fme7ps.png"><br>  It is observed that added additional information to the end of the file.  The first assumption is base32, since  all letters in one case.  We decrypt: <br> <code>FLAG{Not_Only_Base64}</code> <br> </div></div><br><h3>  I love this guy </h3><br>  Medium, Malware Reverse Engineering <br><blockquote>  Can you find the password? </blockquote>  <a href="https://yadi.sk/d/LWNJqGTtU4XdOw">File is given</a> <br><br><div class="spoiler">  <b class="spoiler_title">Decision</b> <div class="spoiler_text">  Pass the file through Detect It Easy: <br><br><img src="https://habrastorage.org/webt/mv/d7/dw/mvd7dwoahf4ld1cfvstovigne7g.png"><br><br>  We open DNSpy x86 <br><br>  The file is really very small and consists of a single user event - Button_Click: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">5</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">14</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">13</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">25</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">24</span></span>] }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.TextBox1.Text.Equals(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)) { MessageBox.Show(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">5</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">11</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">6</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">26</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">8</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">28</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">11</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">14</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">21</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">4</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">28</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">5</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">14</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">13</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">25</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">24</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Letters[<span class="hljs-number"><span class="hljs-number">27</span></span>] })); }</code> </pre> <br>  Also in the current class the line is declared: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] Letters = <span class="hljs-string"><span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ{}_"</span></span>.ToCharArray();</code> </pre><br>  There are two possible solutions - in statics and dynamics.  First, we solve the static method: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># text - —Ç–µ–∫—Å—Ç –º–µ—Ç–æ–¥–∞ &gt;&gt;&gt; for i in range(len(letters)): text = text.replace(f"this.Letters[{i}]", letters[i]) &gt;&gt;&gt; print(text) string value = new string(new char[] { F, O, N, Z, Y }); if (this.TextBox1.Text.Equals(value)) { MessageBox.Show(new string(new char[] { F, L, A, G, {, I, _, L, O, V, E, _, F, O, N, Z, Y, } })); }</span></span></code> </pre><br>  When we make sure that the program is not harmful, you can debug it in dynamics.  We set the breakpoint (breakpoint, breakpoint) at the beginning of the method, we look in local variables, we extract the value variable, after which we get a message with a flag. <br><br>  Flag: <code>FLAG{I_LOVE_FONZY}</code> <br></div></div><br><h3>  Just Another Conference </h3><br>  Easy, General Information <br><blockquote>  OWASP in different locations </blockquote><div class="spoiler">  <b class="spoiler_title">Flag</b> <div class="spoiler_text">  Appsec <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/439590/">https://habr.com/ru/post/439590/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>