<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Effects of filtering SVG. Part 4. Two-color images with feComponentTransfer</title>
  <meta name="description" content="This fourth article in the series is about SVG filters in which Sara Soueidan shows you how to use feComponentTransfer to create a two-tone filter eff...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Effects of filtering SVG. Part 4. Two-color images with feComponentTransfer</h1><div class="post__text post__text-html js-mediator-article"><p>  This fourth article in the series is about SVG filters in which Sara Soueidan shows you how to use <strong>feComponentTransfer</strong> to create a two-tone filter effect. </p><br><p><img src="https://habrastorage.org/webt/l4/8c/px/l48cpx7wkxo3h-jkug7wk4z9ff8.png"></p><br><p>  Sara Soueidan, a freelance UI / UX developer of the interface and author of many technical articles living in Lebanon, offers a series of articles on the SVG filters and consists of the following articles: </p><br><h1 id="effekty-filtracii-svg">  Effects of filtering SVG </h1><br><ol><li>  <a href="https://habr.com/ru/post/439282/">Effects of filtering SVG.</a>  <a href="https://habr.com/ru/post/439282/">Part 1. SVG filters 101</a> </li><li>  <a href="https://habr.com/ru/post/439722/">Effects of filtering SVG.</a>  <a href="https://habr.com/ru/post/439722/">Part 2. Outline text with <strong>feMorphology</strong></a> </li><li>  <a href="https://habr.com/ru/post/439874/">Effects of filtering SVG.</a>  <a href="https://habr.com/ru/post/439874/">Part 3. Image posterization effect using <strong>feComponentTransfer</strong></a> </li><li>  Effects of filtering SVG.  Part 4. Two-color images with <strong>feComponentTransfer</strong> . </li></ol><br><div class="spoiler">  <b class="spoiler_title">Not yet translated</b> <div class="spoiler_text"><p>  <a href="https://tympanus.net/codrops/2019/02/12/svg-filter-effects-conforming-text-to-surface-texture-with-fedisplacementmap/">SVG Filter Effects: Conforming Text to Surface Texture with</a> </p><br><p>  In the previous article in this series, I introduced you to the primitive <strong>feComponentTransfer</strong> , and we used it to limit the number of colors in an image to create a posterization effect.  In this article we will look at how this primitive can be used to create the <strong>duotone</strong> effect, like Photoshop.  We will also learn how to use it to control the intensity and contrast of colors in an image. </p><a name="habracut"></a><br><h2 id="kratkiy-obzor">  Short review </h2><br><p>  A little repeat. </p><br><p>  Primitive <strong>feComponentTransfer</strong> allows <strong>you</strong> to modify each of the components R, G, B and A, present in the pixel.  In other words, <strong>feComponentTransfer</strong> provides independent manipulation of each color channel, as well as the alpha channel, in the <strong>input</strong> element. </p><br><p>  <strong>RGBA</strong> components are modified by performing various kinds of functions on these components.  For this, each component has its own element.  These component elements are nested in <strong>feComponentTransfer</strong> .  For RGBA, these are the component elements <strong>feFuncR</strong> , <strong>feFuncG</strong> , <strong>feFuncB</strong> , and <strong>feFuncA</strong> . </p><br><p>  The <strong>type</strong> attribute is used in the component element to determine the type of function that you want to use to change this component.  Currently, five types of functions are available: <strong>identity</strong> , <strong>table</strong> , <strong>discrete</strong> , <strong>linear</strong> and <strong>gamma</strong> .  These types of functions are used to change the RGBA components (colors and alpha channel) of the graphics source.  We mentioned that you can change one or more components at the same time and that you can change channels independently by applying different functions to each component element. </p><br><pre><code class="plaintext hljs">&lt;feComponentTransfer&gt; &lt;!-- The RED component --&gt; &lt;feFuncR type="identity | table | discrete | linear | gamma"&gt;&lt;/feFuncR&gt; &lt;!-- The GREEN component --&gt; &lt;feFuncG type="identity | table | discrete | linear | gamma"&gt;&lt;/feFuncG&gt; &lt;!-- The BLUE component --&gt; &lt;feFuncB type="identity | table | discrete | linear | gamma"&gt;&lt;/feFuncB&gt; &lt;!-- The ALPHA component --&gt; &lt;feFuncA type="identity | table | discrete | linear | gamma"&gt;&lt;/feFuncA&gt; &lt;/feComponentTransfer&gt;"&gt;</code> </pre> <br><p>  In the previous article, we clarified the <strong>discrete</strong> function and saw how it can be used to posterize images.  In this article, we will start by using the <strong>table</strong> function to create a duotone effect, similar to what you can create in Photoshop. </p><br><h2 id="sozdanie-dvuhcvetnogo-effekta-v-photoshop">  Creating a two-color effect in Photoshop </h2><br><p>  I am not a designer and I don‚Äôt understand graphic editors such as <strong>Photoshop</strong> .  When I wanted to create a two-color effect in SVG, I first looked for a way to create this effect in a graphic editor to see if I can replicate it using filtering operations available in SVG.  As it turned out, the steps to create two-color images in SVG are the same as in Photoshop. </p><br><p>  The following video is an accelerated version of <a href="https://www.youtube.com/watch%3Fv%3D3SKii_OLrHs">this lesson</a> that I found on YouTube. </p><br><p>  In this video, the designer creates a two-color effect by following these steps: </p><br><ul><li>  Decolorize the image by making it shades of gray. </li><li>  Match the range of shades of gray with the new range, which instead of black and white at both ends has two different colors that you want to use in a two-color effect.  In other words, you must create and use a gradient map with which shades of gray are matched. </li></ul><br><p>  Let's see how these steps can be replicated in the SVG. </p><br><h2 id="sozdanie-dvuhcvetnogo-effekta-v-svg">  Creating a two-color effect in SVG </h2><br><p>  To recreate this effect in SVG, we need to first discolor the image.  This can be done using the <strong>feColorMatrix</strong> filter <strong>primitive</strong> . </p><br><p>  Then, we need to be able to create and transmit a gradient map to the browser in order to display a new image in grayscale. </p><br><h3 id="preobrazovanie-izobrazheniya-v-ottenki-serogo-s-pomoschyu-fecolormatrix">  Convert image to grayscale with feColorMatrix </h3><br><p>  With <strong>feColorMatrix,</strong> you can set a color matrix that determines the amount of red, green, and blue in your image.  By providing an equal amount of these three components, we create a matrix that converts our image into a version of itself in shades of gray: </p><br><pre> <code class="plaintext hljs">&lt;svg viewBox="0 0 266 400"&gt; &lt;filter id="duotone"&gt; &lt;feColorMatrix type="matrix" values=".33 .33 .33 0 0 .33 .33 .33 0 0 .33 .33 .33 0 0 0 0 0 1 0"&gt; &lt;/feColorMatrix&gt; &lt;!-- ... --&gt; &lt;/filter&gt; &lt;image xlink:href="..." width="100%" x="0" y="0" height="100%" filter="url(#duotone)"&gt;&lt;/image&gt; &lt;/svg&gt;</code> </pre> <br><p>  In the following figure, the image on the right is the result of applying the above filter to the image on the left: </p><br><p><img src="https://habrastorage.org/webt/fe/bo/rg/feborgimnq5r15720aoelwb9nec.png" alt="Result (on the right) of converting the image to the left in grayscale using the filter operation feColorMatrix"><br>  Fig_1.  The result (on the right) of converting the image to the left in grayscale using the <strong>feColorMatrix</strong> filter operation </p><br><p>  You can learn everything about <strong>feColorMatrix</strong> and how to use it in <a href="https://alistapart.com/article/finessing-fecolormatrix">this article by</a> Una Kravets. </p><br><p>  Now that our image is essentially composed of a gray gradient, we need to create a two-color gradient map to display the gray gradient. </p><br><h3 id="sozdanie-karty-gradienta-s-pomoschyu-funkcii-perenosa-komponentov-tablicy">  Creating a gradient map using the table component transfer feature </h3><br><p>  In SVG, you can use a feComponentTransfer primitive with a type table to create a gradient map. </p><br><p>  In the <a href="https://tympanus.net/codrops/2019/01/29/svg-filter-effects-poster-image-effect-with-fecomponenttransfer/">previous article,</a> we saw how you can match the colors of an image with the list of colors provided in the <strong>tableValues</strong> attribute using the <strong>discrete</strong> function.  The browser uses our <strong>tableValues</strong> list to create ranges, which are then used to match colors with the values ‚Äã‚Äãwe provide. </p><br><p>  When using the <strong>table</strong> function, we will also provide color values ‚Äã‚Äãin the <strong>tableValues</strong> attribute.  Again, the browser will use these values ‚Äã‚Äãto match the colors of the image with them.  However, how the browser will display these colors is different.  Instead of matching color ranges to a discrete color value, it will create a color range from the provided values, and then match the input range to this new range. </p><br><p>  Suppose we want to use two colors for our two-tone effect: </p><br><p><img src="https://habrastorage.org/webt/_n/hc/hk/_nhchk-zbiu5lu9-xw1mlflxg-q.png" alt="Original two colors"><br>  Pic_2.  Original two colors. </p><br><p>  These two colors will be used to create a gradient display: </p><br><p><img src="https://habrastorage.org/webt/1l/rt/1k/1lrt1kauv5yfqmw2x5rkagrsrma.png" alt="Gradient created by two color values"><br>  Fig_3.  Gradient created by two color values. </p><br><p>  ... which we are going to map our grayscale map. </p><br><p><img src="https://habrastorage.org/webt/pg/ok/0u/pgok0uahppznzeodzadec0a_cpu.png" alt="Display of a two-tone card to a two-color gradient"><br>  Fig_4.  Displays a dual-tone card to a two-color gradient. </p><br><p>  To use these colors in <strong>feComponentTransfer</strong> , we need to get the values ‚Äã‚Äãof the R, G and B channels of each color.  Since <strong>tableValues</strong> contains fractional values, we need to convert RGB values ‚Äã‚Äãto fractions.  Color values ‚Äã‚Äãare usually in the range [0,255].  To convert them into fractions, divide them by 255. </p><br><p>  For example, pink has the following RGB values: </p><br><pre> <code class="plaintext hljs">R: 254 G: 32 B: 141</code> </pre> <br><p>  Converting them into a fraction, we get: </p><br><pre> <code class="plaintext hljs">R: 254/255 = .996078431 G: 32/255 = .125490196 B: 141/255 = .552941176</code> </pre> <br><p>  Similarly, for values ‚Äã‚Äãof yellow, we obtain: </p><br><pre> <code class="plaintext hljs">R: .984313725 G: .941176471 B: .478431373</code> </pre> <br><p>  Now that we have color values, it's time to create our gradient map.  We mentioned earlier that when we provide <strong>tableValues</strong> for use in the <strong>table</strong> function, the browser will use <strong>tableValues</strong> to create a range.  Therefore, we will start by providing two color RGB values ‚Äã‚Äãas RGB values ‚Äã‚Äãfor component elements: </p><br><pre> <code class="plaintext hljs">&lt;feComponentTransfer color-interpolation-filters="sRGB"&gt; &lt;feFuncR type="table" tableValues=".996078431 .984313725"&gt;&lt;/feFuncR&gt; &lt;feFuncG type="table" tableValues=".125490196 .941176471"&gt;&lt;/feFuncG&gt; &lt;feFuncB type="table" tableValues=".552941176 .478431373"&gt;&lt;/feFuncB&gt; &lt;/feComponentTransfer&gt;</code> </pre> <br><p><img src="https://habrastorage.org/webt/o1/p7/ej/o1p7ej-9t86kw_f3qjxkhx334cg.png"></p><br><p>  In the previous article, we saw that when using the <strong>discrete</strong> function, the browser creates <strong>n</strong> ranges for <strong>n</strong> values ‚Äã‚Äãin <strong>tableValues</strong> .  When we use the <strong>table</strong> function, the browser creates an <strong>n-1</strong> range for <strong>n</strong> values.  Since  we provided two <strong>tableValues</strong> for each component, which means that we get one range ([pink, yellow]) for each. </p><br><p>  Now <strong>feComponentTransfer</strong> will do its thing: the browser will view each pixel of the image source sequentially.  For each pixel, it will get the value of the red, green, and blue components.  Since our image has shades of gray, the R / G / B values ‚Äã‚Äãwill be in the range [0, 1] = [black, white] (0 is completely black, 1 is completely white and shades of gray between them).  Then the value of each component will be matched with the new range specified in <strong>tableValues</strong> . </p><br><p>  So: </p><br><ul><li>  the value of the red component will be mapped to the range [.996078431, .984313725]; </li><li>  the blue value of the component will be assigned to the range [.1249490196, .941176471]; </li><li>  the green value of the component will match the range [.552941176, .478431373]. </li></ul><br><p>  Thus, by the time the browser passes through all the pixels in the image, you will replace all the RGB values ‚Äã‚Äãin the gradient of shades of gray with the RGB values ‚Äã‚Äãof the two-color gradient display.  As a result, the image will become two-color. </p><br><p><img src="https://habrastorage.org/webt/sp/44/4j/sp444jteqwjkales5mp2w9vzeda.png" alt="The result (on the right) is the display of a grayscale image (left) in our gradient map."><br>  Fig_6.  The result (on the right) is the display of the grayscale image (on the left) in our gradient map. </p><br><p>  Our full code now looks like this: </p><br><pre> <code class="plaintext hljs">&lt;svg viewBox="0 0 266 400"&gt; &lt;filter id="duotone"&gt; &lt;!-- Grab the SourceGraphic (implicit) and convert it to grayscale --&gt; &lt;feColorMatrix type="matrix" values=".33 .33 .33 0 0 .33 .33 .33 0 0 .33 .33 .33 0 0 0 0 0 1 0"&gt; &lt;/feColorMatrix&gt; &lt;!-- Map the grayscale result to the gradient map provided in tableValues --&gt; &lt;feComponentTransfer color-interpolation-filters="sRGB"&gt; &lt;feFuncR type="table" tableValues=".996078431 .984313725"&gt;&lt;/feFuncR&gt; &lt;feFuncG type="table" tableValues=".125490196 .941176471"&gt;&lt;/feFuncG&gt; &lt;feFuncB type="table" tableValues=".552941176 .478431373"&gt;&lt;/feFuncB&gt; &lt;/feComponentTransfer&gt; &lt;/filter&gt; &lt;image xlink:href=".." width="100%" x="0" y="0" height="100%" filter="url(#duotone)"&gt;&lt;/image&gt; &lt;/svg&gt;</code> </pre> <br><p>  You can play with the demo here: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/SaraSoueidan/embed/preview/zpaKyY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  You can go further and instead of providing only two color values ‚Äã‚Äãfor a gradient map, provide three color values ‚Äã‚Äãin <strong>tableValues</strong> , creating a gradient map that has three colors instead of two. </p><br><h2 id="upravlenie-kontrastnostyu-i-intensivnostyu-cveta-s-pomoschyu-funkcii-perenosa-gamma">  Contrast and color management using the gamma transfer function </h2><br><p>  Using the <strong>gamma</strong> component transfer function, we can perform gamma correction of our graphics source.  Gamma Correction is a function to control the light levels of an image. </p><br><p>  The <strong>gamma</strong> function has three attributes that allow you to control the gamma correction function that will be used to control the luminance: amplitude, exponent, and offset.  Together, they constitute the following transfer function: </p><br><pre> <code class="plaintext hljs">C' = amplitude * pow(C, exponent) + offset</code> </pre> <br><p>  <strong>gamma</strong> can be used to control the overall image contrast.  An increase in the <strong>exponent</strong> attribute makes dark areas darker, while an increase in the <strong>amplitude</strong> attribute causes light areas to shine more.  And this, in turn, increases the overall contrast of the image.  The <strong>offset</strong> attribute is used to increase the intensity of each component, and also affects the full image: both light and dark areas. </p><br><p>  Adjusting the contrast in both dark and light areas of an image can sometimes be useful if you do not get the amount of ‚Äúshine‚Äù you would like to see in the image. </p><br><p>  For example, if you apply the <strong>duotone</strong> filter from the previous section to the next image, the result will not be as ‚Äúalive‚Äù as you would like: </p><br><p><img src="https://habrastorage.org/webt/we/lk/ar/welkarp-hlfbz1x6gjkpfklt7mk.png" alt="The result of the filter duotone"><br>  Fig_7.  The result of the filter duotone. </p><br><p>  The two-color image on the right looks a little pale, and the colors are slightly blurred.  I want to add contrast to make it look more alive.  Increase the <strong>amplitude</strong> and <strong>exponent a</strong> bit: </p><br><pre> <code class="plaintext hljs">&lt;feComponentTransfer color-interpolation-filters="sRGB"&gt; &lt;feFuncR type="gamma" exponent="1.5" amplitude="1.3" offset="0"&gt;&lt;/feFuncR&gt; &lt;feFuncG type="gamma" exponent="1.5" amplitude="1.3" offset="0"&gt;&lt;/feFuncG&gt; &lt;feFuncB type="gamma" exponent="1.5" amplitude="1.3" offset="0"&gt;&lt;/feFuncB&gt; &lt;/feComponentTransfer&gt;</code> </pre> <br><p>  I was able to make the light areas more luminous, and the dark ones more intense: </p><br><p><img src="https://habrastorage.org/webt/sa/jg/fp/sajgfpesgoy5ptne--codeobq4w.png" alt="The result of the previous code"><br>  Fig_8.  The result of the gamma correction. </p><br><p>  Of course, this is just an example.  You may prefer a paler version of the image, especially to make it look better with text on top.  I think gamma correction is most useful for controlling the contrast of black and white images.  If I apply the same gamma correction operation to the grayscale version of the image, I get a more favorable picture: </p><br><p><img src="https://habrastorage.org/webt/yi/wq/i2/yiwqi2fvmgku-bdyjtetdfxg0lq.png" alt="Gamma Correction Result for Grayscale Image"><br>  Figure_9.  The result of the gamma correction for the image in grayscale. </p><br><p>  Of course, you can do the opposite and instead of increasing the contrast, you can lighten the dark areas a bit.  In this case, you should decrease the values ‚Äã‚Äãof the <strong>amplitude</strong> and / or <strong>exponent</strong> attributes, and not increase them.  The default value for both is 1. The default attribute value for <strong>offset</strong> is 0. </p><br><p>  Play with the <strong>gamma</strong> function values ‚Äã‚Äãin the following demo to better understand how they affect the brightness and contrast of the image: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/SaraSoueidan/embed/preview/ZVmqag" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="svg-instrument-gradient-map">  SVG-tool Gradient Map </h2><br><p>  <a href="https://twitter.com/yoksel_en">Yoksel</a> has been playing with SVG filters for some time and has recently created a fantastic visual tool that allows you to load an image and apply various two and even three-tone effects, and which generates an SVG filter code for you, ready to copy and paste to any place you want.  This is a great tool for further exploring <strong>feComponentTransfer</strong> . </p><br><p><img src="https://habrastorage.org/webt/q5/qh/gc/q5qhgcqolrli2szitofsrpjxqzm.png" alt="SVG filter tool ** Gradient Map ** from Yoksel"><br>  Figure 10.  <strong>Gradient Map</strong> SVG filter tool from Yoksel. </p><br><p>  The tool even allows you to customize the grayscale effect created with <strong>feColorMatrix</strong> .  In our code, we used an equal number of channels R, G and B to get the effect of shades of gray.  This is one way to make a grayscale image.  But there are other ways.  For example, you can create a grayscale effect for each channel, resulting in different shades of gray for each channel: </p><br><p><img src="https://habrastorage.org/webt/p5/n6/-n/p5n6-ngwjyvtife-1jy7r4rzus0.gif" alt="The result of creating a grayscale image in other ways."><br>  Fig_11.  The result of creating a grayscale image in other ways. </p><br><p>  I recommend playing with the tool for a bit and checking how your choice of effect changes the base code, as this is one of the best ways to learn more about SVG filters. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Primitive <strong>feComponentTransfer</strong> gives us a lot of control over the color and alpha components of images and allows you to create Photoshop-class effects in the comfort of our code editors. </p><br><p>  In the next article in this series, we will look at a few more primitives that allow us to reproduce another Photoshop effect, using almost the same steps as in Photoshop, and show again how SVG can bring the power of graphic editors to a web platform.  We learn how to blend text with the color and texture of the background image to get attractive looking results.  Stay with us. </p></div></div></div><p>Source: <a href="https://habr.com/ru/post/440474/">https://habr.com/ru/post/440474/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>