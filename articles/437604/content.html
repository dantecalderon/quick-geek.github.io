<div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a3/53d/9cb/3a353d9cb023a025a1241da695fd107c.jpg" alt="image"></div><br>  The Wave Function Collapse algorithm generates bitmaps that are locally similar to the input bitmap. <br><br>  Local similarity means that <br><br><ul><li>  (C1) Each NxN pixel pattern in the output must occur at least once in the input. </li><li>  (Weak C2 condition) The distribution of NxN patterns in the input data should be similar to the distribution of NxN patterns in a much larger number of output data sets.  In other words, the probability of meeting a certain pattern in the output should be close to the density of such patterns in the input data. </li></ul><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hb/sc/-y/hbsc-yb8opctfz1ozh0bnau57f8.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/at/lp/xhatlp1vjy76dci9bv-ka3lje8g.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4d/a3e/2bc/f4da3e2bc3e70455cf5e7ebdd8f66974.gif"></div><br><br>  In the examples, the standard value of N is 3. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/590/d65/2f1/590d652f17014c483b01ba68f6bd196e.png"></div><br>  The WaveFunctionCollapse (WFC) algorithm initializes the output bitmap as a completely unobservable state in which the value of each pixel is a superposition of the colors of the input bitmap (so if the input image is black and white, the unobservable states are displayed as different shades of gray).  The coefficients of these superpositions are real, not imaginary numbers, so the real quantum mechanics is not used in the algorithm, rather, it was inspired by it.  The program then goes into a watch-propagation cycle: <br><br><ul><li>  At each stage of the observation, the NxN region with the lowest Shannon entropy is selected from the unobserved space.  The state of this area then collapses to a state of certainty in accordance with the coefficients and distribution of NxN patterns in the incoming data. </li><li>  At each stage of distribution, the new information obtained during the collapse of the previous stage is distributed according to the output data. </li></ul><br>  At each stage, the total entropy decreases, and in the end we get a fully observable state, the collapse of the wave function is completed. <br><br>  It may happen that during the distribution process all coefficients for a certain pixel become zero.  This means that the algorithm came to a contradiction and can not be executed further.  The task of determining whether a given bitmap provides other nontrivial bitmaps that satisfy condition (C1) is NP-hard, so it’s impossible to create a quick solution that always completes the algorithm.  However, in practice, the algorithm encounters contradictions surprisingly rarely. <br><br>  The wave function collapse algorithm is implemented in <a href="https://github.com/math-fehr/fast-wfc">C ++</a> , <a href="https://github.com/ikarth/wfc_python">Python</a> , <a href="https://github.com/j-roskopf/WFC">Kotlin</a> , <a href="https://github.com/sdleffler/collapse">Rust</a> , <a href="">Julia</a> , <a href="https://github.com/Mitim-84/WFC-Gen">Haxe</a> , <a href="https://github.com/kchapelier/wavefunctioncollapse">JavaScript</a> and adapted for <a href="https://selfsame.itch.io/unitywfc" rel="nofollow">Unity</a> .  Official executables can be downloaded from <a href="https://exutumno.itch.io/wavefunctioncollapse" rel="nofollow">itch.io</a> or <a href="http://www.kchapelier.com/wfc-example/overlapping-model.html" rel="nofollow">run in a browser</a> .  WFC generates levels in <a href="https://www.badnorth.com/" rel="nofollow">Bad North</a> , <a href="https://store.steampowered.com/app/333640/Caves_of_Qud/" rel="nofollow">Caves of Qud</a> , <a href="https://arcadia-clojure.itch.io/proc-skater-2016" rel="nofollow">several</a> <a href="https://marian42.itch.io/wfc" rel="nofollow">smaller</a> games, as well as in a variety of prototypes.  His creation led to a <a href="https://adamsmith.as/papers/wfc_is_constraint_solving_in_the_wild.pdf" rel="nofollow">new</a> <a href="https://hal.inria.fr/hal-01706539v3/document" rel="nofollow">study</a> .  <a href="https://twitter.com/OskSta/status/784847588893814785" rel="nofollow">For other</a> <a href="https://twitter.com/dwtw/status/810166761270243328" rel="nofollow">related</a> <a href="https://github.com/mewo2/oisin">works</a> , <a href="https://trasevol.dog/2017/09/01/di19/" rel="nofollow">explanations</a> , <a href="http://oskarstalberg.com/game/wave/wave.html" rel="nofollow">interactive demos</a> , <a href="" rel="nofollow">tutorials</a> , <a href="http://www.procjam.com/tutorials/wfc/" rel="nofollow">tutorials</a> and <a href="https://twitter.com/ExUtumno/status/895684431477747715" rel="nofollow">examples,</a> see the section on <a href="https://github.com/mxgmn/WaveFunctionCollapse">ports, forks and spin-offs</a> . <br><br>  Watch a demonstration of the WFC algorithm on YouTube: <a href="https://youtu.be/DOQTr2Xmlz0" rel="nofollow">https://youtu.be/DOQTr2Xmlz0</a> <br><br><h2>  Algorithm </h2><br><ol><li>  Count the incoming bitmap and count the number of NxN patterns. <br><ol><li>  (optional) Complete the patterns with rotated and mirrored patterns. </li></ol></li><li>  Create an array with the size of the output (in the source called "wave").  Each element of this array indicates the state of a region with a size of NxN in the output.  The state of the NxN region is a superposition of the NxN patterns of incoming data with Boolean coefficients (that is, the state of a pixel in the output data is a superposition of incoming colors with real coefficients).  The False coefficient means that the corresponding pattern is not allowed, the true coefficient means that the corresponding pattern is not yet prohibited. </li><li>  Initialize a wave in a completely unobservable state, that is, where all Boolean coefficients are true. </li><li>  Repeat the following steps: <br><ol><li>  Observation: <br><ol><li>  Find the wave element with the minimum non-zero entropy.  If there are no such elements (if all elements have entropy zero or indefinite), then complete the cycle (4) and go to step (5). </li><li>  Collapse this element into a state of certainty in accordance with its coefficients and the distribution of NxN patterns of incoming data. </li></ol></li><li>  Propagation: disseminate information obtained in the previous step of observation. </li></ol></li><li>  By this time, all elements of the wave either have a fully observable state (all coefficients, except one, are equal to zero) or are in a state of contradiction (all coefficients are zero).  In the first case, return the output.  In the second case, complete the work without returning anything. </li></ol><br><h2>  Generation of tile cards </h2><br>  The simplest nontrivial case of the algorithm is the pattern NxN = 1x2 (more precisely, NxM).  If we simplify it even more, saving not the probabilities of pairs of colors, but the probabilities of the colors themselves, then we get what is called the “simple tile model”.  The propagation phase in this model is simply the propagation of the neighborhood dependency.  It is convenient to initialize a simple tile model with a list of tiles and data about their neighborhood (data about the neighborhood can be viewed as a large number of very small samples), rather than with a sampled bitmap. <br><br>  <a href="" rel="nofollow">Gif</a> |  <a href="" rel="nofollow">Gifv</a> <br><br>  Lists of all possible pairs of adjacent tiles in practical tilesets can be long enough, so to shorten the enumeration, I implemented a symmetry system for tiles.  In this system, each tile must be assigned its type of symmetry. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3fc/950/524/3fc9505247cd573c55fd716eb9e6b0bc.png"></div><br>  Notice that tiles have the same symmetry as the letters assigned to them (in other words, the actions of the dihedral group D4 are isometric for tiles and corresponding letters).  Thanks to this system, it is enough to list the pairs of neighboring tiles only up to their symmetry, shortens the list of neighbors for tilesets with a set of symmetric tiles several times (even in the Summer relief tileset, although the drawings are not symmetrical, the system considers such tiles symmetrical). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/925/c20/790/925c20790b4122150ec764f954c6c3ac.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4b7/0f5/1fd/4b70f51fdec41a7970545e9e8e308b67.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b7/bcb/ea9/0b7bcbea97c5e2320ef283553ae6cd6d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee8/ae4/a5a/ee8ae4a5a84712d697d40e63244d3d61.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e1/d0a/0af/4e1d0a0afb178a8bb1aae310fb34a42c.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d1/d72/c03/8d1d72c03e59026c4fe2496a2ac80d83.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6cf/aab/397/6cfaab397759e9a51800c6071aa8b9df.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/03a/79e/69f/03a79e69fb2e4728bc5f768785a8209a.png"></div><br>  Note that an unlimited tileset from nodes (in which all 5 tiles are valid) is not interesting for the WFC algorithm, because you cannot get into a situation where it is impossible to place a tile.  We call tilesets with this property “simple”.  Without complex heuristics, simple tilesets do not create interesting global structures, because correlations in simple tilesets decrease rapidly from a distance.  A number of simple tiles can be found on <a href="http://cr31.co.uk/stagecast/wang/tiles_e.html" rel="nofollow">cr31</a> .  Take a look at the Dual Dual Tileset.  How can he create nodes (without T-shaped connections, that is, uneasy) while being simple?  The answer is that it can only generate a narrow type of nodes and cannot create an arbitrary node. <br><br>  It is also worth noting that Circuit, Summer and Rooms tile are not Van tiles.  That is, the data of their neighborhood can not be generated from the colors of the edges.  For example, in the Circuit tile, two corners (Corner) cannot be adjacent, although they can be connected by a tile (Connection), and diagonal tracks cannot change directions. <br><br><h2>  Higher dimensions </h2><br>  The WFC algorithm in higher dimensions works in exactly the same way as in two dimensions, however, performance becomes a problem here.  These voxel models were generated with N = 2 in the tile model with overlapping using 5x5x5 and 5x5x2 blocks and additional heuristics (heights, density, curvature ...). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7eb/821/0ae/7eb8210ae48e8e5a6e135fa63ccee99e.png"></div><br>  Screenshots of higher dimensions: <a href="" rel="nofollow">1</a> , <a href="" rel="nofollow">2</a> , <a href="" rel="nofollow">3</a> . <br><br>  The voxel models generated using the WFC and other algorithms will be in a separate repository. <br><br><h2>  Restriction Synthesis </h2><br>  WFC algorithm supports restrictions.  Therefore, it can be easily combined with other generative algorithms or manually created. <br><br>  Here's how the WFC automatically completes a person-initiated level: <br><br>  <a href="" rel="nofollow">Gif</a> |  <a href="" rel="nofollow">Gifv</a> <br><br>  The <a href="https://github.com/mxgmn/ConvChain">ConvChain</a> algorithm satisfies the strict version of the condition (C2): the distribution of the NxN pattern limits it creates in the output is exactly the same as the pattern distribution in the input data.  However, ConvChain does not satisfy (C1): it often creates noticeable artifacts.  It is logical to run ConvChain first to get a well-sampled configuration, and then the WFC to correct local artifacts.  This is similar to the strategy common in optimization: first, we perform the Monte Carlo method to find the point.  close to the global optimum, and then perform gradient descent from this point for greater accuracy. <br><br>  PF Harrison’s <a href="https://github.com/mxgmn/SynTex">texture synthesis</a> algorithm is much faster than WFC, but he has problems with long correlations (for example, it’s difficult to synthesize brick wall textures with properly aligned bricks).  It is in such cases that the WFC demonstrates its superiority, and the Harrison algorithm supports the constraints.  It makes sense to first generate with WFC an ideal brick wall scheme, and then execute an algorithm for limited texture synthesis for this scheme. <br><br><h2>  Comments </h2><br>  Why is the minimum entropy heuristics used?  I noticed that when people draw something, they often follow the minimal entropy heuristics themselves.  That is why the algorithm is so interesting to watch. <br><br>  A model with overlap correlates with a simple model in the same way that high-order Markov chains correspond to first-order Markov chains. <br><br>  It is necessary to take into account that the entropy of any node cannot increase at the stage of distribution, i.e.  probabilities do not increase, but can be reset to zero.  When the propagation stage cannot further reduce the entropy, we will activate the observation phase.  If the observation stage cannot reduce the entropy, it means that the algorithm has finished its work. <br><br>  The propagation stage in the WFC algorithm is very similar to the cyclic message transfer algorithm (loopy belief propagation algorithm).  In fact, I initially programmed the belief propagation (BP), but then I switched to propagation with constraints with the stationary distribution preserved, because BP is much slower without massive parallelization (in the CPU) and it did not create significantly better results for my tasks. <br><br>  Note that the “Simple Knot” and “Trick Knot” samples are not 2, but 3 colors. <br><br>  Time can be one of the measurements.  In particular, d-dimensional WFC displays the behavior of any (d-1) -dimensional cellular automaton. <br><br><h2>  Reference materials </h2><br>  This project is based on the work of Paul Merrell on the synthesis of models, in particular, on the chapter on the discrete synthesis of models from <a href="http://graphics.stanford.edu/~pmerrell/thesis.pdf" rel="nofollow">his dissertation</a> .  Paul extends the neighborhood constraints in what we have called a simple tile model, with a heuristic seeking to calculate distribution in a small moving area. <br><br>  Also, my project was strongly influenced by a chapter on declarative texture synthesis from the <a href="http://logarithmic.net/pfh-files/thesis/dissertation.pdf" rel="nofollow">thesis of Paul F. Harrison</a> .  The floor sets the data about the neighborhood of tiles, marking their borders and using search in return to fill the tile map. <br><br><h2>  Assembly </h2><br>  WFC is a console application that depends only on the standard library.  Download <a href="https://www.microsoft.com/net/download" rel="nofollow">.NET Core</a> for Windows, Linux or macOS and follow <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">dotnet</span></span> run WaveFunctionCollapse.csproj</code> </pre> <br>  Alternatively, you can use the build instructions for different platforms in the <a href="https://github.com/mxgmn/WaveFunctionCollapse/issues/3">appropriate issue</a> .  Casey Marshall created a <a href="https://github.com/mxgmn/WaveFunctionCollapse/pull/18">pull request</a> that simplifies the use of the program with the command line and includes the snap package. <br><br><h2>  Interesting ports, forks and spin-offs </h2><br><ul><li>  Emil Ernerfeld created a <a href="https://github.com/emilk/wfc">port in C ++</a> . </li><li>  <a href="https://github.com/nanodeath">Max Eller</a> created the Kotlin (JVM) library called <a href="https://gitlab.com/nanodeath/kollapse" rel="nofollow">Kollapse</a> .  Joseph Roskopf created a line-by- <a href="https://github.com/j-roskopf/WFC">port on the Kotlin</a> optimized version of the 2018 algorithm.  Edwin Jacobs created another <a href="https://github.com/edwinRNDR/wfc">Kotlin library</a> . </li><li>  <a href="https://github.com/kchapelier">Kevin Chapeller</a> created <a href="http://www.kchapelier.com/wfc-example/overlapping-model.html" rel="nofollow">a javascript port</a> . </li><li>  Oscar Stalberg has programmed a three-dimensional tile model, a two-dimensional tile model for irregular grids in a sphere.  Here are beautiful 3D tilesets for them: <a href="https://twitter.com/OskSta/status/787319655648100352" rel="nofollow">1</a> , <a href="https://twitter.com/OskSta/status/784847588893814785" rel="nofollow">2</a> , <a href="https://twitter.com/OskSta/status/784847933686575104" rel="nofollow">3</a> , <a href="https://twitter.com/OskSta/status/784848286272327680" rel="nofollow">4</a> , <a href="https://twitter.com/OskSta/status/793545297376972801" rel="nofollow">5</a> , <a href="https://twitter.com/OskSta/status/793806535898136576" rel="nofollow">6</a> , <a href="https://twitter.com/OskSta/status/802496920790777856" rel="nofollow">7</a> , <a href="https://twitter.com/OskSta/status/804291629561577472" rel="nofollow">8</a> , <a href="https://twitter.com/OskSta/status/806856212260278272" rel="nofollow">9</a> , <a href="https://twitter.com/OskSta/status/806904557502464000" rel="nofollow">10</a> , <a href="https://twitter.com/OskSta/status/818857408848130048" rel="nofollow">11</a> , <a href="https://twitter.com/OskSta/status/832633189277409280" rel="nofollow">12</a> , <a href="https://twitter.com/OskSta/status/851170356530475008" rel="nofollow">13</a> , <a href="https://twitter.com/OskSta/status/858301207936458752" rel="nofollow">14</a> , <a href="https://twitter.com/OskSta/status/863019585162932224" rel="nofollow">15</a> . </li><li>  <a href="https://github.com/selfsame">Joseph Parker</a> adapted <a href="https://selfsame.itch.io/unitywfc" rel="nofollow">WFC for Unity</a> and used it to generate skateparks in the <a href="https://arcadia-clojure.itch.io/proc-skater-2016" rel="nofollow">2016 Proc Skater</a> game, a <a href="https://twitter.com/jplur_/status/929482200034226176" rel="nofollow">fantastic plateau in</a> the 2017 <a href="https://arcadia-clojure.itch.io/swapland" rel="nofollow">Swapland game</a> and <a href="https://twitter.com/jplur_/status/1053458654454865921" rel="nofollow">platform levels</a> in the 2018 <a href="https://selfsame.itch.io/bug-with-a-gun" rel="nofollow">Bug with a Gun</a> game. </li><li>  <a href="https://github.com/mewo2">Martin O'Leary</a> applied <a href="https://github.com/mewo2/oisin">a WFC-like algorithm</a> to generate poetry: <a href="https://twitter.com/mewo2/status/789167437518217216" rel="nofollow">1</a> , <a href="https://twitter.com/mewo2/status/789177702620114945" rel="nofollow">2</a> , <a href="https://twitter.com/mewo2/status/789187174683987968" rel="nofollow">3</a> , <a href="https://twitter.com/mewo2/status/789897712372183041" rel="nofollow">4</a> . </li><li>  <a href="https://github.com/NNNenov">Nick Nenov</a> created a <a href="https://twitter.com/NNNenov/status/789903180226301953" rel="nofollow">three-dimensional voxel tileset</a> based on my castle tileset.  Nick uses the textual data output option in a tile model to recreate 3D models in Cinema 4D. </li><li>  Sean Lefler implemented a <a href="https://github.com/sdleffler/collapse">model with an overlap on Rust</a> . </li><li>  rid5x creates <a href="https://twitter.com/rid5x/status/782442620459114496" rel="nofollow">a WFC version on OCaml</a> . </li><li>  I published a simple <a href="https://bitbucket.org/mxgmn/basic3dwfc/overview" rel="nofollow">three-dimensional tile model</a> so that people could create their own 3D tile sets without waiting for the full repository of the three-dimensional algorithm. </li><li>  I created <a href="https://twitter.com/ExUtumno/status/798571284342837249" rel="nofollow">an interactive model of the</a> model with overlapping.  An executable GUI file can be downloaded <a href="https://exutumno.itch.io/wavefunctioncollapse" rel="nofollow">from the WFC page on itch.io.</a> </li><li>  <a href="https://github.com/unormal">Brian Bachlyu has</a> assembled a level generation pipeline for the game <a href="http://store.steampowered.com/app/333640" rel="nofollow">Caves of Qud</a> , in several passages of which WFC is used: <a href="https://twitter.com/unormal/status/805987523596091392" rel="nofollow">1</a> , <a href="https://twitter.com/unormal/status/808566029387448320" rel="nofollow">2</a> , <a href="https://twitter.com/unormal/status/808523056259993601" rel="nofollow">3</a> , <a href="https://twitter.com/unormal/status/808523493994364928" rel="nofollow">4</a> , <a href="https://twitter.com/unormal/status/808519575264497666" rel="nofollow">5</a> , <a href="https://twitter.com/unormal/status/808519216185876480" rel="nofollow">6</a> , <a href="https://twitter.com/unormal/status/808795396508123136" rel="nofollow">7</a> , <a href="https://twitter.com/unormal/status/808860105093632001" rel="nofollow">8</a> , <a href="https://twitter.com/unormal/status/809637856432033792" rel="nofollow">9</a> , <a href="https://twitter.com/unormal/status/810239794433425408" rel="nofollow">10</a> , <a href="https://twitter.com/unormal/status/811034574973243393" rel="nofollow">11</a> , <a href="https://twitter.com/unormal/status/811720423419314176" rel="nofollow">12</a> , <a href="https://twitter.com/unormal/status/811034037259276290" rel="nofollow">13</a> , <a href="https://twitter.com/unormal/status/810971337309224960" rel="nofollow">14</a> , <a href="https://twitter.com/unormal/status/811405368777723909" rel="nofollow">15</a> , <a href="https://twitter.com/ptychomancer/status/812053801544757248" rel="nofollow">16</a> , <a href="https://twitter.com/unormal/status/812159308263788544" rel="nofollow">17</a> , <a href="https://twitter.com/unormal/status/812158749838340096" rel="nofollow">18</a> , <a href="https://twitter.com/unormal/status/814569437181476864" rel="nofollow">19</a> , <a href="https://twitter.com/unormal/status/814570383189876738" rel="nofollow">20</a> , <a href="https://twitter.com/unormal/status/819725864623603712" rel="nofollow">21</a> . </li><li>  <a href="https://github.com/dannywynne">Danny Uyna</a> implemented a <a href="https://twitter.com/dwtw/status/810166761270243328" rel="nofollow">three-dimensional tile model</a> . </li><li>  Arvi Tekari has programmed <a href="http://www.hempuli.com/blogblog/archives/1598" rel="nofollow">a texture synthesis algorithm with entropy heuristics</a> on Lua.  Headchant <a href="https://github.com/headchant/iga">ported</a> it to work with LÖVE. </li><li>  Isaac Kert created an overlapping <a href="https://github.com/ikarth/wfc_python">Python</a> model <a href="https://github.com/ikarth/wfc_python">port</a> . </li><li>  Oscar Stalberg created <a href="http://oskarstalberg.com/game/wave/wave.html" rel="nofollow">an interactive version of the</a> tile model that runs in the browser. </li><li>  <a href="https://github.com/MattRix">Matt Rix</a> implemented a three-dimensional tile model ( <a href="https://twitter.com/MattRix/status/869403586664570880" rel="nofollow">1</a> , <a href="https://twitter.com/MattRix/status/870999185167962113" rel="nofollow">2</a> , <a href="https://twitter.com/MattRix/status/871054734018453505" rel="nofollow">3</a> , <a href="https://twitter.com/MattRix/status/871056805761359872" rel="nofollow">4</a> ) and created a three-dimensional tile model in which one of the dimensions is time ( <a href="https://twitter.com/MattRix/status/872674537799913472" rel="nofollow">1</a> , <a href="https://twitter.com/MattRix/status/872648369625325568" rel="nofollow">2</a> , <a href="https://twitter.com/MattRix/status/872645716660891648" rel="nofollow">3</a> , <a href="https://twitter.com/MattRix/status/872641331956518914" rel="nofollow">4</a> , <a href="https://twitter.com/MattRix/status/979020989181890560" rel="nofollow">5</a> ). </li><li>  <a href="https://github.com/NNNenov">Nick Nenov</a> created a <a href="" rel="nofollow">visual guide</a> on the system of symmetry of tiles. </li><li>  <a href="https://github.com/ikarth">Isaac Kert</a> and <a href="https://github.com/rndmcnlly">Adam M. Smith</a> wrote a <a href="https://adamsmith.as/papers/wfc_is_constraint_solving_in_the_wild.pdf" rel="nofollow">research paper</a> in which they formulate the WFC as an ASP task, use the generic common constraint <a href="https://github.com/potassco/clingo">resolver clingo</a> to generate bitmaps, experiment with global constraints, trace the history of the WFC, and give a detailed description of the algorithm. </li><li>  Silvan Lefevre created <a href="https://github.com/sylefeb/VoxModSynth">a C ++ implementation of the</a> synthesis of three-dimensional models, described the thinking process of creating a sample, and set an example in which the neighborhood constraints ensure that the output data is connected (they can be circumvented). </li><li>  I summarized the three-dimensional WFC, so that he worked with the cube symmetry group and created a tileset that generates <a href="https://twitter.com/ExUtumno/status/895684431477747715" rel="nofollow">scenes in the spirit of Escher</a> . </li><li>  There are many ways to visualize partially observed wave states.  In the code, the color values ​​of the possible variants are averaged to obtain the final color.  Oscar Stalberg <a href="https://twitter.com/OskSta/status/863019585162932224" rel="nofollow">shows</a> partially observable states as translucent rectangles: the more options, the larger the rectangle.  In the voxel scheme, I <a href="https://twitter.com/ExUtumno/status/900395635412787202" rel="nofollow">visualize the</a> wave states by pixel-by-pixel voting. </li><li>  Remy Devo implemented the TIC model in PICO-8 and wrote <a href="https://trasevol.dog/2017/09/01/di19/" rel="nofollow">an article</a> on generating coherent data with an explanation to the WFC. </li><li>  For his game <a href="https://www.badnorth.com/" rel="nofollow">Bad North,</a> Oscar Stalberg <a href="https://twitter.com/OskSta/status/917405214638006273" rel="nofollow">uses</a> heuristics, which tries to select such secrets so that at each stage the resulting observed zone is passable. </li><li>  William Manning <a href="https://github.com/heyx3/easywfc">implemented</a> the C # overlapping model;  first of all, he wanted to make the code readable, and added a graphical interface to WPF. </li><li>  <a href="https://gist.github.com/selfsame">Joseph Parker</a> wrote a WFC <a href="http://www.procjam.com/tutorials/wfc/" rel="nofollow">tutorial</a> for Procjam 2017. </li><li>  <a href="https://github.com/aman-tiwari">Aman Tiwari</a> formulated connection restriction as an <a href="https://gist.github.com/aman-tiwari/8a7b874cb1fd1270adc203b2af293f4c">ASP task</a> for clingo. </li><li>  MatveyK has programmed a <a href="https://github.com/MatveyK/Kazimir">three-dimensional model with overlap</a> . </li><li>  <a href="https://github.com/sylefeb">Silvan Lefevre</a> , <a href="https://github.com/1iyiwei">Lee Yu Wei</a> and <a href="https://github.com/connellybarnes">Connelly Barnes</a> <a href="https://hal.archives-ouvertes.fr/hal-01706539/" rel="nofollow">are exploring the</a> possibility of hiding information inside textures.  They created a <a href="https://members.loria.fr/Sylvain.Lefebvre/infotexsyn/" rel="nofollow">tool</a> that can encode text messages as WFC tiles and decode them back.  This technique allows you to use WFC tiles as QR codes. </li><li>  <a href="https://github.com/math-fehr">Mathieu Fer</a> and <a href="https://github.com/Ekdohibs">Nathaniel Curan have</a> significantly <a href="https://github.com/math-fehr/fast-wfc">improved</a> the WFC runtime, for the overlapped model - an order of magnitude.  I <a href="https://github.com/mxgmn/WaveFunctionCollapse/commit/fad1066b5000f7e9fbda0ef81bbea56799686670">integrated</a> their enhancements into the code. </li><li>  Vasu Mahesh has <a href="https://github.com/vasumahesh1/WFC_WebGL">ported a</a> three-dimensional tile model in TypeScript, created a new tileset and <a href="https://vasumahesh1.github.io/WFC_WebGL" rel="nofollow">visualized</a> the generation process in WebGL. </li><li>  <a href="https://github.com/greentec">Kim Huanghi</a> experimented with three-dimensional WFC and created / adapted many voxel tile sets: <a href="https://twitter.com/greentecq/status/1025348928634408960" rel="nofollow">1</a> , <a href="https://twitter.com/greentecq/status/1004068394553913344" rel="nofollow">2</a> , <a href="https://twitter.com/greentecq/status/1005835830802305024" rel="nofollow">3</a> , <a href="https://twitter.com/greentecq/status/1022851327041265664" rel="nofollow">4</a> , <a href="https://twitter.com/greentecq/status/1011351814216736769" rel="nofollow">5</a> , <a href="https://twitter.com/greentecq/status/1008210550944387077" rel="nofollow">6</a> , <a href="https://twitter.com/greentecq/status/1006390606875070464" rel="nofollow">7</a> , <a href="https://twitter.com/greentecq/status/1015182718810841088" rel="nofollow">8</a> . </li><li>  Oscar Stalberg delivered a <a href="https://www.youtube.com/watch%3Fv%3D0bcZb-SsnrA" rel="nofollow">report</a> on the generation of levels in Bad North at the Everything Procedural Conference 2018. </li><li>  I <a href="https://twitter.com/ExUtumno/status/1024314661951467521" rel="nofollow">wrote</a> about how to generate (approximately) undistorted paths between two points using the WFC and other algorithms. </li><li>  <a href="https://github.com/ikarth">Ayzer Kert</a> and <a href="https://github.com/rndmcnlly">Adam M. Smith</a> published a <a href="https://arxiv.org/abs/1809.04432" rel="nofollow">preprint</a> that describes a WFC-based system that learns from positive and negative examples, and talked about it in the general context of dialogues with example-based generators. </li><li>  Brendan Anthony <a href="https://steamcommunity.com/games/314230/announcements/detail/3369147113795750369" rel="nofollow">uses the</a> WFC to generate wall decorations in the game <a href="https://store.steampowered.com/app/314230/Rodina/" rel="nofollow">Rodina</a> . </li><li>  Tim Kong implemented <a href="https://github.com/Mitim-84/WFC-Gen">the overlap model on Haxe</a> . </li><li>  For the generation of connected structures, Boris the Brave applied the <a href="https://www.boristhebrave.com/2018/04/28/random-paths-via-chiseling" rel="nofollow">chiseling method</a> to the WFC.  He published a <a href="https://boristhebrave.github.io/DeBroglie" rel="nofollow">library</a> that supports hexagonal grids, additional restrictions, and a reversion. </li><li>  <a href="https://github.com/marian42">Marian Kleineberg</a> <a href="https://twitter.com/marian42_/status/1061785383057440768" rel="nofollow">created</a> <a href="https://marian42.itch.io/wfc" rel="nofollow">a city generator</a> for Procjam 2018 based on a tile model.  He wrote <a href="https://marian42.de/article/wfc" rel="nofollow">an article</a> describing his approaches to setting a neighborhood, going back and online variations of the WFC. </li><li>  Sol Bekich has <a href="https://github.com/s-ol/gpWFC">programmed</a> the PyopenCL tile model running on the GPU.  Instead of storing a queue of nodes from which to propagate, this model runs in parallel from each grid node. </li><li>  Wouter van Oortmerssen <a href="https://github.com/aardappel/lobster/commit/703f67472bfd80c26bb626e1d5c22ec91047da98">implemented a</a> tile model in a single C ++ function with a structure to speed up the observation, similar to the priority queue. </li><li>  Robert Hoenig <a href="">implemented</a> the Julia overlap model with the option of distributing constraints only locally. </li><li>  <a href="https://github.com/edwinRNDR">Edwin Jacobs</a> applied the WFC to <a href="https://twitter.com/voorbeeld/status/1073874337248239616" rel="nofollow">style shifting</a> and <a href="https://twitter.com/voorbeeld/status/1073875725499985926" rel="nofollow">dithering</a> . </li></ul><br><h2>  Thanks </h2><br>  Some examples are from Ultima IV and <a href="https://github.com/crawl/crawl">Dungeon Crawl</a> .  Taylset Circles taken from <a href="https://twitter.com/quasimondo/status/778196128957403136" rel="nofollow">Mario Klingemann</a> .  The idea of ​​generating integrated circuits was proposed by <a href="https://twitter.com/Moonasaur/status/759890746350731264" rel="nofollow">Moonasaur</a> , and their style was taken from the game <a href="http://www.zachtronics.com/ruckingenur-ii/" rel="nofollow">Ruckingenur II</a> of Zachtronics.  The Cat overlap example is taken from the Nyan Cat video, the Qud example was created by <a href="https://github.com/unormal">Brian Buckley</a> , Magic Office + Spirals - rid5x examples, the Overlaid Examples Colored City + Link + Link 2 + Mazelike + Red Dot + Smile City - Arvi Tekari.  Summer Tailset was created by Hermann Hillmann.  Voxel models are rendered in <a href="http://ephtracy.github.io/" rel="nofollow">MagicaVoxel</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02d/029/b2f/02d029b2f06f1d6286fd7613a7d07e6c.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8b8/be6/571/8b8be6571c054c3a4e51be7135188757.png"></div></div>