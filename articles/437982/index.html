<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The new attack of the Shade encoder is aimed at Russian business users.</title>
  <meta name="description" content="In January 2019, we recorded a sharp increase in the number of detections of malicious JavaScript email attachments (in 2018, this attack vector was m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>The new attack of the Shade encoder is aimed at Russian business users.</h1><div class="post__text post__text-html js-mediator-article">  In January 2019, we recorded a sharp increase in the number of detections of malicious JavaScript email attachments (in 2018, this attack vector was minimally used).  In the "New Year's release" you can select a distribution in Russian, intended for the distribution of the Shade encoder (aka Troldesh), which is detected by ESET products as Win32 / Filecoder.Shade. <br><br>  It seems that this attack continues the spam campaign to distribute the Shade encoder, discovered <a href="https://isc.sans.edu/forums/diary/Russian%2Blanguage%2Bmalspam%2Bpushing%2BShade%2BTroldesh%2Bransomware/24358/">in October 2018</a> . <br><br><img src="https://habrastorage.org/webt/gj/qd/le/gjqdlenhek1d4dftrqbviwdivyw.jpeg"><br><br><a name="habracut"></a><h3>  New Campaign Shade </h3><br>  According to our telemetry, the October campaign was at a constant pace until the second half of December 2018.  This was followed by a break at Christmas, and then in mid-January 2019, the campaign‚Äôs activity doubled (see chart below).  Falls on the chart, corresponding to weekends, suggest that attackers prefer corporate email addresses. <br><br><img src="https://habrastorage.org/webt/qs/rm/tr/qsrmtrxwcgdagqx89m0wk__2r0o.png"><br>  <i>Figure 1. Detection of malicious JavaScript attachments distributing Win32 / Filecoder.Shade since October 2018</i> <br><br>  As mentioned earlier, the campaign illustrates the trend that we have seen since the beginning of 2019, the return of malicious JavaScript attachments as an attack vector.  The dynamics are displayed on the chart below. <br><br><img src="https://habrastorage.org/webt/wo/yu/zi/woyuzi5gee0wlpcxkh4n40z7hv0.png"><br>  <i>Figure 2. Detection of malicious javascript distributed in email attachments since 2018.</i>  <i>Attachments are detected by ESET as JS / Danger.ScriptAttachment</i> <br><br>  It is worth noting that the campaign for the dissemination of the Shade encoder is most active in Russia, accounting for 52% of the total number of malicious attachments detected by JavaScript.  Other victims include Ukraine, France, Germany, and Japan, as shown below. <br><br><img src="https://habrastorage.org/webt/bm/jk/sv/bmjksv9vbijmwhnouha-qiwgjoo.png"><br>  <i>Figure 3. The number of malicious JavaScript attachments detected distributing Win32 / Filecoder.Shade.</i>  <i>Data from January 1 to January 24, 2019</i> <br><br>  According to our analysis, a typical attack of the January campaign begins with the victim receiving a letter in Russian with a ZIP file info.zip or inf.zip as an attachment. <br><br>  Letters are disguised as official requests of legitimate Russian companies.  We saw the newsletter on behalf of Binbank (merged with Otkritie Bank since 2019) and the Magnit retail chain.  The text in the image below. <br><br><img src="https://habrastorage.org/webt/eb/oa/-6/eboa-6ajfij5emkswmuleyvzv6o.png"><br>  <i>Figure 4. Sample spam mailing used in the January campaign</i> <br><br>  The ZIP file contains a JavaScript file called ‚ÄúInfo.js‚Äù.  After extracting and running the file, it downloads a malicious loader detected by ESET products as Win32 / Injector.  The loader decrypts and launches the final payload - the Shade encoder. <br><br>  The malicious loader is downloaded from the URL of compromised legitimate WordPress sites, where it disguises itself as an image.  To compromise WordPress pages, attackers use a massive, automated brute force attack using bots.  Our telemetry captures hundreds of URLs that host the malicious loader, all addresses end with the ssj.jpg line. <br><br>  The loader is signed with an invalid digital signature, which is allegedly issued by Comodo.  The Signer information field value and time stamp are unique for each sample. <br><br><img src="https://habrastorage.org/webt/3i/ym/vd/3iymvdxpiz5r98h4uxmbdzeeumm.png"><br>  <i>Figure 5. Counterfeit digital signature used by the malicious loader</i> <br><br>  In addition, the bootloader is trying to disguise itself, posing as a legitimate system process Client Server Runtime Process (csrss.exe).  It copies itself to C: \ ProgramData \ Windows \ csrss.ex, where Windows is a hidden folder created by the bootloader;  usually in ProgramData this folder is not. <br><br><img src="https://habrastorage.org/webt/9x/j_/kg/9xj_kginwpcjo9is6qwfi1wopk0.png"><br>  <i>Figure 6. Malicious software that is a system process and uses version information copied from a legitimate Windows Server 2012 R2 binary file</i> <br><br><h3>  Shade Encoder </h3><br>  The final payload is the Shade (Troldesh) encoder.  It was first discovered in the wild at the end of 2014, and has since been repeatedly updated.  Shade encrypts a wide range of files on local drives.  In the new campaign, he adds the extension .crypted000007 to the encrypted files. <br><br>  The victim receives payment instructions in Russian and English in the TXT file stored on the infected computer.  The text is the same as in the last campaign in October 2018. <br><br><img src="https://habrastorage.org/webt/ya/nb/-7/yanb-7sxftal1iok1hpyaoyvows.png"><br>  <i>Figure 7. Shade buyout requirements, January 2019</i> <br><br><h3>  Indicators of compromise </h3><br>  <b>Examples of hashes of malicious ZIP attachments</b> <br> <code>0A76B1761EFB5AE9B70AF7850EFB77C740C26F82 <br> D072C6C25FEDB2DDF5582FA705255834D9BC9955 <br> 80FDB89B5293C4426AD4D6C32CDC7E5AE32E969A <br> 5DD83A36DDA8C12AE77F8F65A1BEA804A1DF8E8B <br> 6EA6A1F6CA1B0573C139239C41B8820AED24F6AC <br> 43FD3999FB78C1C3ED9DE4BD41BCF206B74D2C76</code> <br> <br>  ESET Detection: JS / Danger.ScriptAttachment <br><br>  <b>Examples of JavaScript hash loaders</b> <br> <code>37A70B19934A71DC3E44201A451C89E8FF485009 <br> 08C8649E0B7ED2F393A3A9E3ECED89581E0F9C9E <br> E6A7DAF3B1348AB376A6840FF12F36A137D74202 <br> 1F1D2EEC68BBEC77AFAE4631419E900C30E09C2F <br> CC4BD14B5C6085CFF623A6244E0CAEE2F0EBAF8C</code> <br> <br>  ESET Detection: Win32 / Injector <br><br>  <b>Examples of Shade encoder hashes</b> <br> <code>FEB458152108F81B3525B9AED2F6EB0F22AF0866 <br> 7AB40CD49B54427C607327FFF7AD879F926F685F <br> 441CFA1600E771AA8A78482963EBF278C297F81A <br> 9023B108989B61223C9DC23A8FB1EF7CD82EA66B <br> D8418DF846E93DA657312ACD64A671887E8D0FA7</code> <br> <br>  ESET Detection: Win32 / Filecoder.Shade <br><br>  <b>Character string in URLs where Shade is coded</b> <br> <code>hxxp://[redacted]/ssj.jpg</code> </div><p>Source: <a href="https://habr.com/ru/post/437982/">https://habr.com/ru/post/437982/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>