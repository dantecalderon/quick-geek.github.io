<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>If Pascal‚Äôs CRT module were in JavaScript</title>
  <meta name="description" content="An attempt to implement a well-known CRT module used in Pascal in JavaScript. What came of it, and what does not, I will tell. 

 Introduction 
 My ac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>If Pascal‚Äôs CRT module were in JavaScript</h1><div class="post__text post__text-html js-mediator-article">  An attempt to implement a well-known CRT module used in Pascal in JavaScript.  What came of it, and what does not, I will tell. <br><a name="habracut"></a><br><h3>  Introduction </h3><br>  My acquaintance with programming began as early as the 8th grade, when I first learned in an informatics class what Pascal is and what it offers.  Then Turbo Pascal was installed on the school computers, although the informatics teacher had long wanted to put PascalABC.NET there.  Of course, it all started with the banal conclusions of the line in the console, my activity was mainly aimed at excellent preparation for the OGE.  No modules were studied, because no one demanded this at the exam. <br><br>  But even when I could ‚Äúsubordinate‚Äù the console window to myself, to display everything I wanted there, to make calculations, to accept input from the user, I was surprised how cool it was! <br><br>  But time goes on, life changes: OGE passed, Unified State Exam passed, successful entrance to the university.  All this time I have studied new languages ‚Äã‚Äãwith great interest, as a result of which I can easily write websites, be it front or back.  For some reason, web programming interests me the most. <br><br><h3>  How did it come to CRT </h3><br>  Back in school, I studied one of the interesting Pascal modules called CRT.  In fact, there is nothing complicated in it, the set of commands is, in fact, small, but they allowed you to create new things in the console window: move the cursor around the screen of 80x25 (DOS screen size), change the background and text colors, play the sound of a certain frequency and duration  It was possible to create full-fledged ASCII games, which practically did not take up space on the hard disk due to their small size. <br><br>  And now, a few years later, I decided, on the basis of interest, to write a small js file, by connecting which you can work with a browser window as with a console window.  I will say right away that it is very difficult, if possible at all, to restore intact the integrity and security of all the commands of a module.  Still, JavaScript is not Pascal, because of this, there are some features. <br><br><h3>  Idea itself </h3><br>  The project has a very simple structure of three files: <br><br><ul><li>  <b>crt.js</b> - a file with functions that you need to connect to the html file </li><li>  <b>index.html</b> - the file - the basis to be opened in the browser </li><li>  <b>user.js</b> is an empty file in which the programmer must write his code </li></ul><br>  First, I will name the teams that are currently implemented, and then I will show how they work. <br><br>  Implemented commands: <br><br><ul><li>  <b>gotoxy (x, y)</b> - move the cursor to the coordinates </li><li>  <b>write (str)</b> - output line to screen </li><li>  <b>clrscr ()</b> - <b>clears the</b> screen with a pre-selected background and moves the cursor to the coordinates of 1.1 </li><li>  <b>textcolor (int)</b> - change text color </li><li>  <b>textbackground (int)</b> - change the background color </li><li>  <b>sound (fr, 1000)</b> - play a sound with a frequency of fr and a duration of 1 second </li></ul><br>  Let's show an example of the work of the ‚Äúmodule‚Äù: <br><br>  Code: <br><br><img src="https://habrastorage.org/webt/wy/sq/_b/wysq_bhpgj0xgf4n2poik6sz5as.png" alt="image"><br><br>  Result: <br><br><img src="https://habrastorage.org/webt/f5/k4/va/f5k4va4q42wu6sopkl1-zo7ihjy.png" alt="image"><br><br>  You may think that the letters are separate from each other.  Yes, that is right.  The fact is that here the content of the page is divided into parts by divs.  Let's remember the size of the DOS window (80x25).  So how many divs are there?  That's right, 2000. Each of them is of equal size.  In general, when the page starts, the following function is automatically executed: <br><br><img src="https://habrastorage.org/webt/kl/bg/ne/klbgneghn5wypaqndgk4uzi-kda.png" alt="image"><br><br>  I specifically hung this job on JS.  I wanted the html file to be clean and clear. <br><br><img src="https://habrastorage.org/webt/2_/lg/kp/2_lgkpnwnfahl5iyhjzwrl5qkg4.png" alt="image"><br><br>  Yes, because of this scheme, there is an effect, when you start the page on a weak PC, I think, only 4-5 seconds will be loading, because the cycle is quite complicated.  I do not see any point in commenting on the line; the main actions are explained in the photo.  Each time we generate a div with certain id and parameters and add it to the body.  Each div contains <b>only one character</b> , as it was by analogy in DOS (one cell - one character). <br><br>  Work with coordinates and colors is based on these variables: <br><br><img src="https://habrastorage.org/webt/9p/tt/i1/9ptti1c4sxppjds3nxkog-masie.png" alt="image"><br><br>  The <b>gotoxy (x, y), textcolor (int), textbackground (int) commands</b> simply change the contents of the variables xnow, ynow, color, bgcolor. <br><br>  There are interesting moments with flowers.  In DOS, as we know, it was possible to choose a color from a set in which there were only 16 colors.  In Pascal, you can access the color using the number (0-15).  Moreover, in DOS, the background was selected only from the first eight colors, and the text from all 16. While in Windows in PascalABC.NET, when the module is connected, the background can be changed from all 16 colors.  Perhaps not everyone understood what I wanted to convey now, but let's explain with an example: <br><br><img src="https://habrastorage.org/webt/nu/cw/6v/nucw6vpmuqfohvykokpxgoepthu.png" alt="image"><br><br>  Here are all the colors that are used in the console.  If we try to change the background in DOS to a light green (10), then the background will turn green (2), while the font will become the color we required.  For some reason, the possibility of changing the background in DOS (Free Pascal) is limited to eight colors. <br><br>  And now about the clrscr command, which cleared the screen with a certain color.  In JS, I implemented it like this: <br><br><img src="https://habrastorage.org/webt/ua/tb/fj/uatbfjipqcspm1vl68wgmhxiytc.png" alt="image"><br><br>  There is nothing difficult.  We cycle through all the divs, where in each content we make empty (since the characters are erased in DOS) and change the background to the color selected in advance by the textbackground command.  And, of course, do not forget to return the cursor to position 1.1 (upper left corner of the window). <br><br>  The most interesting thing is to print the string with the <b>write</b> command.  Yes, I remember that there is still a writeln, but I figured that one command would be enough, since in this situation we are not interested in translating the cursor to a new line. <br><br>  Implementation: <br><br><img src="https://habrastorage.org/webt/xj/c3/wy/xjc3wyi72fuarpj8unmj3fx_3-k.png" alt="image"><br><br>  Here it was necessary to save the browser from an error, in case the user string was going to go beyond the window (and there are no divs!).  Therefore, it was decided to make a loop with protection break. <br><br>  Each letter must occupy a fully allocated cell, so the font size is governed by the size of a div.  Plus, do not forget that the background behind the letters should be changed to the one that was set by the textbackground command. <br><br>  And finally, the last function is sound.  Here, unfortunately, we had to change the command operation scheme, since it is difficult to implement the sound - delay - nosound chain.  By the way, I could not yet implement the delay, there are no ideas, since setTimeout is not suitable here. <br><br>  We remember that to output, for example, a sound with a frequency of 200 Hz and a duration of 1 second, you need to write code: <br><br><pre><code class="plaintext hljs">sound(200); delay(1000); nosound;</code> </pre> <br>  In JS, I had to do this: <br><br><img src="https://habrastorage.org/webt/jd/lw/jc/jdlwjc-mogc_ofeoyu4ff1u7gp0.png" alt="image"><br><br>  But it works!  Implementation: <br><br><img src="https://habrastorage.org/webt/wx/sx/zf/wxsxzfduayyubqpl9oi1uglisha.png" alt="image"><br><br>  I have never used such a specific function in my activities.  She had to spy in the documentation.  If someone checks the work, then be careful, after loud listening, your ears may hurt. <br><br>  True, when using this feature, Chrome, for obvious reasons, begins to swear: <br><br><img src="https://habrastorage.org/webt/ot/ft/y6/otfty6yghgvgsaaucicrukuw99m.png" alt="image"><br><br>  I tried to solve the problem with setTimeout, however this does not always work. <br><br>  But if you quickly click on the page during the download, the sound is played, but that's another story. <br><br><h3>  Conclusion </h3><br>  Even after the active mastering of sites, I want to try to write something unusual, even if it has no practical use.  Pascal with its CRT module really had an effect on me that encouraged me to further study programming languages.  Or maybe you should write something in ASCII style? <br><br>  <a href="https://github.com/StepIgor/crt_pascal_for_JS"><b>Just in case I posted it on github</b></a> </div><p>Source: <a href="https://habr.com/ru/post/438690/">https://habr.com/ru/post/438690/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>