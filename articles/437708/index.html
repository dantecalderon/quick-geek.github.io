<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Refactoring does not happen much</title>
  <meta name="description" content="Hi, Habr! I present to you the translation of the article " Refactoring - oops, I've been doing it backwards " by Justin Fuller (Justin Fuller). 


 I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Refactoring does not happen much</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  I present to you the translation of the article " <a href="https://medium.freecodecamp.org/refactoring-oops-ive-been-doing-it-backwards-55eed503ccd0">Refactoring - oops, I've been doing it backwards</a> " by Justin Fuller (Justin Fuller). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_p/sc/ew/_pscew0p77obdpwkceeojkldvlw.jpeg" height="550" width="400"></div><br>  I am very dependent on refactoring, and I am not afraid to admit it, but there is only one problem: I always did it back to front.  You see, what I was doing could be more accurately described as a premature code abstraction. <br><blockquote>  We all know about refactoring.  If you have read at least one book on programming or have been sitting on Medium for a long time, you have probably heard about it.  This is an important concept that makes the code understandable, maintainable and extensible. </blockquote>  So why did refactoring fail my expectations? <br><br>  When I wrote my last library, it took me a while to think about the evolution of my code.  I realized that before I had a fully working product, and before I had perfect results from my unit tests, I converted my code into an interface, although I wasn‚Äôt even sure if I would need it.  I moved the code, made it extensible, reusable, but why?  Will this code give me the final result I need?  I didn't know that yet. <br><br>  In the end, everything worked out, but was my code more complex than necessary?  I think yes. <a name="habracut"></a><br><br><h2>  Principle of Principles over Purpose </h2><br>  Have you heard of <a href="https://en.wikipedia.org/wiki/SOLID">SOLID principles</a> ?  I try to watch them closely.  Every function I write is focused on the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">principle of sole responsibility</a> .  My classes tend to be <a href="https://en.wikipedia.org/wiki/Open%25E2%2580%2593closed_principle">open to expansion</a> , ignoring modifications.  I also try not to depend directly on too many things, so instead I accept <a href="https://en.wikipedia.org/wiki/Dependency_inversion_principle">dependencies as arguments</a> in functions and classes. <br><br>  Is this a good code recipe?  I think yes.  The problem arises when my code focuses on conforming to SOLID principles, rather than executing what it was created for.  The problem comes when I put the principles above the goal. <br><br>  Remember my thinking at the beginning?  It reminded me of a mantra: <a href="http://wiki.c2.com/%3FMakeItWorkMakeItRightMakeItFast">‚ÄúMake it work, do it right, do it quickly</a> . <a href="http://wiki.c2.com/%3FMakeItWorkMakeItRightMakeItFast">‚Äù</a>  I realized that I did not follow this order.  I did everything right, quickly, and then I did it so that it worked! <br><br><h2>  Make it work </h2><br>  When I started writing more articles on Medium, it became clear that a good writing style did not come right away.  First I have to put all my thoughts on the page.  I have to see where these thoughts lead me.  Then I have to turn them into some kind of semi-cohesive and illegible version of what has just spilled out. <br><br>  The same thing can happen with the code. <br><br>  At first, you should not worry too much about naming, sole responsibility or extension - you will solve this problem as soon as your function works.  You are not going to write the whole application at once, only this one little piece. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ji/yb/xz/jiybxzkbplklp6tcndto86yds_e.jpeg" height="550" width="400"></div><br>  As soon as you get the result you were looking for (you have unit tests to prove that the code is correct), start refactoring, but don't go too far!  Stick to refactoring strategies that fall into the category of proper naming, functions that perform only one task, and avoid changes;  do not immediately start building extensible or reusable classes until you define a duplicate template. <br><br>  Consider deferring refactoring with templates that are only useful in certain scenarios.  You will want to keep them until you have a reason. <br><br><h2>  Have reason to refactor </h2><br><blockquote>  The presence of a SOLID code is not the cause.  The presence of a functional or pure code is also not the cause. </blockquote>  Why do we make our code extensible?  Thus, similar, but not quite the same functionality can deviate from the basic logic. <br><br>  Why do we invert dependencies?  In order that the business logic could be used by several implementations. <br><br>  I hope you understand where I lead.  Some refactoring is needed on its own.  For example, refactoring a variable name to become more accurate will always make sense.  His merit is inalienable.  Transferring a function to a pure state usually makes sense, since  side effects can cause unforeseen problems.  All this causes. <br><br>  ‚ÄúIt‚Äôs considered best to use dependency inversion‚Äù is not the reason.  ‚ÄúGood code is extensible code‚Äù is also not the reason.  What if I only have a pair of unchanged dependencies?  Do I still need dependency inversion?  Not yet.  What if nothing is needed to extend my code, and I don‚Äôt plan to do that at all?  Do I have to complicate my code just to check this box?  Not! <br><br>  Look at the following example. <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// not extensible function getUser() { return { name: 'Justin', email: 'justinfuller@email.com' } } // Extensible class User { constructor(options = {}) { this.userData = options } get() { return this.userData } set(key, value) { this.userData[key] = value } }</span></span></code> </pre> <br>  What do you prefer?  What do you usually write in the first place?  Of course, the <code>User</code> class is much more extensible, because it can handle not only the name and email.  It can also be expanded by a child class, maybe <code>SuperUser</code> , which will have many more methods, but still uses the classic <code>get()</code> and <code>set()</code> methods. <br><br>  However, the <code>User</code> class may be redundant, and your code may become much more complicated than it ever needs. <br><br>  My advice - stick to the simplest pattern. <br><br><h2>  Complexity order </h2><br>  And now, with your permission, I'm going to come up with something.  I call this the complexity order, and that helps me when I make refactoring decisions.  Here's what it looks like: <br><br><ul><li>  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const">Constant variable (constant variable)</a> </li><li>  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let">Variable Variable (Mutable Variable)</a> </li><li>  Collection (Object, Array) </li><li>  Function </li><li>  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">Closure</a> function </li><li>  Factory (a function that returns a collection) </li><li>  Class </li></ul><br>  Whenever I decide how to organize the functionality, I refer to this list.  I will not choose again until it just starts working.  Sometimes performance affects this choice, but not so often. <br><br>  Usually I put something in an object instead of a simple constant variable.  This list keeps me in control and prevents from premature refactoring. <br><br><h2>  Balance </h2><br>  I recently heard that if you say at a meeting, ‚Äúin fact, it all comes down to finding the right balance,‚Äù everyone will nod their head at your meaningless comment, as if you said something clever. <br><br>  However, I think the balance is still important.  As programmers, we need to balance code quality, performance, and serviceability with the need to get things done. <br><br>  We must be vigilant and ensure that both needs remain in place.  Our code cannot be serviced unless it works correctly.  On the other hand, it‚Äôs hard to make bad code work properly. <br><br>  The next time you want to refactor your code, think, is it worth it? </div><p>Source: <a href="https://habr.com/ru/post/437708/">https://habr.com/ru/post/437708/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>