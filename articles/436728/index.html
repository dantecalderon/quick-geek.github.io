<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ML.NET tutorial - the first application in 10 minutes</title>
  <meta name="description" content="Last year, we introduced ML.NET, a cross-platform and open machine learning system for .NET developers. During this time, she has developed very much ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>ML.NET tutorial - the first application in 10 minutes</h1><div class="post__text post__text-html js-mediator-article">  Last year, we introduced ML.NET, a cross-platform and open machine learning system for .NET developers.  During this time, she has developed very much and has gone through many versions.  Today we are sharing a guide on how to create your first ml.net application in 10 minutes. <br><br><img src="https://habrastorage.org/webt/fl/l6/qp/fll6qpsanziou8gxidcpb9kplhk.jpeg"><a name="habracut"></a><br><br>  * <a href="https://habr.com/ru/company/microsoft/blog/436732/">This is an English manual</a> . <br><br>  ** Below is a tutorial for Windows.  But exactly the same can be done on <a href="https://dotnet.microsoft.com/learn/machinelearning-ai/ml-dotnet-get-started-tutorial%3Finitial-os%3Dmacos">MacOS</a> / <a href="https://dotnet.microsoft.com/learn/machinelearning-ai/ml-dotnet-get-started-tutorial%3Finitial-os%3Dlinux">Linux</a> . <br><br><h2>  Install .NET SDK </h2><br>  To start creating .NET applications, you just need to download and install the .NET SDK (Software Development Kit). <br><br> <a href=""><img src="https://habrastorage.org/webt/jp/f7/gh/jpf7ghyfyohwemhpv71vqrw1oko.png"></a> <br><br><h2>  Create your application </h2><br>  Open a command prompt and run the following commands: <br><br><pre><code class="cpp hljs">dotnet <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> console -o myApp cd myApp</code> </pre> <br>  The <code>dotnet</code> command will create for you a <code>new</code> <code>console</code> type application.  The <code>-o</code> <code>myApp</code> creates a directory called <code>myApp</code> in which your application is stored, and fills it with the necessary files.  The cd myApp command will return you to the newly created application directory. <br><br><h2>  Install ML.NET package </h2><br>  To use ML.NET, you need to install the Microsoft.ML package.  At the command prompt, run the following command: <br><br><pre> <code class="cpp hljs">dotnet add package Microsoft.ML --version <span class="hljs-number"><span class="hljs-number">0.9</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br><h2>  Download DB </h2><br>  Our exemplary machine learning application will predict the type of iris flower (setosa, versicolor or virginica) based on four characteristics: petal length, petal width, sepal length, and sepal width. <br><br>  Open the <a href="">UCI</a> machine learning repository: Iris dataset, copy and paste the data into a text editor (for example, Notepad) and save it as <code>iris-data.txt</code> in the <code>myApp</code> directory. <br><br>  When you add data, it will look like this: each row represents a different pattern of an iris flower.  From left to right, the columns represent: the length of the sepal, the width of the sepal, the length of the petal, the width of the petal, and the type of iris flower. <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">5.1</span></span>,<span class="hljs-number"><span class="hljs-number">3.5</span></span>,<span class="hljs-number"><span class="hljs-number">1.4</span></span>,<span class="hljs-number"><span class="hljs-number">0.2</span></span>,Iris-setosa <span class="hljs-number"><span class="hljs-number">4.9</span></span>,<span class="hljs-number"><span class="hljs-number">3.0</span></span>,<span class="hljs-number"><span class="hljs-number">1.4</span></span>,<span class="hljs-number"><span class="hljs-number">0.2</span></span>,Iris-setosa <span class="hljs-number"><span class="hljs-number">4.7</span></span>,<span class="hljs-number"><span class="hljs-number">3.2</span></span>,<span class="hljs-number"><span class="hljs-number">1.3</span></span>,<span class="hljs-number"><span class="hljs-number">0.2</span></span>,Iris-setosa ...</code> </pre> <br><h4>  Using Visual Studio? </h4><br>  If you are using Visual Studio, you need to configure <code>iris-data.txt</code> to copy to output directories. <br><br><img src="https://habrastorage.org/webt/1w/pf/gz/1wpfgzpo_au0zd2fyncqrrgb8ba.png"><br><br><h2>  A little bit of cod </h2><br>  Open <code>Program.cs</code> in any text editor and replace the entire code with the following: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.ML; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.ML.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> myApp { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Program</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">// –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–∞—à–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö // IrisData –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ // –∫–∞–∫ –≤–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π // - –ü–µ—Ä–≤—ã–µ 4 —Å–≤–æ–π—Å—Ç–≤–∞ -- —ç—Ç–æ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ / —Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ—Ç–∫–∏ label // - Label -- —ç—Ç–æ —Ç–æ, —á—Ç–æ –≤—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç–µ, –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ public class IrisData { [LoadColumn(0)] public float SepalLength; [LoadColumn(1)] public float SepalWidth; [LoadColumn(2)] public float PetalLength; [LoadColumn(3)] public float PetalWidth; [LoadColumn(4)] public string Label; } // IrisPrediction —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã–º –∏–∑ –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è public class IrisPrediction { [ColumnName("PredictedLabel")] public string PredictedLabels; } static void Main(string[] args) { // –®–∞–≥ 2: —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–µ–¥—ã ML.NET var mlContext = new MLContext(); // –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ Visual Studio, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä 'Copy to Output Directory' // iris-data.txt —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ 'Copy always' var reader = mlContext.Data.CreateTextReader&lt;IrisData&gt;(separatorChar: ',', hasHeader: true); IDataView trainingDataView = reader.Read("iris-data.txt"); // –®–∞–≥ 3: –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ learner // –ü—Ä–∏—Å–≤–æ–π—Ç–µ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç—É –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´label¬ª, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–æ–ª—å–∫–æ // —á–∏—Å–ª–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏. // –î–æ–±–∞–≤—å—Ç–µ –æ–±—É—á–∞—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤ pipeline. –ù–∞–ø—Ä–∏–º–µ—Ä (What type of iris is this?) // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å label –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç (–ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —á–∏—Å–ª–æ –Ω–∞ —à–∞–≥–µ 3) var pipeline = mlContext.Transforms.Conversion.MapValueToKey("Label") .Append(mlContext.Transforms.Concatenate("Features", "SepalLength", "SepalWidth", "PetalLength", "PetalWidth")) .Append(mlContext.MulticlassClassification.Trainers.StochasticDualCoordinateAscent(labelColumn: "Label", featureColumn: "Features")) .Append(mlContext.Transforms.Conversion.MapKeyToValue("PredictedLabel")); // –®–∞–≥ 4: –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å –Ω–∞ —ç—Ç–æ–º –¥–∞—Ç–∞-—Å–µ—Ç–µ var model = pipeline.Fit(trainingDataView); // –®–∞–≥ 5: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è // –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–∏ —Ü–∏—Ñ—Ä—ã, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã var prediction = model.CreatePredictionEngine&lt;IrisData, IrisPrediction&gt;(mlContext).Predict( new IrisData() { SepalLength = 3.3f, SepalWidth = 1.6f, PetalLength = 0.2f, PetalWidth = 5.1f, }); Console.WriteLine($"Predicted flower type is: {prediction.PredictedLabels}"); } } }</span></span></code> </pre> <br><h2>  Run your application </h2><br>  At the command prompt, run the following command: <br><br><pre> <code class="cpp hljs">dotnet run</code> </pre> <br>  The last line of output is the predicted type of iris flower.  You can change the values ‚Äã‚Äãpassed to the <code>Predict</code> function to see predictions based on various measurements. <br><br>  Congratulations, you created your first machine learning model with ML.NET! <br><br><h2>  Do not stop there </h2><br>  Now that you have the basics, you can continue your studies with our ML.NET tutorials. <br><br> <a href="https://docs.microsoft.com/dotnet/machine-learning/tutorials"><img src="https://habrastorage.org/webt/eg/rw/j3/egrwj3v_uhevufss4mk-y1nnp1k.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/436728/">https://habr.com/ru/post/436728/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>