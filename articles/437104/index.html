<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introscope: well, very lazy unit testing</title>
  <meta name="description" content="We at work write a lot of frequently changing business logic on JS (a startup). Even too much. And all this would be desirable because of the old habi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Introscope: well, very lazy unit testing</h1><div class="post__text post__text-html js-mediator-article"><p>  We at work write a lot of frequently changing business logic on JS (a startup).  Even too much.  And all this would be desirable because of the old habit of testing, but somehow quickly, so that tests do not particularly interfere with govnododit, when it is needed, and do not tailor the module structure especially strongly for tests.  At some point, the thought came that one could also automate it somehow with the help of a simple babel plug-in, so that it would first turn all private variables and methods in the test environment, and in production it would not touch.  It turned out to be quite simple and fascinating.  This is how <a href="https://github.com/peter-leonov/introscope">Introscope</a> appeared, with which we are now testing everything that is more or less complex. </p><a name="habracut"></a><br><p>  Having handed over the project, I was distracted for several months to improve the deployment and monitoring, I rested, read Habr, and when it took to test something again, I was directly delighted with my own tool!  It does not often happen to me.  More precisely, never had before.  So, I think that thing works.  I hope you also come in handy. </p><br><h2 id="korotko-chto-ono-umeet">  In short, what can it do? </h2><br><ol><li>  Wraps the entire module in the factory function so that you can create as many new modules as you need during testing.  This eliminates the need to do unmock. </li><li>  Since the module is wrapped, the tool knows exactly which variables the module imports and can generate mocks by their type.  It works very well for a more or less functional style. </li><li>  It knows how to log calls and arguments to functions from external modules and put it all into a log, which is then beautifully serialized for snapshots (if you use Jest, then everything will immediately get started). </li><li>  Killer feature: can save the result of a call to an external function and use it with further testing.  It is very convenient when testing requests to external services that we used to drive into moki. </li><li>  In combination with Jest, the tests are updated by clicking on one (I'm not joking) button U, which updates snapshots.  Golden test approach in all its glory. </li><li>  Works in production for almost a year. </li></ol><br><h2 id="v-rezultate">  As a result </h2><br><p>  Tests began to be written by people who didn‚Äôt even want to hear about them before, because you only need to call a function with the necessary parameters and save a log of what happened in this function with one button.  I really wanted to test something else ... </p><br><p>  Reference: <a href="https://github.com/peter-leonov/introscope">Introscope</a> (there are still gifs screenshots!).  I would be very happy constructive criticism and references to the same, but the done is much better: D </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/822/3c0/4ad/8223c04ad14711ad2af235ea9715b831.gif" alt="image"></p></div><p>Source: <a href="https://habr.com/ru/post/437104/">https://habr.com/ru/post/437104/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>