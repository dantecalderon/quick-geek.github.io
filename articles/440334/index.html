<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open webinar "Development of highly loaded systems for PHP"</title>
  <meta name="description" content="Good evening! On the eve of the start of the course ‚ÄúBackend-developer on PHP‚Äù we traditionally held an open lesson. They talked about high-load syste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>Open webinar "Development of highly loaded systems for PHP"</h1><div class="post__text post__text-html js-mediator-article">  Good evening!  On the eve of the start of the course <a href="https://otus.pw/Z22g/">‚ÄúBackend-developer on PHP‚Äù</a> we traditionally held an open lesson.  They talked about high-load systems, scaling, architecture.  Considered in detail HighLoad, as well as the main approaches and tactics in the development of high-load systems. <br><br>  The following occupation goals were set: <br><br><ul><li>  discuss what systems architecture is and why it is needed; </li><li>  discuss what High Load is; </li><li>  consider architectural tactics; </li><li>  discuss the course. </li></ul><br>  The teacher is <a href="https://otus.pw/pa98/">Igor Sakhankov</a> , the developer on Booking.com. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zt0OUEcljy4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h3>  Architecture </h3><br>  A couple of hundred years ago, the Swedish king Gustaf II Adolf wanted to build the world's largest ship.  He invited Dutch shipbuilder Henrik H√ºbertsson and gave him his instructions.  The master never built anything of the kind, but he had a lot of experience in building small ships.  It would seem that there is nothing difficult - take a drawing of a small ship and increase it in the required number of times.  No sooner said than done.  And now, after a few years of work, a remarkable and grandiose structure appeared: <br><br><img src="https://habrastorage.org/webt/nq/9q/sa/nq9qsaaay9bafheytgj-z16_yfa.png"><br><br>  All anything, but during the launching of this ship did not last half an hour, immediately went to the bottom.  It was the sailing warship "Vasa", and it happened in 1628. <br><br>  Now imagine that you were asked to make a birdhouse or kennel for a dog.  Of course, most of us will cope with this task.  And if asked to make a skyscraper? <br><br>  All these examples suggest that the more complex the system, the more it has various interdependencies, implementation nuances, pitfalls.  And in order to successfully cope with the design and creation of complex systems, just there are architectural patterns. <br><br>  In academic terms, information system architecture is a concept that defines the model, structure, functions performed and the interconnection of IP components. <br><br>  However, let's go back from building ships and houses to programming.  See, we always have requirements that come to us from business.  And architecture helps to convert them into technical requirements.  Based on the obtained technical requirements, you can easily decompose the system, write the dependencies between the modules, and proceed to direct implementation. <br><br><img src="https://habrastorage.org/webt/d-/4b/dl/d-4bdlimhtc9xuuf9tgfjaupx8k.png"><br><br>  Thus, the architecture: <br><br><ul><li>  helps to ensure non-functional system requirements; </li><li>  is a means of communication between stakeholders; </li><li>  optimizes costs, reduces the cost of large systems; </li><li>  allows to reuse architectural patterns, take into account previous experience, do not repeat past mistakes </li></ul><br><h3>  High load </h3><br>  In itself, the concept of high load is very relative, and there is no fixed definition.  However, it is safe to say that this moment comes when your current infrastructure ceases to cope with the load.  And that means it's time to do the scaling.  It happens: <br><br><ul><li>  vertical.  The essence is simple: if the iron does not cope, we buy new, super powerful, productive and expensive; </li><li>  horizontal.  We have one server that can not cope.  We buy a second server with the same characteristics, then a third, and so on. At the output, we have a lot of relatively simple machines. </li></ul><br><h3>  Architectural Tactics </h3><br>  Everyone knows such a thing as a queue ( <b>FIFO</b> ).  This is a way to organize data processing, which allows you to handle conflict requirements by streamlining the process according to the principle of ‚Äúfirst come, first go‚Äù.  The queue can be used as a means of load balancing, decoupling the client and server, and much more. <br><br>  Advantages: <br><br><ul><li>  weak client and server connectivity; </li><li>  the status of the task is known; </li><li>  configuration on the fly; </li><li>  load balancing. </li></ul><br>  Disadvantages: <br><br><ul><li>  additional entity in the system; </li><li>  more complex task processing; </li><li>  loss / creation of copies of messages. </li></ul><br>  Now let's talk about what <b>you can do with the repository</b> .  Storage refers to any storage system, for example, relational databases.  So, we have the following solutions for storage problems: <br><br>  1. <b>Replication.</b> <br><br><img src="https://habrastorage.org/webt/bn/rn/sc/bnrnsco5opzqj9pitxsrh0guzc8.png"><br><br>  One of the known problems with repositories is related to the situation when we have a lot of readings and few records.  This may be a news site - everyone reads news, but only admins add new materials.  So, replication is just about when our storage has rested on reading, and we have delays in the operation of the system.  It is important to note here that replication solves the problem of reading, but not writing.  Moreover, it somewhat impairs the ability of databases to write, because it has to distribute portions of its data to replicas, as is noticeable in the picture above.  In the simplest case, when setting up replication, we have one Master - the main database to which we write, and the slaves are copies of the database (replicas from which all data reads come). <br><br>  2. <b>Partitioning</b> .  Suppose we have a large table, but we use only some data.  We can break it apart.  For example, we take our data and put them in different tablets depending on the month.  The result is small tables instead of one large and, as a result, faster samples for a particular month.  This optimizes the query execution time. <br><br><pre><code class="php hljs">CREATE TABLE my_table (id INT, amount DECIMAL(<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>), some_date DATE) ENGINE=INNODB PARTITION BY HASH( MONTH(some_date) ) PARTITIONS <span class="hljs-number"><span class="hljs-number">6</span></span>;</code> </pre> <br>  3. <b>Vertical sharding</b> .  In the case of partitioning, it was about one server and one database.  In the case of sharding, we have several machines and several bases.  We take all our data, we break them into logical groups, and each logical group is stored in a separate database. <br><br><pre> <code class="php hljs">$users = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PDO(<span class="hljs-string"><span class="hljs-string">"pgsql:db_name=my_db;host=192.168.1.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>); $photos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PDO(<span class="hljs-string"><span class="hljs-string">"pgsql:db_name=my_db;host=192.168.1.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>); $users-&gt;prepare(<span class="hljs-string"><span class="hljs-string">'SELECT * FROM users ...'</span></span>); $photos-&gt;prepare(<span class="hljs-string"><span class="hljs-string">'SELECT * FROM photos ...'</span></span>);</code> </pre> <br>  The method is easily implemented and well scales the load.  But it also has disadvantages, which are described in more detail in the video. <br><br>  4. <b>Horizontal sharding</b> .  Here, every shard lies on a separate machine. <br><br><img src="https://habrastorage.org/webt/lq/9r/rq/lq9rrqbidx2x7pcymvtgqxquqlc.png"><br><br>  <b>Recipe</b> <br><br>  The following theses will help you create a scalable system: <br><br><ul><li>  simplify at the level of requirements! </li><li>  don't complicate the decision </li><li>  try to be stateless, </li><li>  cache, </li><li>  monitoring + alert, </li><li>  be competent. </li></ul><br>  Colleagues, the retelling came out rather concise, so it's better to watch the webinar completely.  Also, do not miss the <a href="https://otus.pw/dUdL/">Open Day</a> of the Backend Developer for PHP course. </div><p>Source: <a href="https://habr.com/ru/post/440334/">https://habr.com/ru/post/440334/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container">Waiting for the list from <a href="../../index.html">here</a>...</nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52319614 = new Ya.Metrika({
                  id:52319614,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52319614" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>